Index: akregator/Messages.sh
===================================================================
--- akregator/Messages.sh	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ akregator/Messages.sh	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -1,3 +1,3 @@
 #! /bin/sh
 $EXTRACTRC `find . -name "*.rc" -o -name "*.ui" -o -name "*.kcfg"` >> rc.cpp || exit 11
-$XGETTEXT $(find -name "*.cpp" ) -o $podir/akregator.pot
+$XGETTEXT $(find . -name "*.cpp" -o -name "*.h") -o $podir/akregator.pot
Index: akregator/src/subscriptionlistmodel.cpp
===================================================================
--- akregator/src/subscriptionlistmodel.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ akregator/src/subscriptionlistmodel.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -447,6 +447,9 @@
     {
         const TreeNode* const droppedOnNode = qobject_cast<const TreeNode*>( nodeForIndex( parent, m_feedList ) );
 
+        if ( !droppedOnNode )
+            return false;
+
         const Folder* const destFolder = droppedOnNode->isGroup() ? qobject_cast<const Folder*>( droppedOnNode ) : droppedOnNode->parent();
         if ( !destFolder )
             return false;
Index: libkleo/libkleopatrarc.desktop
===================================================================
--- libkleo/libkleopatrarc.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ libkleo/libkleopatrarc.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -288,6 +288,7 @@
 Name[it]=Chiavi per le firme qualificate
 Name[ja]=適格電子署名用の鍵
 Name[km]=សោ​សម្រាប់​ហត្ថលេខា​ដែល​មាន​​គុណភាព
+Name[lt]=Raktai kvalifikuotiems parašams
 Name[lv]=Derīgo parakstu atslēgas
 Name[nb]=Nøkler for kvalifiserte signaturer
 Name[nds]=Slötels för pröövt Ünnerschriften
Index: kode/kwsdl/kwsdl_compiler.desktop
===================================================================
--- kode/kwsdl/kwsdl_compiler.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kode/kwsdl/kwsdl_compiler.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -14,6 +14,7 @@
 Name[kk]=KWSDL компиляторы
 Name[km]=កម្មវិធី​ចងក្រង KWSDL
 Name[ko]=KWSDL 컴파일러
+Name[lt]=KWSDL kompiliatorius
 Name[lv]=KWSDL kompilators
 Name[nb]=KWSDL-kompilator
 Name[nds]=KWSDL-Kompilerer
Index: kode/kxforms/kxforms.desktop
===================================================================
--- kode/kxforms/kxforms.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kode/kxforms/kxforms.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -23,6 +23,7 @@
 GenericName[kk]=XML пішін өңдегіші
 GenericName[km]=កម្មវិធី​និពន្ធ​សំណុំ​បែបបទ​របស់ XML
 GenericName[ko]=XML 폼 편집기
+GenericName[lt]=XML formų rengyklė
 GenericName[lv]=XML formu redaktors
 GenericName[nb]=XML skjemaredigerer
 GenericName[nds]=XML-Kiekwarkeditor
Index: kresources/scalix/kabc/scalix.desktop
===================================================================
--- kresources/scalix/kabc/scalix.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kresources/scalix/kabc/scalix.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -44,6 +44,7 @@
 Comment[it]=Consente l'accesso ai contatti memorizzati su un server Scalix che usa IMAP tramite KMail o Kontact
 Comment[ja]=KMail または Kontact 経由で IMAP を使って、Scalix サーバに保存されている連絡先へのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ទំនាក់ទំនង​ដែល​បាន​រក្សាទុក​នៅ​លើ​ម៉ាស៊ីន​បម្រើ Scalix ដោយប្រើ IMAP តាមរយៈ KMail ឬ Kontact
+Comment[lt]=Suteikia prieigą prie kontaktų, saugomų Scalix serveryje, naudojant KMail (Kontact) programos IMAP protokolą
 Comment[lv]=Nodrošina piekļuvi kontaktiem, kas glabājas Scalix severī, izmantojot IMAP caur KMail vai Kontact
 Comment[nb]=Gir tilgang til en kalender lagret på en Scalix-tjener som bruker IMAP, via KMail eller Kontact
 Comment[nds]=Stellt mit KMail oder Kontact över IMAP Topgriep op Kontakten op en Scalix-Server praat
Index: kresources/slox/kabc_ox.desktop
===================================================================
--- kresources/slox/kabc_ox.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kresources/slox/kabc_ox.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -57,6 +57,7 @@
 Comment[it]=Consente l'accesso ai contatti memorizzati su un server Open-Xchange
 Comment[ja]=Open-Xchange サーバに保存されている連絡先へのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ទំនាក់ទំនង​ដែល​បាន​រក្សាទុក​នៅ​លើ​ម៉ាស៊ីន​បម្រើ Open-Xchange
+Comment[lt]=Suteikia prieigą prie kontaktų, saugomų Open-Xchange serveryje
 Comment[lv]=Nodrošina piekļuvi kontaktiem, kas glabājas Open-Xchange serverī.
 Comment[nb]=Gir tilgang til kontakter lagret på en Open-Xchange-tjener
 Comment[nds]=Stellt Togriep op de op en Open-Xchange-Server wohrten Kontakten praat
Index: kresources/akonadi/kabc/akonadi.desktop
===================================================================
--- kresources/akonadi/kabc/akonadi.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kresources/akonadi/kabc/akonadi.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -13,6 +13,7 @@
 Name[it]=Rubrica indirizzi di Akonadi
 Name[ja]=Akonadi アドレス帳
 Name[km]=សៀវភៅ​អាសយដ្ឋាន Akonadi
+Name[lt]=Akonadi adresų knygelės
 Name[lv]=Akonadi adrešu grāmatas
 Name[nb]=Akonadi adressebøker
 Name[nds]=Akonadi-Adressbook instellen
Index: kmail/dbusmail.desktop
===================================================================
--- kmail/dbusmail.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kmail/dbusmail.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -20,6 +20,7 @@
 Comment[kk]=DBUS интерфейсті пошта бағдарламасы
 Comment[km]=កម្មវិធី​សំបុត្រ​ដែល​មាន​ចំណុច​ប្រទាក់ DBUS
 Comment[ko]=DBUS 인터페이스를 사용하는 전자 우편 프로그램
+Comment[lt]=Pašto programa su D-Bus sąsaja
 Comment[lv]=Pasta programma ar DBUS saskarni
 Comment[nb]=E-postprogram med DBUS-grensesnitt
 Comment[nds]=Nettpostprogramm mit en D-Bus-Koppelsteed
Index: kmail/messagelistview/core/model.cpp
===================================================================
--- kmail/messagelistview/core/model.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kmail/messagelistview/core/model.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -2926,9 +2926,9 @@
       // Handle saving the current selection: if this item was the current before the step
       // then zero it out. We have killed it and it's OK for the current item to change.
 
-      if ( dyingMessage->isViewable() &&
-           dyingMessage == mCurrentItemToRestoreAfterViewItemJobStep )
+      if ( dyingMessage == mCurrentItemToRestoreAfterViewItemJobStep )
       {
+        Q_ASSERT( dyingMessage->isViewable() );
         // Try to select the item below the removed one as it helps in doing a "readon" of emails:
         // you read a message, decide to delete it and then go to the next.
         // Qt tends to select the message above the removed one instead (this is a hardcoded logic in
@@ -3028,12 +3028,21 @@
       // Parent is gone
       childMessage->setThreadingStatus( MessageItem::ParentMissing );
 
-      // If the child is going to be selected, we must immediately
-      // reattach it to a temporary group in order for the selection
-      // to be preserved across multiple steps. Otherwise we could end
+      // If the child (or any message in its subtree) is going to be selected,
+      // then we must immediately reattach it to a temporary group in order for the
+      // selection to be preserved across multiple steps. Otherwise we could end
       // with the child-to-be-selected being non viewable at the end
       // of the view job step. Attach to a temporary group.
-      if ( childMessage == mCurrentItemToRestoreAfterViewItemJobStep )
+      if (
+           // child is going to be re-selected
+           ( childMessage == mCurrentItemToRestoreAfterViewItemJobStep ) ||
+           (
+             // there is a message that is going to be re-selected
+             mCurrentItemToRestoreAfterViewItemJobStep && 
+             // that message is in the childMessage subtree
+             mCurrentItemToRestoreAfterViewItemJobStep->hasAncestor( childMessage )
+           )
+         )
       {
         attachMessageToGroupHeader( childMessage );
 
Index: kmail/kmail_config_composer.desktop
===================================================================
--- kmail/kmail_config_composer.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kmail/kmail_config_composer.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -80,6 +80,7 @@
 Comment[ja]=メール作成の設定
 Comment[km]=ការ​កំណត់​កម្មវិធី​តែង​សារ
 Comment[ko]=메시지 작성기 설정
+Comment[lt]=Laiškų rengyklės nustatymai
 Comment[lv]=Vēstuļu rastītāja iestatījumi
 Comment[nb]=Innstillinger for meldingskomposer
 Comment[nds]=Narichteneditor instellen
Index: kmail/dbusimap.desktop
===================================================================
--- kmail/dbusimap.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kmail/dbusimap.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -20,6 +20,7 @@
 Comment[kk]=DBUS интерфейсті пошта бағдарламасы
 Comment[km]=កម្មវិធី​សំបុត្រ​ដែល​មាន​ចំណុច​ប្រទាក់ DBUS
 Comment[ko]=DBUS 인터페이스를 사용하는 전자 우편 프로그램
+Comment[lt]=Pašto programa su D-Bus sąsaja
 Comment[lv]=Pasta programma ar DBUS saskarni
 Comment[nb]=E-postprogram med DBUS-grensesnitt
 Comment[nds]=Nettpostprogramm mit en D-Bus-Koppelsteed
Index: kmail/kmfoldercachedimap.cpp
===================================================================
--- kmail/kmfoldercachedimap.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kmail/kmfoldercachedimap.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -202,7 +202,8 @@
     /*mHoldSyncs( false ),*/
     mFolderRemoved( false ),
     mRecurse( true ),
-    mStatusChangedLocally( false ), mAnnotationFolderTypeChanged( false ),
+    mStatusChangedLocally( false ),
+    mAnnotationFolderTypeChanged( false ),
     mIncidencesForChanged( false ), mPersonalNamespacesCheckDone( true ),
     mQuotaInfo(), mAlarmsBlocked( false ),
     mRescueCommandCount( 0 ),
@@ -303,18 +304,22 @@
   KMFolderMaildir::readConfig();
 
   mStatusChangedLocally = group.readEntry( "StatusChangedLocally", false );
+  QStringList uidsChanged = group.readEntry( "UIDStatusChangedLocally", QStringList() );
+  foreach( const QString &uid, uidsChanged ) {
+    mUIDsOfLocallyChangedStatuses.append( uid.toUInt() );
+  }
   mAnnotationFolderTypeChanged = group.readEntry( "AnnotationFolderTypeChanged", false );
   mIncidencesForChanged = group.readEntry( "IncidencesForChanged", false );
   if ( mImapPath.isEmpty() ) {
     mImapPathCreation = group.readEntry("ImapPathCreation");
   }
 
-  QStringList uids = group.readEntry( "UIDSDeletedSinceLastSync", QStringList() );
+  QStringList delUids = group.readEntry( "UIDSDeletedSinceLastSync" , QStringList() );
 #if MAIL_LOSS_DEBUGGING
   kDebug( 5006 ) << "READING IN UIDSDeletedSinceLastSync: " << folder()->prettyUrl() << endl << uids;
 #endif
-  for ( QStringList::iterator it = uids.begin(); it != uids.end(); ++it ) {
-      mDeletedUIDsSinceLastSync.insert( (*it).toULong(), 0);
+  for ( QStringList::iterator it = delUids.begin(); it != delUids.end(); it++ ) {
+    mDeletedUIDsSinceLastSync.insert( (*it).toULong(), 0);
   }
 }
 
@@ -331,7 +336,14 @@
   configGroup.writeEntry( "NoContent", mNoContent );
   configGroup.writeEntry( "ReadOnly", mReadOnly );
   configGroup.writeEntry( "FolderAttributes", mFolderAttributes );
-  configGroup.writeEntry( "StatusChangedLocally", mStatusChangedLocally );
+
+  // StatusChangedLocally is always false, as we use UIDStatusChangedLocally now
+  configGroup.writeEntry( "StatusChangedLocally", false );
+  QStringList uidsToWrite;
+  foreach( const ulong uid, mUIDsOfLocallyChangedStatuses ) {
+    uidsToWrite.append( QString::number( uid ) );
+  }
+  configGroup.writeEntry( "UIDStatusChangedLocally", uidsToWrite );
   if ( !mImapPathCreation.isEmpty() ) {
     if ( mImapPath.isEmpty() ) {
       configGroup.writeEntry( "ImapPathCreation", mImapPathCreation );
@@ -953,12 +965,13 @@
       // Upload flags, unless we know from the ACL that we're not allowed
       // to do that or they did not change locally
       if ( mUserRights <= 0 || ( mUserRights & KMail::ACLJobs::WriteFlags ) ) {
-        if ( mStatusChangedLocally ) {
+        if ( !mUIDsOfLocallyChangedStatuses.isEmpty() || mStatusChangedLocally ) {
           uploadFlags();
           break;
         }
-      } else if ( mUserRights & KMail::ACLJobs::WriteSeenFlag ) {
-        if ( mStatusChangedLocally ) {
+      }
+      else if ( mUserRights & KMail::ACLJobs::WriteSeenFlag ) {
+        if ( !mUIDsOfLocallyChangedStatuses.isEmpty() || mStatusChangedLocally ) {
           uploadSeenFlags();
           break;
         }
@@ -1425,6 +1438,10 @@
         // Either not a valid message or not one that is on the server yet
         continue;
       }
+      if ( mUIDsOfLocallyChangedStatuses.indexOf( msg->UID() ) < 0 && !mStatusChangedLocally ) {
+        // This message has not had its status changed locally
+        continue;
+      }
 
       QString flags = KMFolderImap::statusToFlags( msg->status(), mPermanentFlags );
       // Collect uids for each typem of flags.
@@ -1468,6 +1485,11 @@
         // Either not a valid message or not one that is on the server yet
         continue;
 
+      if ( mUIDsOfLocallyChangedStatuses.indexOf( msg->UID() ) < 0 && !mStatusChangedLocally ) {
+        // This message has not had its status changed locally
+        continue;
+      }
+
       if ( msg->status().isOld() || msg->status().isRead() )
         seenUids.append( msg->UID() );
       else
@@ -1525,13 +1547,21 @@
 void KMFolderCachedImap::setStatus( int idx, const MessageStatus &status, bool toggle )
 {
   KMFolderMaildir::setStatus( idx, status, toggle );
-  mStatusChangedLocally = true;
+  const KMMsgBase *msg = getMsgBase( idx );
+  Q_ASSERT( msg );
+  if ( msg )
+    mUIDsOfLocallyChangedStatuses.append( msg->UID() );
 }
 
 void KMFolderCachedImap::setStatus( QList<int> &ids, const MessageStatus &status, bool toggle )
 {
   KMFolderMaildir::setStatus( ids, status, toggle );
-  mStatusChangedLocally = true;
+  foreach( const int id, ids ) {
+    const KMMsgBase *msg = getMsgBase( id );
+    Q_ASSERT( msg );
+    if ( msg )
+      mUIDsOfLocallyChangedStatuses.append( msg->UID() );
+  }
 }
 
 /* Upload new folders to server */
@@ -1888,7 +1918,8 @@
   } else {
     if ( lastSet ) { // always true here (this comes from online-imap...)
       mContentState = imapFinished;
-      mStatusChangedLocally = false; // we are up to date again
+      mUIDsOfLocallyChangedStatuses.clear(); // we are up to date again
+      mStatusChangedLocally = false;
     }
   }
   serverSyncInternal();
Index: kmail/kmfoldercachedimap.h
===================================================================
--- kmail/kmfoldercachedimap.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kmail/kmfoldercachedimap.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -627,12 +627,18 @@
     bool mFolderRemoved;
     bool mRecurse;
 
+   /**
+    * UIDs added by setStatus. Indicates that the client has changed
+    * the status of those mails. The mail flags for changed mails will be
+    * uploaded to the server, overwriting the server's notion of the status
+    * of the mails in this folder.
+    */
+    QList<ulong> mUIDsOfLocallyChangedStatuses;
+
     /**
-      Set to true by setStatus. Indicates that the client has changed
-      the status of at least one mail. The mail flags will therefore be
-      uploaded to the server, overwriting the server's notion of the status
-      of the mails in this folder.
-    */
+     * Same as above, but uploads the flags of all mails, even if not all changed.
+     * Only still here for config compatibility.
+     */
     bool mStatusChangedLocally;
 
     /**
Index: kmail/kmail_view.desktop
===================================================================
--- kmail/kmail_view.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kmail/kmail_view.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -13,6 +13,7 @@
 Name[ja]=KMail ビュー
 Name[km]=ទិដ្ឋភាព KMail
 Name[ko]=KMail 보기
+Name[lt]=KMail peržiūra
 Name[lv]=KMail skats
 Name[nb]=KMail-visning
 Name[nds]=KMail-Ansicht
Index: knode/kncomposerview.cpp
===================================================================
--- knode/kncomposerview.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ knode/kncomposerview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -93,6 +93,7 @@
   e_dit=new KNComposerEditor(this);
   e_dit->switchToPlainText();
   e_dit->setMinimumHeight(50);
+  e_dit->setFont(KGlobalSettings::fixedFont());
 
   QVBoxLayout *notL=new QVBoxLayout(e_dit);
   notL->addStretch(1);
Index: knode/knarticle.cpp
===================================================================
--- knode/knarticle.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ knode/knarticle.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -70,8 +70,10 @@
 {
   // filter out internal headers
   for ( Headers::Base::List::Iterator it = h_eaders.begin(); it != h_eaders.end(); ) {
-    if ( (*it)->isXHeader() && ( strncasecmp( (*it)->type(), "X-KNode", 7 ) == 0 ) )
+    if ( (*it)->isXHeader() && ( strncasecmp( (*it)->type(), "X-KNode", 7 ) == 0 ) ) {
+      delete *it;
       it = h_eaders.erase( it );
+    }
     else
       ++it;
   }
Index: dependency-graph.dot
===================================================================
--- dependency-graph.dot	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ dependency-graph.dot	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -48,7 +48,6 @@
         "konsolekalendar"[style=filled, fillcolor=lightcyan, URL="konsolekalendar/html/index.html"];
         "kontact"[style=filled, fillcolor=lightcyan, URL="kontact/html/index.html"];
         "korganizer"[style=filled, fillcolor=lightcyan, URL="korganizer/html/index.html"];
-        "korn"[style=filled, fillcolor=lightcyan];
         "kresources"[style=filled, fillcolor=palegreen];
         "libakonadi"[style=filled, fillcolor=lightyellow, URL="akonadi/libakonadi/html/index.html"];
         "libkdepim"[style=filled, fillcolor=lightyellow, URL="libkdepim/html/index.html"];
Index: doc/kleopatra/index.docbook
===================================================================
--- doc/kleopatra/index.docbook	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ doc/kleopatra/index.docbook	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -13,48 +13,6 @@
 
   <!ENTITY dn "<acronym>DN</acronym>">
   <!ENTITY ca "<acronym>CA</acronym>">
-
-  <!-- Expanded all entities to make them translatable - lueck
-    FILE menu 
-  <!ENTITY file-new-key-pair "<menuchoice><guimenu>File</guimenu><guimenuitem>New Key Pair...</guimenuitem></menuchoice>">
-  <!ENTITY file-export-certificates "<menuchoice><guimenu>File</guimenu><guimenuitem>Export Certificates...</guimenuitem></menuchoice>">
-  <!ENTITY file-export-secret-key "<menuchoice><guimenu>File</guimenu><guimenuitem>Export Secret key...</guimenuitem></menuchoice>">
-  <!ENTITY file-import-certificates "<menuchoice><guimenu>File</guimenu><guimenuitem>Import Certificates...</guimenuitem></menuchoice>">
-  <!ENTITY file-import-crls "<menuchoice><guimenu>File</guimenu><guimenuitem>Import CRLs...</guimenuitem></menuchoice>">
-  <!ENTITY file-quit "<menuchoice><shortcut><keycombo action="simul">&Ctrl;<keycap>Q</keycap></keycombo></shortcut><guimenu>File</guimenu><guimenuitem>Quit</guimenuitem></menuchoice>">
-
-   VIEW menu
-  <!ENTITY view-redisplay "<menuchoice><shortcut><keycombo action="simul"><keycap>F5</keycap></keycombo></shortcut><guimenu>View</guimenu><guimenuitem>Redisplay</guimenuitem></menuchoice>">
-  <!ENTITY view-stop-operation "<menuchoice><shortcut><keycombo action="simul"><keycap>Esc</keycap></keycombo></shortcut><guimenu>View</guimenu><guimenuitem>Stop Operation</guimenuitem></menuchoice>">
-  <!ENTITY view-certificate-details "<menuchoice><guimenu>View</guimenu><guimenuitem>Certificate Details</guimenuitem></menuchoice>">
-  <!ENTITY view-hierarchical-key-list "<menuchoice><guimenu>View</guimenu><guimenuitem>Hierarchical Key List</guimenuitem></menuchoice>">
-  <!ENTITY view-expand-all "<menuchoice><shortcut><keycombo action="simul">&Ctrl;<keycap>.</keycap></keycombo></shortcut><guimenu>View</guimenu><guimenuitem>Expand All</guimenuitem></menuchoice>">
-  <!ENTITY view-collapse-all "<menuchoice><shortcut><keycombo action="simul">&Ctrl;<keycap>,</keycap></keycombo></shortcut><guimenu>View</guimenu><guimenuitem>Collapse All</guimenuitem></menuchoice>">
-
-   CERTIFICATES menu 
- <!ENTITY certificates-validate "<menuchoice><shortcut><keycombo action="simul">&Shift;<keycap>F5</keycap></keycombo></shortcut><guimenu>Certificates</guimenu><guimenuitem>Validate</guimenuitem></menuchoice>">
-  <!ENTITY certificates-refresh-crls "<menuchoice><guimenu>Certificates</guimenu><guimenuitem>Refresh CRLs</guimenuitem></menuchoice>">
-  <!ENTITY certificates-delete "<menuchoice><shortcut><keycombo action="simul"><keycap>Delete</keycap></keycombo></shortcut><guimenu>Certificates</guimenu><guimenuitem>Delete</guimenuitem></menuchoice>">
-  <!ENTITY certificates-download "<menuchoice><guimenu>Certificates</guimenu><guimenuitem>Download</guimenuitem></menuchoice>">
-
-   CRLS menu
-  <!ENTITY crls-clear-crl-cache "<menuchoice><guimenu>CRLs</guimenu><guimenuitem>Clear CRL Cache</guimenuitem></menuchoice>">
-  <!ENTITY crls-dump-crl-cache "<menuchoice><guimenu>CRLs</guimenu><guimenuitem>Dump CRL Cache</guimenuitem></menuchoice>">
-
-   TOOLS menu 
-  <!ENTITY tools-gnupg-log-viewer "<menuchoice><guimenu>Tools</guimenu><guimenuitem>GnuPG Log Viewer...</guimenuitem></menuchoice>">
-
-   SETTINGS menu 
-  <!ENTITY settings-show-statusbar "<menuchoice><guimenu>Settings</guimenu><guimenuitem>Show Statusbar</guimenuitem></menuchoice>">
-  <!ENTITY settings-configure-shortcuts "<menuchoice><guimenu>Settings</guimenu><guimenuitem>Configure Shortcuts...</guimenuitem></menuchoice>">
-  <!ENTITY settings-configure-kleopatra "<menuchoice><guimenu>Settings</guimenu><guimenuitem>Configure &kleopatra;...</guimenuitem></menuchoice>">
-  <!ENTITY settings-configure-gpgme-backend "<menuchoice><guimenu>Settings</guimenu><guimenuitem>Configure GpgME Backend...</guimenuitem></menuchoice>">
-   -->
-
-  <!-- Command line options -->
-  <!ENTITY commandline-option-external "<option>--external</option>">
-  <!ENTITY commandline-option-query "<option>--query</option>">
-  <!ENTITY commandline-option-import-certificate "<option>--import-certificate</option>">
 ]>
 
 <book lang="&language;">
@@ -114,12 +72,12 @@
 
 <legalnotice>&GPLNotice;</legalnotice>
 
-<date>2007-12-19</date>
-<releaseinfo>1.9.0</releaseinfo>
+<date>2009-02-19</date>
+<releaseinfo>2.0.5</releaseinfo>
 
 <abstract>
 <para>
-&kleopatra; is a tool for managing X.509 certificates.
+&kleopatra; is a tool for managing X.509 and OpenPGP certificates.
 </para>
 </abstract>
 
@@ -137,11 +95,12 @@
 
 <chapter id="introduction"> <title>Introduction</title> 
 
-<para>&kleopatra; is the &kde; tool for managing X.509 certificates in
+<para>&kleopatra; is the &kde; tool for managing X.509 and OpenPGP certificates in
 the &gpgsm; keybox and for retrieving certificates from
 <acronym>LDAP</acronym> servers.</para>
 
-<para>&kleopatra; can be started from &kmail;'s <guimenu>Tools</guimenu>
+<para>&kleopatra; can be started from &kmail;'s <menuchoice><guimenu>Tools</guimenu>
+<guimenuitem>Certificate Manager</guimenuitem></menuchoice>
 menu, as well as from the command line. The &kleopatra; executable is
 named <userinput><command>kleopatra</command></userinput>.</para>
 
@@ -166,7 +125,7 @@
 of the local keybox, which is similar to &gpg;'s concept of keyrings,
 albeit one should not stretch this analogy too much.</para>
 
-<para>The main window is divided into the large key listing area, the
+<para>The main window is divided into the large key listing area consisting of several tabs, the
 menubar and the <link linkend="functions-search">search bar</link> on
 top, and a status bar at the bottom.</para>
 
@@ -181,8 +140,7 @@
 certificates, but usually the terms <quote>certificate</quote> and
 <quote>(public) key</quote> are used interchangeably, and we will not
 distinguish between them in this manual either, except when explicitly
-noted. The name of the &ca; which issued the certificate (its &dn;)
-is shown in the <guilabel>Issuer &dn;</guilabel> column.</para>
+noted.</para>
 
 <para>&ca;s must in turn be signed by other &ca;s to be valid. Of
 course, this must end somewhere, so the top-level &ca; (root-&ca;)
@@ -193,11 +151,10 @@
 the vendor of a product using certificates, but can be done by the
 user via &gpgsm;'s command line interface.</para>
 
-<para>To see which of the certificates are root certificates, you can
-either compare <guilabel>Subject &dn;</guilabel> and <guilabel>Issuer
-&dn;</guilabel>, or you switch to hierarchical keylist mode with <link
+<para>To see which of the certificates are root certificates, you
+switch to the hierarchical keylist mode with <link
 linkend="view-hierarchical-key-list"><menuchoice><guimenu>View</guimenu>
-<guimenuitem>Hierarchical Key List</guimenuitem></menuchoice></link>.</para>
+<guimenuitem>Hierarchical Certificate List</guimenuitem></menuchoice></link>.</para>
 
 <para>You can see the details of any certificate by double-clicking it
 or using <link linkend="view-certificate-details"><menuchoice><guimenu>View</guimenu>
@@ -213,17 +170,18 @@
 <keycap>F5</keycap></keycombo></shortcut><guimenu>View</guimenu>
 <guimenuitem>Redisplay</guimenuitem></menuchoice></link>.</para>
 
-<para>Since validating a key may take some time (&eg; CRLs might need
+<!-- no longer in kde 4
+para>Since validating a key may take some time (&eg; CRLs might need
 to be fetched), the normal keylisting does not attempt to check the
 validity of keys. For this, <link linkend="certificates-validate">
 <menuchoice><shortcut><keycombo action="simul">&Shift;<keycap>F5</keycap></keycombo>
-</shortcut><guimenu>Certificates</guimenu><guimenuitem>Validate</guimenuitem></menuchoice></link>, a
-special variant of <link
+</shortcut><guimenu>Certificates</guimenu><guimenuitem>Validate</guimenuitem></menuchoice></link>,
+a special variant of <link
 linkend="view-redisplay"><menuchoice><shortcut><keycombo action="simul">
 <keycap>F5</keycap></keycombo></shortcut><guimenu>View</guimenu>
 <guimenuitem>Redisplay</guimenuitem></menuchoice></link>, is provided. It
 either checks the selected certificates, or all keys if none are
-selected.</para>
+selected.</para-->
 
 </sect1>
 
@@ -233,30 +191,31 @@
 signatures in emails, since certificates are embedded in the
 signatures made using them most of the time. However, if you need to
 send a mail to someone you have not yet had contact with, you need to
-fetch the certificate from an LDAP directory (although &gpgsm; can do
+fetch the certificate from an LDAP folder (although &gpgsm; can do
 this automatically), or from a file. You also need to import your own
 certificate after receiving the &ca; answer to your certification
 request.</para>
 
-<para>To search for a certificate in an LDAP directory, switch the
-dropdown menu of the search bar from <guilabel>in Local
-Certificates</guilabel> to <guilabel>in External
-Certificates</guilabel>, enter some text (&eg; the name of the person
-you want the certificate for) into the line edit, and click on the
-<guilabel>Find</guilabel> icon. The results will be displayed in the
+<para>To search for a certificate in an LDAP directory, select 
+<menuchoice><guimenu>File</guimenu><guimenuitem>Lookup Certificates on Server</guimenuitem></menuchoice>
+and enter some text (&eg; the name of the person
+you want the certificate for) into the line edit of the <guilabel>Keyserver 
+Certificate Lookup</guilabel> dialog, then click on the
+<guilabel>Search</guilabel> button. The results will be displayed in the
 key list below the search bar, where you can select certificates to
-either look at them with <link linkend="view-certificate-details">
-<menuchoice><guimenu>View</guimenu><guimenuitem>Certificate Details</guimenuitem></menuchoice></link> or
-download them with <link linkend="certificates-download">
-<menuchoice><guimenu>Certificates</guimenu><guimenuitem>Download</guimenuitem></menuchoice></link> into the
-local keybox. Note that you can also download the certificate from the
+look at them by clicking the <guibutton>Details</guibutton> button
+or download them with <guibutton>Import</guibutton> into the
+local keybox.</para>
+<!--
+Note that you can also download the certificate from the
 details dialog, using the <guilabel>Import to Local</guilabel>
 button.</para>
+not found in 4.2
+-->
 
 <para>You can configure the list of LDAP servers to search in the
 <link linkend="configuration-directory-services"><guilabel>Directory
-Services</guilabel></link> page of &kleopatra;'s <link
-linkend="configuration">configure dialog</link>.</para>
+Services</guilabel></link> page of &kleopatra;'s configure dialog.</para>
 
 <para>If you received the certificate as a file, try <link
 linkend="file-import-certificates"><menuchoice><guimenu>File</guimenu>
@@ -269,7 +228,7 @@
 public key (as well as the secret key) from the PKCS#12 file you got from
 the &ca;. You can do this on the command line with <link
 linkend="commandline-option-import-certificate"><userinput><command>kleopatra
-&commandline-option-import-certificate;
+<option>--import-certificate</option>
 <filename>filename</filename></command></userinput></link> or from
 within &kleopatra; with <link
 linkend="file-import-certificates"><menuchoice><guimenu>File</guimenu>
@@ -281,49 +240,71 @@
 <sect1 id="functions-newkey"><title>Creating New Key Pairs</title>
 
 <para>The menu item <link linkend="file-new-key-pair"><menuchoice>
-<guimenu>File</guimenu><guimenuitem>New Key Pair...</guimenuitem></menuchoice></link> starts the
-certificate-request-creating wizard which will guide you through a
-number of steps to create a certificate request; this request can, on the 
-last page of the wizard, either be sent to a certificate authority (&ca;)
-to be signed or saved to a file (for example to a floppy, so it can be
-shipped to the &ca;).</para> <para>Whenever you are done with a step in
+<guimenu>File</guimenu><guimenuitem>New Certificate...</guimenuitem></menuchoice></link> starts the
+<guilabel>Certificate Creation Wizard</guilabel> which will guide you through a
+number of steps to create a certificate request.</para> 
+<para>Whenever you are done with a step in
 the wizard, press <guibutton>Next</guibutton> to go to the next step
 (or <guibutton>Back</guibutton> to review steps that are already
 completed). The certificate request creation can be canceled at any
 time by pressing the <guibutton>Cancel</guibutton> button.
 </para>
-<para>The first step in the wizard is to type in your personal data
+<para>On the first page of the wizard choose which type of certificate you want to create:</para>
+
+<variablelist>
+
+<varlistentry>
+<term><guilabel>Create a personal OpenPGP key pair</guilabel></term>
+<listitem><para>OpenPGP key pairs are created locally, and certified by your friends and 
+acquaintances. There is no central certification authority; instead, every 
+individual creates a personal Web Of Trust by certifying other user's key 
+pairs with his own certificate.</para>
+<para>You have to enter a <guilabel>Name</guilabel>, <guilabel>EMail</guilabel> and 
+optional a <guilabel>Comment</guilabel>.</para>
+</listitem>
+</varlistentry>
+<varlistentry>
+<term><guilabel>Create a personal X.509 key pair and certification request</guilabel></term>
+<listitem>
+<para>X.509 key pairs are created locally, but certified centrally by a 
+certification authority (&ca;). CAs can certify other CAs, creating a central, 
+hierarchical chain of trust.</para>
+<para>The next step in the wizard is to type in your personal data
 for the certificate. The fields to fill out are:
 <itemizedlist>
 <listitem>
-<para><guilabel>Name:</guilabel> Your name;</para>
+<para><guilabel>Common Name (CN): </guilabel>Your name;</para>
 </listitem>
 <listitem>
-<para><guilabel>Location:</guilabel>The town or city in which you live;</para>
+<para><guilabel>Email address (EMAIL): </guilabel>Your email address; be sure
+to type this in correctly&mdash;this will be the address people will be
+sending mail to when they use your certificate.</para>
 </listitem>
 <listitem>
-<para><guilabel>Organization:</guilabel>The organization you represent
-(for example, the company you work for);</para>
+<para><guilabel>Location (L): </guilabel>The town or city in which you live;</para>
 </listitem>
 <listitem>
-<para><guilabel>Department:</guilabel>The organizational unit you are
+<para><guilabel>Organizational unit (OU): </guilabel>The organizational unit you are
 in (for example, "Logistics");</para> 
 </listitem>
 <listitem>
-<para><guilabel>Country code:</guilabel>The two letter code for the
-country in which you are living (for example, "US");</para>
+<para><guilabel>Organization (O): </guilabel>The organization you represent
+(for example, the company you work for);</para>
 </listitem>
 <listitem>
-<para><guilabel>Email address:</guilabel>Your email address; be sure
-to type this in correctly&mdash;this will be the address people will be
-sending mail to when they use your certificate.</para>
+<para><guilabel>Country code (C): </guilabel>The two letter code for the
+country in which you are living (for example, "US");</para>
 </listitem>
 </itemizedlist>
 </para><para>
 The next step in the wizard is to select whether to store the
 certificate in a file or send it directly to a &ca;. You will have to
 specify the filename or email address to send the certificate request to.
-</para></sect1>
+</para>
+</listitem>
+</varlistentry>
+</variablelist>
+</sect1>
 
 
 <sect1 id="functions-keybox-management"><title>Keybox Management</title>
@@ -337,13 +318,13 @@
 
 <para>These functions include deleting certificates from the local
 keybox with <link linkend="certificates-delete"><menuchoice><shortcut>
-<keycombo action="simul"><keycap>Delete</keycap></keycombo></shortcut>
+<keycombo action="simul"><keycap>Del</keycap></keycombo></shortcut>
 <guimenu>Certificates</guimenu><guimenuitem>Delete</guimenuitem></menuchoice></link>, as well 
 as manual handling of CRLs (<link linkend="certificates-refresh-crls">
-<menuchoice><guimenu>Certificates</guimenu><guimenuitem>Refresh CRLs</guimenuitem>
-</menuchoice></link>, <link linkend="crls-clear-crl-cache"><menuchoice><guimenu>CRLs</guimenu>
+<menuchoice><guimenu>Tools</guimenu><guimenuitem>Refresh Certificates</guimenuitem> <!--???-->
+</menuchoice></link>, <link linkend="crls-clear-crl-cache"><menuchoice><guimenu>Tools</guimenu>
 <guimenuitem>Clear CRL Cache</guimenuitem></menuchoice></link>, <link
-linkend="crls-dump-crl-cache"><menuchoice><guimenu>CRLs</guimenu>
+linkend="crls-dump-crl-cache"><menuchoice><guimenu>Tools</guimenu>
 <guimenuitem>Dump CRL Cache</guimenuitem></menuchoice></link>).</para>
 
 </sect1>
@@ -357,7 +338,8 @@
 <variablelist>
 
 <varlistentry id="file-new-key-pair">
-<term><menuchoice><guimenu>File</guimenu><guimenuitem>New Key Pair...</guimenuitem></menuchoice></term>
+<term><menuchoice><shortcut><keycombo action="simul">&Ctrl;<keycap>N</keycap></keycombo></shortcut>
+<guimenu>File</guimenu><guimenuitem>New Certificate...</guimenuitem></menuchoice></term>
 
 <listitem>
 <para><action>Creates a new key pair (public and private)</action> and
@@ -375,17 +357,39 @@
 <guimenuitem>Import Certificates...</guimenuitem></menuchoice>.</para>
 </listitem>
 </varlistentry>
+<!-- missing menu item
+<varlistentry>
+<term><menuchoice><shortcut><keycombo action="simul">&Ctrl;&Shift;<keycap>I</keycap></keycombo></shortcut>
+<guimenu>File</guimenu><guimenuitem>Lookup Certificates on Server</guimenuitem></menuchoice></term>
+<listitem>
+<para>???</para>
+</listitem>
+</varlistentry>
+-->
+<varlistentry id="file-import-certificates">
+<term><menuchoice><shortcut><keycombo action="simul">&Ctrl;<keycap>I</keycap></keycombo></shortcut>
+<guimenu>File</guimenu><guimenuitem>Import Certificates...</guimenuitem></menuchoice></term>
 
+<listitem>
+<para><action>Imports certificates and/or secret keys from files into
+the local keybox.</action></para>
 
+<para>The format of the certificate file must be supported by
+&gpgsm;. Please refer to the &gpgsm; manual for a list of supported
+formats.</para>
+</listitem>
+</varlistentry>
+
 <varlistentry id="file-export-certificates">
-<term><menuchoice><guimenu>File</guimenu><guimenuitem>Export Certificates...</guimenuitem></menuchoice></term>
+<term><menuchoice><shortcut><keycombo action="simul">&Ctrl;<keycap>E</keycap></keycombo></shortcut>
+<guimenu>File</guimenu><guimenuitem>Export Certificates...</guimenuitem></menuchoice></term>
 
 <listitem>
 <para><action>Exports the selected certificates</action> into a file.</para>
 
 <note><para>This exports only the public keys, even if the
 secret key is available. Use <menuchoice><guimenu>File</guimenu><guimenuitem>Export 
-Secret key...</guimenuitem></menuchoice> to export both
+Secret Key...</guimenuitem></menuchoice> to export both
 public and secret keys into a file, but note that this is almost
 always a bad idea.</para></note>
 </listitem>
@@ -393,7 +397,7 @@
 
 
 <varlistentry id="file-export-secret-key">
-<term><menuchoice><guimenu>File</guimenu><guimenuitem>Export Secret key...</guimenuitem></menuchoice></term>
+<term><menuchoice><guimenu>File</guimenu><guimenuitem>Export Secret Key...</guimenuitem></menuchoice></term>
 
 <listitem>
 <para><action>Exports both the public and the secret key to a
@@ -406,22 +410,38 @@
 among other things.</para></warning>
 </listitem>
 </varlistentry>
+<!--missing menu items
+<varlistentry>
+<term><menuchoice><shortcut><keycombo action="simul">&Ctrl;&Shift;<keycap>E</keycap></keycombo></shortcut>
+<guimenu>File</guimenu><guimenuitem>Export Certificates to Server...</guimenuitem></menuchoice></term>
+<listitem>
+<para>???</para>
+</listitem>
+</varlistentry>
 
-
-<varlistentry id="file-import-certificates">
-<term><menuchoice><guimenu>File</guimenu><guimenuitem>Import Certificates...</guimenuitem></menuchoice></term>
-
+<varlistentry>
+<term><menuchoice>
+<guimenu>File</guimenu><guimenuitem>Decrypt/Verify Files...</guimenuitem></menuchoice></term>
 <listitem>
-<para><action>Imports certificates and/or secret keys from files into
-the local keybox.</action></para>
-
-<para>The format of the certificate file must be supported by
-&gpgsm;. Please refer to the &gpgsm; manual for a list of supported
-formats.</para>
+<para>???</para>
 </listitem>
 </varlistentry>
-
-
+<varlistentry>
+<term><menuchoice>
+<guimenu>File</guimenu><guimenuitem>Sign/Encrypt Files...</guimenuitem></menuchoice></term>
+<listitem>
+<para>???</para>
+</listitem>
+</varlistentry>
+<varlistentry>
+<term><menuchoice><shortcut><keycombo action="simul">&Ctrl;<keycap>W</keycap></keycombo></shortcut>
+<guimenu>File</guimenu><guimenuitem>Close...</guimenuitem></menuchoice></term>
+<listitem>
+<para>???</para>
+</listitem>
+</varlistentry>
+-->
+<!--not in 4.2
 <varlistentry id="file-import-crls">
 <term><menuchoice><guimenu>File</guimenu><guimenuitem>Import CRLs...</guimenuitem></menuchoice></term>
 
@@ -447,8 +467,8 @@
 </para>
 </listitem>
 </varlistentry>
+-->
 
-
 <varlistentry id="file-quit">
 <term><menuchoice><shortcut><keycombo action="simul">&Ctrl;<keycap>Q</keycap></keycombo></shortcut>
 <guimenu>File</guimenu><guimenuitem>Quit</guimenuitem></menuchoice></term>
@@ -525,7 +545,7 @@
 
 
 <varlistentry id="view-hierarchical-key-list">
-<term><menuchoice><guimenu>View</guimenu><guimenuitem>Hierarchical Key List</guimenuitem></menuchoice></term>
+<term><menuchoice><guimenu>View</guimenu><guimenuitem>Hierarchical Certificate List</guimenuitem></menuchoice></term>
 
 <listitem>
 <para><action> Toggles between hierarchical and flat keylist mode.
@@ -552,7 +572,7 @@
 <listitem>
 <para>(This function is only available when <link
 linkend="view-hierarchical-key-list"><menuchoice><guimenu>View</guimenu>
-<guimenuitem>Hierarchical Key List</guimenuitem></menuchoice></link> is on.)</para>
+<guimenuitem>Hierarchical Certificate List</guimenuitem></menuchoice></link> is on.)</para>
 
 <para><action>Expands all list items in the certificate list
 view,</action> &ie; makes all items visible.</para>
@@ -565,8 +585,6 @@
 </listitem>
 </varlistentry>
 
-
-
 <varlistentry id="view-collapse-all">
 <term><menuchoice><shortcut><keycombo action="simul">&Ctrl;<keycap>,</keycap>
 </keycombo></shortcut><guimenu>View</guimenu><guimenuitem>Collapse All</guimenuitem></menuchoice></term>
@@ -574,7 +592,7 @@
 <listitem>
 <para>(This function is only available when <link
 linkend="view-hierarchical-key-list"><menuchoice><guimenu>View</guimenu>
-<guimenuitem>Hierarchical Key List</guimenuitem></menuchoice></link> is on.)</para>
+<guimenuitem>Hierarchical Certificate List</guimenuitem></menuchoice></link> is on.)</para>
 
 <para><action>Collapses all list items in the certificate list
 view,</action> &ie; hides all but the top-level items.</para>
@@ -591,14 +609,14 @@
 <sect1 id="menucertificates"><title><guimenu>Certificates</guimenu> Menu</title>
 
 <variablelist>
-
-<varlistentry id="certificates-validate">
-<term><menuchoice><shortcut><keycombo action="simul">&Shift;<keycap>F5</keycap></keycombo>
-</shortcut><guimenu>Certificates</guimenu><guimenuitem>Validate</guimenuitem></menuchoice></term>
-
+<!-- missing menu item
+<varlistentry id="certificates-certify">
+<term><menuchoice>
+<guimenu>Certificates</guimenu><guimenuitem>Certify Certificate...</guimenuitem></menuchoice></term>
 <listitem>
-<para><action>Validates selected (or all) keys.</action></para>
+<para><action>???</action></para>
 
+no longer in kde4
 <para>This is similar to <link
 linkend="view-redisplay"><menuchoice><shortcut><keycombo action="simul">
 <keycap>F5</keycap></keycombo></shortcut><guimenu>View</guimenu>
@@ -619,10 +637,9 @@
 decryption).</para></warning>
 </listitem>
 </varlistentry>
-
-
-
-<varlistentry id="certificates-refresh-crls">
+-->
+<!--not in 4.2
+varlistentry id="certificates-refresh-crls">
 <term><menuchoice><guimenu>Certificates</guimenu><guimenuitem>Refresh CRLs</guimenuitem></menuchoice></term>
 
 <listitem>
@@ -646,12 +663,42 @@
 
 <para>Use this function scarcely.</para></warning>
 </listitem>
+</varlistentry-->
+<!-- missing menu items
+<varlistentry>
+<term><menuchoice>
+<guimenu>Certificates</guimenu><guimenuitem>Change Ownertrust...</guimenuitem></menuchoice></term>
+<listitem>
+<para>???</para>
+</listitem>
 </varlistentry>
 
+<varlistentry>
+<term><menuchoice>
+<guimenu>Certificates</guimenu><guimenuitem>Expire Date...</guimenuitem></menuchoice></term>
+<listitem>
+<para>???</para>
+</listitem>
+</varlistentry>
 
+<varlistentry>
+<term><menuchoice>
+<guimenu>Certificates</guimenu><guimenuitem>Change Passphrase...</guimenuitem></menuchoice></term>
+<listitem>
+<para>???</para>
+</listitem>
+</varlistentry>
 
+<varlistentry>
+<term><menuchoice>
+<guimenu>Certificates</guimenu><guimenuitem>Add User-ID...</guimenuitem></menuchoice></term>
+<listitem>
+<para>???</para>
+</listitem>
+</varlistentry>
+-->
 <varlistentry id="certificates-delete">
-<term><menuchoice><shortcut><keycombo action="simul"><keycap>Delete</keycap></keycombo></shortcut>
+<term><menuchoice><shortcut><keycombo action="simul"><keycap>Del</keycap></keycombo></shortcut>
 <guimenu>Certificates</guimenu><guimenuitem>Delete</guimenuitem></menuchoice></term>
 
 <listitem>
@@ -669,40 +716,65 @@
 </listitem>
 </varlistentry>
 
+<varlistentry>
+<term><menuchoice><guimenu>Certificates</guimenu><guimenuitem>Dump Certificate</guimenuitem></menuchoice></term>
+<listitem>
+<para>Shows the detailed contents of the &gpgsm; CRL cache.</para>
+</listitem>
+</varlistentry>
 
-
-<varlistentry id="certificates-download">
+<!--not in 4.2
+varlistentry id="certificates-download">
 <term><menuchoice><guimenu>Certificates</guimenu><guimenuitem>Download</guimenuitem></menuchoice></term>
 
 <listitem>
 <para><action>Downloads the selected certificate(s) from the LDAP to the local keybox.</action></para>
 </listitem>
-</varlistentry>
+</varlistentry-->
 
 </variablelist>
 
 </sect1>
 
+<sect1 id="menutools"><title><guimenu>Tools</guimenu> Menu</title>
 
+<variablelist>
 
-<sect1 id="menucrls"><title><guimenu>CRLs</guimenu> Menu</title>
+<varlistentry id="tools-gnupg-log-viewer">
+<term><menuchoice><guimenu>Tools</guimenu><guimenuitem>GnuPG Log Viewer...</guimenuitem></menuchoice></term>
 
-<variablelist>
+<listitem>
+<para><action>Starts <ulink url="help:/kwatchgnupg/index.html">&kwatchgnupg;</ulink></action>, a tool to present the debug output of GnuPG application. If signing, encryption, or verification mysteriously stop working, you might find out why by looking at the log.</para>
+</listitem>
+</varlistentry>
 
+<varlistentry id="certificates-refresh-crls">
+<term><menuchoice><guimenu>Tools</guimenu><guimenuitem>Refresh X.509 or OpenPGP Certificates</guimenuitem></menuchoice></term>
+
+<listitem>
+<para>Refreshing X.509 or OpenPGP certificates implies downloading all certificates
+and CRLs, to check if any of them have been revoked in the meantime.</para>
+<para>This can put a severe strain on your own as well as other
+people's network connections, and can take up to an hour or more to
+complete, depending on your network connection, and the number of
+certificates to check.</para>
+</listitem>
+</varlistentry>
+
 <varlistentry id="crls-clear-crl-cache">
-<term><menuchoice><guimenu>CRLs</guimenu><guimenuitem>Clear CRL Cache</guimenuitem></menuchoice></term>
+<term><menuchoice><guimenu>Tools</guimenu><guimenuitem>Clear CRL Cache</guimenuitem></menuchoice></term>
 
 <listitem>
 <para><action>Clears the &gpgsm; CRL cache.</action></para>
 
 <para>You probably never need this. You can force a refresh of the CRL
 cache by selecting all certificates and using <link linkend="certificates-refresh-crls"><menuchoice>
-<guimenu>Certificates</guimenu><guimenuitem>Refresh CRLs</guimenuitem></menuchoice></link> instead.</para>
+<guimenu>Tools</guimenu><guimenuitem>Refresh Certificates</guimenuitem></menuchoice></link> instead.</para>
 </listitem>
 </varlistentry>
 
 <varlistentry id="crls-dump-crl-cache">
-<term><menuchoice><guimenu>CRLs</guimenu><guimenuitem>Dump CRL Cache</guimenuitem></menuchoice></term>
+<term><menuchoice><guimenu>Tools</guimenu><guimenuitem>Dump CRL Cache</guimenuitem></menuchoice></term>
 
 <listitem>
 <para><action>Shows the detailed contents of the &gpgsm; CRL
@@ -710,22 +782,20 @@
 </listitem>
 </varlistentry>
 
-</variablelist>
+<varlistentry id="settings-configure-gpgme-backend">
+<term><menuchoice><guimenu>Tools</guimenu><guimenuitem>Configure GnuPG Backend...</guimenuitem></menuchoice></term>
 
-</sect1>
+<listitem>
+<para><action>Opens a dialog that allows you to configure every aspect of
+&gpgsm; and other backend modules.</action></para>
 
-<sect1 id="menutools"><title><guimenu>Tools</guimenu> Menu</title>
-
-<variablelist>
-
-<varlistentry id="tools-gnupg-log-viewer">
-<term><menuchoice><guimenu>Tools</guimenu><guimenuitem>GnuPG Log Viewer...</guimenuitem></menuchoice></term>
-
-<listitem>
-<para><action>Starts <ulink url="help:/kwatchgnupg/index.html">&kwatchgnupg;</ulink></action></para>
+<para>This dialog is dynamically built from the output of the
+&gpgconf; utility and may thus change when backend modules are
+updated.</para>
 </listitem>
 </varlistentry>
 
+
 </variablelist>
 
 </sect1>
@@ -733,20 +803,23 @@
 <sect1 id="menusettings"><title><guimenu>Settings</guimenu> Menu</title>
 
 <variablelist>
+<!-- missing items
+<varlistentry>
+<term><menuchoice>
+<guimenu>Settings</guimenu><guimenuitem>Perform Selftest</guimenuitem></menuchoice></term>
+<listitem>
+<para>???</para>
+</listitem>
+</varlistentry>
 
-<varlistentry id="settings-configure-gpgme-backend">
-<term><menuchoice><guimenu>Settings</guimenu><guimenuitem>Configure GpgME Backend...</guimenuitem></menuchoice></term>
-
+<varlistentry>
+<term><menuchoice>
+<guimenu>Settings</guimenu><guisubmenu>Toolbars</guisubmenu></menuchoice></term>
 <listitem>
-<para><action>Opens a dialog that allows you to configure every aspect of
-&gpgsm; and other backend modules.</action></para>
-
-<para>This dialog is dynamically built from the output of the
-&gpgconf; utility and may thus change when backend modules are
-updated.</para>
+<para>???</para>
 </listitem>
 </varlistentry>
-
+-->
 <varlistentry id="settings-show-statusbar">
 <term><menuchoice><guimenu>Settings</guimenu><guimenuitem>Show Statusbar</guimenuitem></menuchoice></term>
 
@@ -754,7 +827,14 @@
 <para><action>Toggles the visibility of the bottom status bar.</action></para>
 </listitem>
 </varlistentry>
-
+<!-- missing item
+<varlistentry>
+<term><menuchoice><guimenu>Settings</guimenu><guimenuitem>Configure Toolbars...</guimenuitem></menuchoice></term>
+<listitem>
+<para>???</para>
+</listitem>
+</varlistentry>
+-->
 <varlistentry id="settings-configure-shortcuts">
 <term><menuchoice><guimenu>Settings</guimenu><guimenuitem>Configure Shortcuts...</guimenuitem></menuchoice></term>
 
@@ -779,9 +859,15 @@
 
 </sect1>
 
+<sect1 id="menuwindow"><title><guimenu>Window</guimenu> Menu</title>
+<para>The <guimenu>Window</guimenu> menu allows you to manage the tabs.
+Using the items in this menu you can rename a tab, add a new tab, duplicate the current tab, close the current tab, and move the current tab to the left or right.</para>
+
+<para>By clicking with the &RMB; click on a tab you open a context menu, where you can also select the same actions.</para>
+</sect1>
+
 <sect1 id="menuhelp"><title><guimenu>Help</guimenu> Menu</title>
 
-
 <para>The <guimenu>Help</guimenu> menu contains the standard &kde;
 help menu.</para>
 
@@ -800,28 +886,29 @@
 
 <variablelist>
 
-<varlistentry id="commandline-option-external">
-<term>&commandline-option-external;</term>
+<varlistentry>
+<term><option>--external</option></term>
+<listitem>
+<para>Run UI server only, hide main window</para>
+</listitem>
+</varlistentry>
 
+<varlistentry>
+<term><option>-p</option> <option>--openpgp</option></term>
 <listitem>
-<para><action>Specifies that &commandline-option-query; shall search
-remotely instead of in the local keybox.</action></para>
+<para>Use OpenPGP for the following operation</para>
 </listitem>
 </varlistentry>
 
-<varlistentry id="commandline-option-query">
-<term>&commandline-option-query;</term>
-
+<varlistentry>
+<term><option>-c</option> <option>--cms</option></term>
 <listitem>
-<para><action>Specifies that &kleopatra; shall start with the given
-query string instead of listing the complete local
-keybox.</action></para>
+<para>Use CMS (X.509, S/MIME) for the following operation</para>
 </listitem>
 </varlistentry>
 
 <varlistentry id="commandline-option-import-certificate">
-<term>&commandline-option-import-certificate;</term>
-
+<term><option>-i</option> <option>--import-certificate</option></term>
 <listitem>
 <para><action>Specifies a file or &URL; from which to import
 certificates (or secret keys) from.</action></para>
@@ -832,6 +919,48 @@
 </listitem>
 </varlistentry>
 
+<varlistentry>
+<term><option>-e</option> <option>--encrypt</option></term>
+<listitem>
+<para>Encrypt file(s)</para>
+</listitem>
+</varlistentry>
+
+<varlistentry>
+<term><option>-s</option> <option>--sign</option></term>
+<listitem>
+<para>Sign file(s)</para>
+</listitem>
+</varlistentry>
+
+<varlistentry>
+<term><option>-E</option> <option>--encrypt-sign</option></term>
+<listitem>
+<para>Encrypt and/or sign file(s)</para>
+</listitem>
+</varlistentry>
+
+<varlistentry>
+<term><option>-d</option> <option>--decrypt</option></term>
+<listitem>
+<para>Decrypt file(s)</para>
+</listitem>
+</varlistentry>
+
+<varlistentry>
+<term><option>-V</option> <option>--verify</option></term>
+<listitem>
+<para>Verify file/signature</para>
+</listitem>
+</varlistentry>
+
+<varlistentry>
+<term><option>-D</option> <option>--decrypt-verify</option></term>
+<listitem>
+<para>Decrypt and/or verify file(s)</para>
+</listitem>
+</varlistentry>
+
 </variablelist>
 
 </chapter>
@@ -850,30 +979,29 @@
 certificate searches. You can also configure their order, as well as
 some selected LDAP-related settings from the dynamic backend
 configuration dialog, available via <link
-linkend="settings-configure-gpgme-backend"><menuchoice><guimenu>Settings</guimenu>
-<guimenuitem>Configure GpgME Backend...</guimenuitem></menuchoice></link>.</para>
+linkend="settings-configure-gpgme-backend"><menuchoice><guimenu>Tools</guimenu>
+<guimenuitem>Configure GnuPG Backend...</guimenuitem></menuchoice></link>.</para>
 
-<para>To add a new server, click on the <guilabel>Add
-Service...</guilabel> button. In the dialog that appears, you can set
-the <guilabel>Server name</guilabel>, the <guilabel>Port</guilabel>
+<para>To add a new server, click on the <guilabel>New</guilabel> button. 
+Then you can set
+the <guilabel>Server Name</guilabel>, the <guilabel>Server Port</guilabel>
 (preset to the default LDAP port), the <guilabel>Base &dn;</guilabel>
 (sometimes referred to as the search root or search base), and the
-usual <guilabel>User name</guilabel> and
+usual <guilabel>User Name</guilabel> and
 <guilabel>Password</guilabel>, both of which are only needed if the
-server requires authentication. Clicking <guilabel>OK</guilabel> adds
-the server details to the list of servers, while
-<guilabel>Cancel</guilabel> dismisses the input.</para>
+server requires authentication.</para>
 
 <para>To remove a server from the search list, select it in the list,
-then press the <guilabel>Remove Service</guilabel> button.</para>
+then press the <guilabel>Delete</guilabel> button.</para>
 
+<!-- not in 4.2
 <para>To change the relative search order of servers, select one of
 them and move it up or down with the arrow buttons right next to the
 list.</para>
-
+-->
 <para>To set the LDAP timeout, &ie; the maximum time the backend will
 wait for a server to respond, simply use the corresponding input field
-labelled <guilabel>LDAP timeout</guilabel>.</para>
+labeled <guilabel>LDAP timeout (minutes:seconds)</guilabel>.</para>
 
 <para>If one of your servers has a large database, so that even
 reasonable searches like <userinput>Smith</userinput> hit the
@@ -938,7 +1066,7 @@
 
 </sect1>
 
-<sect1 id="configuration-dn-order"><title>Configuring the <guilabel>&dn;Attribute Order</guilabel></title>
+<sect1 id="configuration-dn-order"><title>Configuring the <guilabel>&dn; Attribute Order</guilabel></title>
 
 <para>Although &dn;s are hierarchical, the order of the individual
 components (called relative &dn;s (RDNs), or &dn; attributes) is not
@@ -1097,7 +1225,7 @@
 	linkend="configuration-appearance">visual appearance</link> of
 	keys based on a concept called <guilabel>Key
 	Categories</guilabel>. <guilabel>Key Categories</guilabel> are
-	also used to filter the list of certificates.This section
+	also used to filter the list of certificates. This section
 	describes how you can edit the available categories and add
 	new ones.
       </para>
@@ -1303,9 +1431,7 @@
 	      <entry><varname>was-validated</varname></entry>
 	      <entry>boolean</entry>
 	      <entry>
-		the key has been validated (see <link
-		linkend="certificates-validate"><menuchoice><shortcut><keycombo action="simul">&Shift;<keycap>F5</keycap></keycombo></shortcut>
-		<guimenu>Certificates</guimenu><guimenuitem>Validate</guimenuitem></menuchoice></link>).
+		the key has been validated.
 	      </entry>
 	    </row>
 	    <row>
@@ -1403,7 +1529,7 @@
         by an exclamation point (<literal>!</literal>), indicating negation. The tokens act
         in order on an internal list of contexts, which starts out
         empty. This is best explained by an example: <literal>any
-        !apperance</literal> is the same as
+        !appearance</literal> is the same as
         <literal>filtering</literal>, and <literal>appearance
         !appearance</literal> is producing the empty set, as is
         <literal>!any</literal>. However, the last two will be
@@ -1424,7 +1550,7 @@
         wins over less specific ones. If two filters have the same
         specificity, the one that comes first in the config file
         wins. A filter's specificity is proportional to the number of
-        critera it contains.
+        criteria it contains.
       </para>
 
       <example>
Index: doc/ktimetracker/index.docbook
===================================================================
--- doc/ktimetracker/index.docbook	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ doc/ktimetracker/index.docbook	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -99,12 +99,13 @@
 <sect1 id="starting">
 <title>Starting &karm;</title>
 
-<para>Type <command>karm</command> at a command prompt or select
-<guimenuitem>Personal Time Tracker</guimenuitem> from the
-<guisubmenu>Utilities</guisubmenu> group in the <guimenu>KDE start
+<para>Type <command>ktimetracker</command> at a command prompt or select
+<guimenuitem>Personal Time Tracker</guimenuitem> from the <menuchoice>
+<guimenu>Applications</guimenu><guisubmenu>Utilities</guisubmenu> 
+</menuchoice> group in the <guimenu>KDE start
 menu</guimenu>. The standard &Qt; and &kde; command options are
 available, and can be listed by entering
-<userinput><command>karm</command> <option>--help</option></userinput>
+<userinput><command>ktimetracker</command> <option>--help</option></userinput>
 at the command line.</para>
 
 <para>&karm; provides an additional command option that allows you to enter
@@ -921,7 +922,7 @@
 <term>
 <menuchoice>
 <guimenu>Settings</guimenu>
-<guimenuitem>Configure KArm</guimenuitem>
+<guimenuitem>Configure &karm;</guimenuitem>
 </menuchoice>
 </term>
 <listitem><para><action>Opens</action> a dialog to allow the user to
@@ -997,7 +998,7 @@
 
 <para>Contributors (in alphabetical order)</para>
 <itemizedlist>
-<listitem><para>Allen Winter <email>winterz@verizon.net</email></para></listitem>
+<listitem><para>Allen Winter <email>winter@kde.org</email></para></listitem>
 <listitem><para>&David.Faure; &David.Faure.mail;</para></listitem>
 <listitem><para>&Espen.Sand; <email>espen@kde.org</email></para></listitem>
 <listitem><para>Gioele Barabucci <email>gioele@gioelebarabucci.com</email></para></listitem>
Index: doc/kjots/index.docbook
===================================================================
--- doc/kjots/index.docbook	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ doc/kjots/index.docbook	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -155,12 +155,12 @@
 <guimenuitem>Delete Page</guimenuitem></menuchoice>.</para>
 
 <tip><para>If you need to insert the current date and time while you are 
-writing a note, you can use  <keycombo action="simul">&Ctrl;<keycap>I
+writing a note, you can use  <keycombo action="simul">&Ctrl;&Shift;<keycap>I
 </keycap></keycombo>.</para></tip>
 
 <para>So that you can get to the page you want to see, pages can (and
 should) be given a name. This can be done in the way you are used to: 
-select the page you want to rename, wait a second and click it once more. 
+double click the page you want to rename.
 You are then able to rename the page. Of course there is also a keyboard 
 shortcut, you can use that at any time while writing a note. The shortcut 
 is: <keycombo action="simul">&Ctrl;<keycap>M</keycap></keycombo>.</para>
Index: doc/knode/using-morefeatures.docbook
===================================================================
--- doc/knode/using-morefeatures.docbook	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ doc/knode/using-morefeatures.docbook	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -644,7 +644,7 @@
 the rules which are shown &mdash; you have the choice whether to show all
 rules or only the rules for a specific <glossterm>newsgroup</glossterm>.</para> 
 
-<para>If you chose a rule-name in the list you the rule will be displayed
+<para>If you choose a rule-name in the list the rule will be displayed
 on the right-hand side; now you can edit the rule. At the top you can change
 the name of the rule and set the newsgroups to which this rule applies.
 You can choose one or
@@ -725,7 +725,7 @@
 raise or lower the score, by the configured value, for articles to which
 this rule applies.  &knode; can also show you a little message when finding
 such an article or colorize the header in the article list; for example, you could make
-interesting articles scraeming pink so you would notice them very
+interesting articles screaming pink so you would notice them very
 quickly.</para> 
 
 <para>When leaving the editor, or when the 
Index: doc/knode/using-firststart.docbook
===================================================================
--- doc/knode/using-firststart.docbook	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ doc/knode/using-firststart.docbook	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -246,7 +246,7 @@
 <para>If this option is activated, the signature file is not handled
 as a text file, but as a program. The signature file will be started
 as a program and the output will be used as a signature. Through that
-you'll be able to chose a signature by accident or to use fortune to
+you'll be able to choose a signature by accident or to use fortune to
 generate a cool slogan every time.</para>
 
 </sect3>
@@ -825,7 +825,7 @@
 it as read.</para>
 
 <para>If <guilabel>Go to next unread thread</guilabel> is
-checked, &knode; automatically shows the next thread if you mark the
+checked, &knode; automatically shows the next thread if you mark
 the previous thread as read.</para>
 
 </sect3>
@@ -942,7 +942,7 @@
 
 <para>The <guibutton>Down</guibutton> button does the opposite
 action: select the filter you just shifted one up and
-press<guibutton>Down</guibutton> until it reaches its old
+press <guibutton>Down</guibutton> until it reaches its old
 position.</para>
 
 <para>With the two buttons <guibutton>Add Separator</guibutton> and
Index: doc/knode/using-subscribing.docbook
===================================================================
--- doc/knode/using-subscribing.docbook	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ doc/knode/using-subscribing.docbook	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -184,7 +184,7 @@
 </tip> 
 
 <para>Unfortunately there is no guarantee that your newsserver is
-providing all available newsgroups: many newsserver refuse groups
+providing all available newsgroups: many newsservers refuse groups
 publishing binary attachments; other groups are only available from
 special servers. &knode; provides you the possibility to use more than
 one news-server if you want to access alternative servers providing
@@ -446,7 +446,7 @@
 <varlistentry> 
 <term><guilabel>From</guilabel></term> 
 <listitem> 
-<para>The <guilabel>From</guilabel> column shows the author, or their
+<para>The <guilabel>From</guilabel> column shows the author, or his
 e-mail address if the author didn't give a name. You can configure
 your settings in
 <menuchoice><guimenu>Settings</guimenu><guimenuitem>Configure
@@ -578,7 +578,7 @@
 <para>You can navigate in articles, display an article and open or
 close threads with your mouse or keyboard.</para> 
 
-<para>When you select an article with your mouse its entry in the the
+<para>When you select an article with your mouse its entry in the
 article view gets colored; at the same time the header and body of
 this article appear in in the article window. If you want to read
 another article you can use the mouse to select it, or you can use
Index: doc/kalarm/index.docbook
===================================================================
--- doc/kalarm/index.docbook	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ doc/kalarm/index.docbook	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -261,20 +261,10 @@
 </listitem>
 
 <listitem>
-<para>Click the <mousebutton>Middle</mousebutton> mouse button on the
-system tray icon.</para>
-</listitem>
-
-<listitem>
 <para><mousebutton>Right</mousebutton> click in the alarm list and
 choose <menuchoice><guimenuitem>New</guimenuitem></menuchoice> from
 the context menu.</para>
 </listitem>
-
-<listitem>
-<para>Double click on empty space below the last entry in the alarm
-list.</para>
-</listitem>
 </itemizedlist>
 
 <para>Alternatively, you can create new alarms preconfigured from
@@ -423,32 +413,6 @@
 </sect2>
 
 <sect2>
-<title>Viewing an Alarm</title>
-
-<para>To view an existing alarm without the ability to modify it, do
-one of the following:</para>
-
-<itemizedlist>
-<listitem>
-<para>Select it by clicking on its entry in the alarm list. Then choose
-<menuchoice>
-<guimenu>Actions</guimenu><guimenuitem>View</guimenuitem>
-</menuchoice>.</para>
-</listitem>
-<listitem>
-<para><mousebutton>Right</mousebutton> click on its entry in the alarm
-list and choose
-<menuchoice><guimenuitem>View</guimenuitem></menuchoice>
-from the context menu.</para>
-</listitem>
-</itemizedlist>
-
-<para>This displays the <link linkend="alarm-edit-dlg">Alarm Edit
-dialog</link> in read-only mode.</para>
-
-</sect2>
-
-<sect2>
 <title>Acknowledging an Alarm</title>
 
 <para>See <link linkend="message-window">Alarm Message Window</link>
@@ -1745,7 +1709,7 @@
 when the message is to be redisplayed, or select <guilabel>Defer for
 time interval</guilabel> to enter how long after now (in hours and
 minutes) the message should be redisplayed. Then click
-<guibutton>Defer</guibutton> to defer the alarm message and close its
+<guibutton>OK</guibutton> to defer the alarm message and close its
 window.</para>
 
 <note><para>The time the alarm is deferred to must be earlier than its
@@ -1848,8 +1812,7 @@
 <variablelist>
 <varlistentry>
 <term><menuchoice><guimenuitem>Enable Alarms</guimenuitem></menuchoice></term>
-<listitem><para><action>Enables monitoring of alarms. This option
-only appears if alarms are currently disabled.</action></para>
+<listitem><para><action>Enables or disables monitoring of alarms.</action></para>
 <para>See
 <link linkend="enable-disable">Enabling and Disabling Alarms</link>
 for details.</para>
@@ -1857,16 +1820,6 @@
 </varlistentry>
 
 <varlistentry>
-<term><menuchoice><guimenuitem>Disable Alarms</guimenuitem></menuchoice></term>
-<listitem><para><action>Disables monitoring of alarms. This option
-only appears if alarms are currently enabled.</action></para>
-<para>See
-<link linkend="enable-disable">Enabling and Disabling Alarms</link>
-for details.</para>
-</listitem>
-</varlistentry>
-
-<varlistentry>
 <term><menuchoice><guimenuitem>New Alarm</guimenuitem></menuchoice></term>
 <listitem><para><action>After you select the alarm type from the list
 which appears, opens the Alarm Edit dialog to create a new
@@ -2029,14 +1982,14 @@
 
 <itemizedlist>
 <listitem>
-<para>Select <menuchoice><guimenu>Actions</guimenu>
-<guimenuitem>Disable Alarms</guimenuitem></menuchoice>.</para>
+<para>Unselect <menuchoice><guimenu>Actions</guimenu>
+<guimenuitem>Enable Alarms</guimenuitem></menuchoice>.</para>
 </listitem>
 
 <listitem>
 <para><mousebutton>Right</mousebutton> click on the system tray icon
-and choose
-<menuchoice><guimenuitem>Disable Alarms</guimenuitem></menuchoice>
+and uncheck
+<menuchoice><guimenuitem>Enable Alarms</guimenuitem></menuchoice>
 from the context menu.</para>
 </listitem>
 
Index: doc/kaddressbook/index.docbook
===================================================================
--- doc/kaddressbook/index.docbook	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ doc/kaddressbook/index.docbook	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -544,8 +544,8 @@
 <para>The Photo will be shown in the contact preview and in the Icon view mode. However the Logo picture will only be shown in Icon view and only if there's no photo available.</para>
 <para>To reset a photo or logo simply click on it with the &RMB; and select <guilabel>Reset</guilabel>.</para>
 </sect3>
-<sect3 id="managing-contacts-misc-free-busy-informations">
-<title>Location of Free/Busy informations</title>
+<sect3 id="managing-contacts-misc-free-busy-information">
+<title>Location of Free/Busy information</title>
 <para>Here you can select a path to a contact's Free/Busy information, which are used when you add him to an event in &korganizer; or &kontact;'s calendar view.</para>
 </sect3>
 </sect2>
@@ -813,7 +813,7 @@
 <varlistentry>
 <term><guilabel>CSV List</guilabel></term>
 <listitem><para>CSV (comma separated value) is a format that is used
-by many (address book) applications, it stores the contact informations in a plaintext field separated by commas. This makes CSV very flexible and good for interaction with scripts.</para></listitem>
+by many (address book) applications, it stores the contact information in a plaintext field separated by commas. This makes CSV very flexible and good for interaction with scripts.</para></listitem>
 </varlistentry>
 
 <varlistentry>
Index: doc/korganizer/index.docbook
===================================================================
--- doc/korganizer/index.docbook	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ doc/korganizer/index.docbook	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -454,7 +454,7 @@
 </procedure>
 
 <para>Alternatively, you can configure the &korganizer; resources (plus all
-other &kde; resources), in the &kcontrolcenter;, using the <guilabel>&kde;
+other &kde; resources), in the &systemsettings;, using the <guilabel>&kde;
 Resources</guilabel> configuration module.</para>
 
 <para>Among the existing resources, you can find:</para>
@@ -512,7 +512,7 @@
 <listitem><para>
 If you have access to a server that supports the
 <ulink url="http://www.groupdav.org">GroupDav protocol</ulink>, add this
-resource in order to be able to to save (and load) events<!--, journals, free/busy information?--> and to-dos
+resource in order to be able to save (and load) events<!--, journals, free/busy information?--> and to-dos
 to the server. To add the resource, you will need to know the server &URL;, your
 user name and your password. The GroupDav protocol supports the storage of 
 contacts, so you may want to add and configure the &kaddressbook;
@@ -530,7 +530,7 @@
 <listitem><para>
 If you have access to a
 <ulink url="http://www.novell.com/products/groupwise">Novell GroupWise Server</ulink>
-(version 6.5 or later), add this resource in order to be able to to save (and load)
+(version 6.5 or later), add this resource in order to be able to save (and load)
 events, free/busy information <!--,journals ?-->and to-dos to the server. To add the resource, you will
 need to know the server &URL;, your user name and your password. There is
 support for storage of contacts, so you may want to configure &kaddressbook;
@@ -550,7 +550,7 @@
 <term><guilabel>Calendar on IMAP Server via &kmail;</guilabel></term>
 <listitem><para>
 If you have access to a server that shares calendar data via IMAP, add this
-resource in order to be able to to save (and load) events, to-dos, free/busy
+resource in order to be able to save (and load) events, to-dos, free/busy
 information and journal entries to the IMAP server. To enable IMAP access, you
 will need to configure &kmail; first, then add the &korganizer; resource.
 Also, since you are using &kmail; to contact the server, &korganizer; will
@@ -615,7 +615,7 @@
 <listitem><para>
 If you have access to a
 <ulink url="http://www.microsoft.com/exchange">Exchange 2000 Server</ulink>,
-add this resource in order to be able to to save (and load)
+add this resource in order to be able to save (and load)
 events FIXME:,journals, free/busy information and to-dos? to the server. To add the resource, you will
 need to know the server &URL;, FIXME:port? your user name and your password. There
 is support for (read only) contacts, so you may want to configure &kaddressbook;
@@ -704,13 +704,13 @@
 <term><guilabel>SUSE &Linux; OpenExchange Server</guilabel></term>
 <listitem><para>
 If you have access to a
-<ulink url="http://www.novell.com/products/groupwise">SUSE &Linux; OpenExchange
-Server</ulink>, version 4.1, add this resource in order to be able to to save
+<ulink url="http://www.novell.com/coolsolutions/openexchange/">SUSE &Linux; OpenExchange
+Server</ulink>, version 4.1, add this resource in order to be able to save
 (and load) events, free/busy information <!--,journals ?-->and to-dos to the server. To add the
 resource, you will need to know the server &URL;, your user name and your
 password. There is support for storage of contacts, so you may want to configure
 &kaddressbook; resource.</para>
-<para>The most practical way to configure the access to a GroupWise server is
+<para>The most practical way to configure the access to an OpenExchange server is
 to use the <application>sloxwizard</application> wizard. You can start it
 from the command line prompt:
 
@@ -728,7 +728,7 @@
 <listitem><para>
 If you have access to a
 <ulink url="http://www.egroupware.org">eGroupware
-Server</ulink>, version 1.0, add this resource in order to be able to to save
+Server</ulink>, version 1.0, add this resource in order to be able to save
 (and load) events, free/busy information <!--,journals ?-->and to-dos to the server. To add the
 resource, you will need to know the server &URL;, your user name and your
 password. There is support for storage of contacts, so you may want to configure
@@ -1060,7 +1060,7 @@
 times. Hovering the mouse over an calendar item will bring up a tooltip
 with the item detailed information. To make &korganizer; show a red line
 marking the current-time on the current day (the Marcus Bains line),
-check the <guilabel>Show current-time (Marcus Bains Line)</guilabel> box in the
+check the <guilabel>Show current-time (Marcus Bains) line</guilabel> box in the
 <link linkend="config-main-views">&korganizer; view
 configuration</link>.</para>
 
@@ -1334,7 +1334,7 @@
 <para>The <menuchoice><guimenu>View</guimenu>
 <guisubmenu>Filter</guisubmenu></menuchoice> submenu and the filter toolbar drop
 down offer access to all available filters  created using
-the <link linkend="menu-settings-edit-filters"><guilabel>Edit
+the <link linkend="menu-settings-edit-filters"><guilabel>Edit Calendar 
 Filters</guilabel></link> dialog. To toggle the display of the filters toolbar
 on and off, choose the <menuchoice><guimenu>Settings</guimenu>
 <guisubmenu>Toolbars</guisubmenu><guimenuitem>Filter toolbar</guimenuitem></menuchoice>.
@@ -1429,7 +1429,7 @@
 
 <para>This is a thorough description of the individual event window fields and
 widgets. Not all fields have to be filled in; some can be left empty. Read the
-<link linkend="entering-data-required-fields">Required fields section</link>
+<link linkend="entering-data-required-fields">Required fields</link> section 
 for detailed information. And if you prefer to learn by example, there's one
 in the <link linkend="examples-entering-event">Entering event</link> section.
 </para>
@@ -1491,7 +1491,7 @@
 reminded, or click the <guibutton>Advanced</guibutton> button to open the
 <guilabel>Edit Reminders</guilabel> dialog. Using this dialog, you can set
 repeating intervals for your reminders, and create special reminders that play
-sounds, run programs, or send emails.</para>
+sounds, or run programs.</para>
 
 <!--Click the musical <guiicon>Note</guiicon> symbol to choose the
 alarm sound. Click the <guiicon>Gear</guiicon> icon to browse for a
@@ -1502,7 +1502,7 @@
 <term><guilabel>Show Time As:</guilabel></term>
 <listitem><para>The duration of the event may be shown as Busy or Free in your
 schedule. Choose it from the <guilabel>Show Time As</guilabel>
-menu.</para></listitem>
+drop down box.</para></listitem>
 </varlistentry>
 
 <varlistentry>
@@ -1520,7 +1520,7 @@
 <term><guilabel>Select Categories</guilabel></term>
 <listitem><para>You can assign several
 <link linkend="categories-view">categories</link> to a calendar item. Click the
-<guilabel>Select Categories</guilabel> button to open the
+<guilabel>Select</guilabel> button to open the
 <guilabel>Select Categories</guilabel> dialog. Check the category boxes to
 assign suitable categories to the event. You can also add a new category, modify
 a category or delete a category by pressing the button
@@ -1552,7 +1552,7 @@
 
 </variablelist>
 
-<para>When you want to confirm, call off or revert the entered data, choose
+<para>When you want to confirm, apply or call off the entered data, choose
 among the <link linkend="reference-action-buttons">Action Buttons</link>,
 <guibutton>OK</guibutton>, <guibutton>Apply</guibutton> and
 <guibutton>Cancel</guibutton>.</para>
@@ -1629,7 +1629,7 @@
 <para>This is similar to Monthly.  You need to choose whether or not you
 are indicating a calendar day of the year (&eg;, the 250th day of the
 year) - <guilabel>Recur on day <replaceable>#</replaceable> of the
-year</guilabel>, in in a specific week on a specific day of the week of a month
+year</guilabel>, in a specific week on a specific day of the week of a month
 (&eg;, the 2nd Tuesday of March), or the day of the month in a
 particular month of the year - <guilabel>Recur on day <replaceable>#</replaceable>
 of the <replaceable>month</replaceable></guilabel>.  By default, &korganizer;
@@ -1695,9 +1695,9 @@
 identity can be set in the <guilabel>Personal</guilabel> section of the
 &korganizer; configuration, other identities in the <guilabel>Security &amp;
 Privacy</guilabel>-&gt;<guilabel>Password &amp; User Account</guilabel> section
-of the &kcontrolcenter;. In addition, identities are gathered from your &kmail;
+of the &systemsettings;. In addition, identities are gathered from your &kmail;
 settings and from your address book. If you choose to set it globally for &kde;
-in the &kcontrolcenter;, be sure to check the <guilabel>Use email settings from
+in the &systemsettings;, be sure to check the <guilabel>Use email settings from
 Control Center</guilabel>' box in the <guilabel>Personal</guilabel> section of
 the &korganizer; configuration.</para></listitem>
 </varlistentry>
@@ -1953,7 +1953,7 @@
 <varlistentry>
 <term><guilabel>Priority</guilabel></term>
 <listitem><para>Assign a priority to your to-do.  This drop down menu offers
-priorities from one to five, one being the highest.  Initially to-dos are set
+priorities from one to nine, one being the highest.  Initially to-dos are set
 to priority five (medium).</para></listitem>
 </varlistentry>
 
@@ -1969,7 +1969,7 @@
 reminded, or click the <guibutton>Advanced</guibutton> button to open the
 <guilabel>Edit Reminders</guilabel> dialog. Using this dialog, you can set
 repeating intervals for your reminders, and create special reminders that play
-sounds, run programs, or send emails.</para>
+sounds, or run programs.</para>
 
 <!--Click the musical <guiicon>Note</guiicon> symbol to choose the
 alarm sound. Click the <guiicon>Gear</guiicon> icon to browse for a
@@ -2469,13 +2469,13 @@
 &korganizer; window.</para>
 
 <para>Localization information like date and time formats can be
-configured from &kcontrolcenter; within the <menuchoice>
+configured from &systemsettings; within the <menuchoice>
 <guisubmenu>Regional &amp; Accessibility</guisubmenu> <guimenuitem>Country/Region &amp;
 Language</guimenuitem> </menuchoice> module.  This control module can be
 accessed from within &korganizer;: just choose the <menuchoice><guimenu>
 Settings</guimenu><guimenuitem>Configure Date &amp;
 Time...</guimenuitem></menuchoice> menu item.  &korganizer; has to be restarted
-for changes done in &kcontrolcenter; to take effect.</para>
+for changes done in &systemsettings; to take effect.</para>
 
 <para>To configure where &korganizer; stores and retrieves calendar events,
 journal entries and to-dos, (in local files, groupware servers, journal entries as blogs,
@@ -2499,7 +2499,7 @@
 <varlistentry>
 <term><guilabel>Use email settings from control center</guilabel></term>
 <listitem><para>Check this box to use your name and email address as set in
-&kcontrolcenter; (<menuchoice><guimenuitem>Security &amp; Privacy</guimenuitem>
+&systemsettings; (<menuchoice><guimenuitem>Security &amp; Privacy</guimenuitem>
 <guimenuitem>Password &amp; User Account</guimenuitem></menuchoice>).</para>
 </listitem>
 </varlistentry>
@@ -2509,7 +2509,7 @@
 <listitem><para><guilabel>Full name</guilabel> is initially set to
 <quote>Anonymous</quote> with an email address of
 <quote>nobody@nowhere</quote>. You can change your name by directly
-entering it here or you can use your Email Settings from &kcontrolcenter; (see
+entering it here or you can use your Email Settings from &systemsettings; (see
 above).  This name will be displayed by default as
 <guilabel>Organizer</guilabel> in to-dos and Events.</para></listitem> 
 </varlistentry>
@@ -2649,10 +2649,10 @@
 <variablelist>
 
 <varlistentry>
-<term><guilabel>Enable tooltips displaying summary of events</guilabel></term>
+<term><guilabel>Enable tooltips for displaying summaries</guilabel></term>
 <listitem><para>If your summary for an event is longer than would fit in the
-current View, the remaining characters are not displayed. Check <guilabel>Enable
-tooltips displaying summary of events</guilabel> if you want the full summary
+current View, the remaining characters are not displayed. Check <guilabel>Enable 
+tooltips for dispaying summaries</guilabel> if you want the full summary
 displayed when the hovering the mouse pointer over the appointment for a few
 seconds.</para></listitem>
 </varlistentry>
@@ -2884,7 +2884,7 @@
 <varlistentry>
 <term><guilabel>Working hours color</guilabel></term>
 <listitem><para>This button opens the <guilabel>Select Color</guilabel> dialog,
-allowing you to select the agenda view.</para></listitem>
+allowing you to select color of the working hours background in the agenda view.</para></listitem>
 </varlistentry>
 
 <varlistentry>
@@ -3029,7 +3029,7 @@
 <variablelist>
 
 <varlistentry>
-<term><guilabel>Publish free/busy information</guilabel></term>
+<term><guilabel>Publish free/busy information automatically</guilabel></term>
 <listitem><para>Enable this option if you wish your Free/Busy information to be
 uploaded automatically. Note that you may skip this option and choose to mail or
 upload your Free/Busy information via the <guilabel>Schedule</guilabel> menu of
@@ -3043,7 +3043,7 @@
 </varlistentry>
 
 <varlistentry>
-<term><guilabel>Minimum time between uploads in minutes</guilabel></term>
+<term><guilabel>Minimum time between uploads (in minutes)</guilabel></term>
 <listitem><para>In case you choose to publish your information automatically,
 you may configure the interval of time in minutes between each upload.</para>
 </listitem>
@@ -3205,7 +3205,7 @@
 <itemizedlist>
 <listitem><para>The tool set is configured in the <menuchoice><guimenu>
 Settings</guimenu><guimenuitem>Configure
-Toolbars....</guimenuitem></menuchoice> menu item.
+Toolbars...</guimenuitem></menuchoice> menu item.
 </para></listitem>
 <listitem><para>The graphic style (icon size, text position, &etc;) is
 adjusted through the <guimenu>Toolbar Context Menu</guimenu>. Right click the
@@ -4001,7 +4001,7 @@
 <guimenuitem>New Sub-to-do...</guimenuitem>
 </menuchoice></term>
 <listitem><para>Choose <guilabel>New Sub-to-do...</guilabel> to <action>start
-writing a new sub-to-do. The currently selected to-do will be the the
+writing a new sub-to-do. The currently selected to-do will be the
 sub-to-do parent.</action>. Initially the to-do has no due date, but you can
 specify one.</para>
 <para>You can get a detailed description of the to-do window in <link
Index: kalarm/kalarm.h
===================================================================
--- kalarm/kalarm.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kalarm/kalarm.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -23,7 +23,7 @@
 
 #undef QT3_SUPPORT
 
-#define KALARM_VERSION "2.1.5"
+#define KALARM_VERSION "2.1.6"
 #define KALARM_NAME "KAlarm"
 #define KALARM_DBUS_SERVICE  "org.kde.kalarm"  // D-Bus service name of KAlarm application
 
Index: kalarm/mainwindow.cpp
===================================================================
--- kalarm/mainwindow.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kalarm/mainwindow.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -51,6 +51,7 @@
 #include <QDropEvent>
 #include <QResizeEvent>
 #include <QCloseEvent>
+#include <QTimer>
 
 #include <kmenubar.h>
 #include <ktoolbar.h>
@@ -518,7 +519,10 @@
 	mActionFindPrev = KStandardAction::findPrev(mListView, SLOT(slotFindPrev()), actions);
 	KStandardAction::selectAll(mListView, SLOT(selectAll()), actions);
 	KStandardAction::deselect(mListView, SLOT(clearSelection()), actions);
-	KStandardAction::quit(this, SLOT(slotQuit()), actions);
+	// Quit only once the event loop is called; otherwise, the parent window will
+	// be deleted while still processing the action, resulting in a crash.
+	KAction* act = KStandardAction::quit(0, 0, actions);
+	connect(act, SIGNAL(triggered(bool)), SLOT(slotQuit()), Qt::QueuedConnection);
 	KStandardAction::keyBindings(this, SLOT(slotConfigureKeys()), actions);
 	KStandardAction::configureToolbars(this, SLOT(slotConfigureToolbar()), actions);
 	KStandardAction::preferences(this, SLOT(slotPreferences()), actions);
@@ -1069,7 +1073,10 @@
 }
 
 /******************************************************************************
-*  Called when the Quit menu item is selected.
+* Called when the Quit menu item is selected.
+* Note that this must be called by the event loop, not directly from the menu
+* item, since otherwise the window will be deleted while still processing the
+* menu, resulting in a crash.
 */
 void MainWindow::slotQuit()
 {
@@ -1097,7 +1104,9 @@
 		{
 			// There is no system tray icon, and this is the last main
 			// window, so closing it will quit the application.
-			theApp()->doQuit(this);
+			// Quit once the close event has been processed. Deleting the
+			// window while still processing the event handler can cause a crash.
+			QTimer::singleShot(0, this, SLOT(slotDoQuit()));
 			ce->ignore();
 			return;
 		}
Index: kalarm/Changelog
===================================================================
--- kalarm/Changelog	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kalarm/Changelog	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -1,6 +1,9 @@
 KAlarm Change Log
 
-=== Version 2.1.5 --- 7 February 2009 ===
+=== Version 2.1.6 --- 4 March 2009 ===
+Fix crash when KAlarm quits.
+
+=== Version 2.1.5 (KDE 4.2.1) --- 7 February 2009 ===
 - Disable inapplicable alarm types in alarm edit dialogue Load Template list.
 - Prevent multiple identical error messages being displayed for the same alarm.
 - Fix possible crash on alarm refresh, or removal or disabling of a resource.
Index: kalarm/kalarmapp.cpp
===================================================================
--- kalarm/kalarmapp.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kalarm/kalarmapp.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -1021,7 +1021,6 @@
 void KAlarmApp::removeWindow(TrayWindow*)
 {
 	mTrayWindow = 0;
-	quitIf();
 }
 
 /******************************************************************************
Index: kalarm/resources/kalarm_manager.desktop
===================================================================
--- kalarm/resources/kalarm_manager.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kalarm/resources/kalarm_manager.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -18,6 +18,7 @@
 Name[kk]=Ескертулер
 Name[km]=ជូន​ដំណឹង
 Name[ko]=알람
+Name[lt]=Priminimai
 Name[lv]=Atgādinājumi
 Name[nb]=Varslinger
 Name[ne]=संसूचक
Index: kalarm/traywindow.h
===================================================================
--- kalarm/traywindow.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kalarm/traywindow.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -1,7 +1,7 @@
 /*
  *  traywindow.h  -  the KDE system tray applet
  *  Program:  kalarm
- *  Copyright © 2002-2008 by David Jarvie <djarvie@kde.org>
+ *  Copyright © 2002-2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -45,9 +45,6 @@
 		MainWindow*  assocMainWindow() const               { return mAssocMainWindow; }
 		void         setAssocMainWindow(MainWindow* win)   { mAssocMainWindow = win; }
 
-	public slots:
-		void         slotQuit();
-
 	signals:
 		void         deleted();
 
@@ -63,6 +60,7 @@
 		void         slotPreferences();
 		void         setEnabledStatus(bool status);
 		void         slotResourceStatusChanged();
+		void         slotQuit();
 
 	private:
 		QString      tooltipAlarmText() const;
Index: kalarm/traywindow.cpp
===================================================================
--- kalarm/traywindow.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kalarm/traywindow.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -39,6 +39,7 @@
 #include <QToolTip>
 #include <QMouseEvent>
 #include <QList>
+#include <QTimer>
 
 #include <kactioncollection.h>
 #include <ktoggleaction.h>
@@ -108,7 +109,10 @@
 	// Replace the default handler for the Quit context menu item
 	const char* quitName = KStandardAction::name(KStandardAction::Quit);
 	delete actions->action(quitName);
-	KStandardAction::quit(this, SLOT(slotQuit()), actions);
+	// Quit only once the event loop is called; otherwise, the parent tray icon
+	// will be deleted while still processing the action, resulting in a crash.
+	a = KStandardAction::quit(0, 0, actions);
+	connect(a, SIGNAL(triggered(bool)), SLOT(slotQuit()), Qt::QueuedConnection);
 
 	// Set icon to correspond with the alarms enabled menu status
 	setEnabledStatus(theApp()->alarmsEnabled());
@@ -163,6 +167,9 @@
 
 /******************************************************************************
 * Called when the Quit context menu item is selected.
+* Note that this must be called by the event loop, not directly from the menu
+* item, since otherwise the tray icon will be deleted while still processing
+* the menu, resulting in a crash.
 */
 void TrayWindow::slotQuit()
 {
Index: Mainpage.dox
===================================================================
--- Mainpage.dox	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ Mainpage.dox	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -30,8 +30,6 @@
         * - <a href="kmail/html/index.html"><b>kmail</b></a>
         *   (<a href="kmail/html/classes.html">classes</a>)\n
         *   <i>A fully-featured email client.</i>
-        * - <a href="kmobiletools/html/index.html"><b>kmobiletools</b></a>
-        *   (<a href="kmobiletools/html/classes.html">classes</a>)\n
         *   <i>An application specially designed to manage mobile phones.</i>
         * - <a href="knode/html/index.html"><b>knode</b></a>
         *   (<a href="knode/html/classes.html">classes</a>)\n
Index: CMakeLists.txt
===================================================================
--- CMakeLists.txt	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ CMakeLists.txt	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -89,15 +89,6 @@
     macro_log_feature(X11_Xscreensaver_FOUND "X11 screensaver extension" "X Window Screen Saver Development Library" "http://xorg.freedesktop.org" FALSE "" "Required for building the KTimeTracker Program")
   endif(X11_FOUND)
 
-# uncomment the following block for 4.3 in order to enable kitchensync
-#  if (NOT WIN32)
-#     set(OPENSYNC_MIN_VERSION 0.38)
-#     macro_optional_find_package(OpenSync)
-#     macro_log_feature(OPENSYNC_FOUND "opensync" "OpenSync Development Libraries" "http://www.opensync.org" FALSE "0.38 or greater" "Needed to provide syncing functionality in KDE PIM applications. Necessary to compile kitchensync.")
-#     macro_optional_find_package(GLIB2)
-#     macro_log_feature(GLIB2_FOUND "glib2" "Low-level core library for data structure handling, portability wrappers, etc." "http://www.gtk.org" FALSE "2.x" "Needed to provide synching applications from KDE PIM applications. Necessary to compile kitchensync and other PIM applications.")
-#  endif (NOT WIN32)
-
   macro_optional_find_package(GNOKII)
   macro_bool_to_01(GNOKII_FOUND HAVE_GNOKII_H)
   macro_log_feature(GNOKII_FOUND "gnokii" "Gnokii Development Libraries" "http://www.gnokii.org" FALSE "" "Needed to provide the ability to import and export KDE addressbook entries to/from mobile phones that are accessible via gnokii")
@@ -219,43 +210,15 @@
   endif(KMAIL_SUPPORTED)
 
   if(NOT WIN32)
-#enable kmobiletools 4.3 if there is interest
-#     set(KMOBILETOOLS_SUPPORTED TRUE)
-#     add_definitions(-DKMOBILETOOLS_SUPPORTED)
-#     message(STATUS "KMobileTools support enabled.")
-#     macro_optional_add_subdirectory(kmobiletools)
-      set(KMOBILETOOLS_SUPPORTED FALSE)
-
      set(KPILOT_SUPPORTED TRUE)
      add_definitions(-DKPILOT_SUPPORTED)
      message(STATUS "KPilot support enabled.")
      macro_optional_add_subdirectory(kpilot)
-
-     if(OPENSYNC_FOUND AND GLIB2_FOUND)
-       set(KITCHENSYNC_SUPPORTED TRUE)
-       add_definitions(-DKITCHENSYNC_SUPPORTED)
-       message(STATUS "KitchenSync support enabled.")
-       macro_optional_add_subdirectory(kitchensync)
-     else(OPENSYNC_FOUND AND GLIB2_FOUND)
-       set(KITCHENSYNC_SUPPORTED FALSE)
-       if(NOT OPENSYNC_FOUND)
-         message(STATUS "KitchenSync support disabled (OpenSync not found).")
-       endif(NOT OPENSYNC_FOUND)
-       if(NOT GLIB2_FOUND)
-         message(STATUS "KitchenSync support disabled (GLIB not found).")
-       endif(NOT GLIB2_FOUND)
-     endif(OPENSYNC_FOUND AND GLIB2_FOUND)
   else(NOT WIN32)
-     set(KMOBILETOOLS_SUPPORTED FALSE)
-     message(STATUS "KMobileTools support DISABLED (Windows target).")
      set(KPILOT_SUPPORTED FALSE)
      message(STATUS "KPilot support DISABLED (Windows target).")
-     set(KITCHENSYNC_SUPPORTED FALSE)
-     message(STATUS "KitchenSync support DISABLED (Windows target).")
   endif(NOT WIN32)
 
-#enable korn in 4.3 if there is interest
-# macro_optional_add_subdirectory(korn)
   add_subdirectory(kresources)
   macro_optional_add_subdirectory(kontact)
 
Index: libkholidays/holidays/holiday_se
===================================================================
--- libkholidays/holidays/holiday_se	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ libkholidays/holidays/holiday_se	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -23,8 +23,8 @@
 :Before 2005
 :black "Nationaldagen" black on 6.6
 weekend "Nationaldagen" weekend on 6.6
-black "Midsommarafton" black on friday before 26.6
-weekend "Midsommardagen" weekend on saturday before 27.6
+black "Midsommarafton" black on friday before 25.6
+weekend "Midsommardagen" weekend on saturday before 26.6
 blue "Vintertid" on last sunday in october
 weekend "Alla helgons dag" weekend on first sunday in november minus 1
 black "1. Advent" on sunday before 24.12 minus 21 days
Index: ktimetracker/timetrackerwidget.cpp
===================================================================
--- ktimetracker/timetrackerwidget.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ ktimetracker/timetrackerwidget.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -692,6 +692,7 @@
   dialog->addPage( storagePage, i18n( "Storage" ), "system-file-manager" );
 
   dialog->exec();
+  delete dialog;
   showSearchBar( !KTimeTrackerSettings::configPDA() );
   reconfigureFiles();
 }
Index: kjots/Kjots.desktop
===================================================================
--- kjots/Kjots.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kjots/Kjots.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -20,7 +20,7 @@
 GenericName[ja]=メモ帳
 GenericName[km]=កម្មវិធី​ទទួល​ចំណាំ
 GenericName[ko]=메모장
-GenericName[lt]=Pastabų gavėjas
+GenericName[lt]=Konspektavimo įrankis
 GenericName[lv]=Piezīmju blociņš
 GenericName[nb]=Notisblokk
 GenericName[nds]=Notizenprogramm
Index: kjots/kjotspart.desktop
===================================================================
--- kjots/kjotspart.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kjots/kjotspart.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -1,5 +1,6 @@
 [Desktop Entry]
 Name=KJotsPart
+Name[lt]=KJots dalis
 Name[nn]=KJots-del
 Name[pa]=ਕੇਜੋਟਸਪਾਰਟ
 Name[pl]=Moduł Notatek
Index: README
===================================================================
--- README	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ README	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -22,7 +22,6 @@
 * kaddressbook: The KDE addressbook application.
 * kmail: the KDE mail client
 * kmailcvt: tool for importing mail related data from other programs
-* kmobiletools: an application specially designed to manage mobile phones
 * knode: UseNet client
 * korganizer: a calendar-of-events, todo-list manager, journal 
 * kalarm: gui for setting up personal alarm messages, emails and commands
@@ -33,7 +32,6 @@
 * kfile-plugins: vCard KFIleItem plugin.
 * knotes: yellow notes application
 * konsolekalendar: Command line tool for accessing calendar files.
-* korn: mail checker
 * akregator: Feed reader
 * kjots: manager for several "books" with a subject and notes
 
Index: kpilot/Messages.sh
===================================================================
--- kpilot/Messages.sh	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kpilot/Messages.sh	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -1,2 +1,3 @@
 #! /usr/bin/env bash
+$EXTRACTRC `find . -name \*.rc -o -name \*.ui -o -name \*.kcfg` >> rc.cpp
 $XGETTEXT `find . -name \*.cc -o -name \*.cpp -o -name \*.h` -o $podir/kpilot.pot
Index: kpilot/conduits/todo/kpilot-conduit-todo.desktop
===================================================================
--- kpilot/conduits/todo/kpilot-conduit-todo.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kpilot/conduits/todo/kpilot-conduit-todo.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -42,6 +42,7 @@
 Name[ja]=To-Do
 Name[km]=​ការងារ​ត្រូវ​ធ្វើ
 Name[ko]=할 일
+Name[lt]=Darbas
 Name[lv]=Darbi
 Name[nb]=Gjøremål
 Name[nds]=Opgaav
Index: kpilot/conduits/calendar/calendarconduit.cc
===================================================================
--- kpilot/conduits/calendar/calendarconduit.cc	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kpilot/conduits/calendar/calendarconduit.cc	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -205,6 +205,11 @@
 			}
 			else
 			{
+				// Events that end at midnight cause problems
+				// (http://bugs.kde.org/show_bug.cgi?id=183631); however, events with
+				// no time associated with them are stored as beginning and ending
+				// at midnight on the same day, and these are OK.  Other events that end at
+				// midnight will need to be adjusted.
 				QDateTime hhDtEnd = hhEntry.dtEnd();
 				QDateTime hhDtStart = hhEntry.dtStart();
 				QDateTime pcDtEnd = pcEvent->dtEnd().dateTime().toLocalTime();
Index: kontact/plugins/akregator/akregator.setdlg
===================================================================
--- kontact/plugins/akregator/akregator.setdlg	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/akregator/akregator.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -66,6 +66,7 @@
 Comment[ja]=フィードリーダー
 Comment[km]=កម្មវិធី​អាន​មតិព័ត៌មាន
 Comment[ko]=피드 리더
+Comment[lt]=Kanalų skaitytuvė
 Comment[lv]=Ziņu lasītājs
 Comment[nb]=Kildeleser
 Comment[nds]=Mellenstroom-Kieker
Index: kontact/plugins/planner/planner.setdlg
===================================================================
--- kontact/plugins/planner/planner.setdlg	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/planner/planner.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -12,6 +12,7 @@
 Name[ja]=スケジュール帳
 Name[km]=កម្មវិធីធ្វើ​គម្រោង
 Name[ko]=플래너
+Name[lt]=Planuoklis
 Name[lv]=Plānotājs
 Name[nb]=Planlegger
 Name[nn]=Planleggjar
@@ -41,6 +42,7 @@
 Comment[ja]=スケジュール帳の要約
 Comment[km]=សេចក្ដី​សង្ខេប​របស់​កម្មវិធីធ្វើ​គម្រោង
 Comment[ko]=플래너 요약
+Comment[lt]=Planuoklio santrauka
 Comment[lv]=Plānotāja kopsavilkums
 Comment[nb]=Planlegger-aammendrag
 Comment[nds]=Planer-Översicht
Index: kontact/plugins/planner/kcmplanner.desktop
===================================================================
--- kontact/plugins/planner/kcmplanner.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/planner/kcmplanner.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -24,6 +24,7 @@
 Name[ja]=スケジュール帳
 Name[km]=កម្មវិធីធ្វើ​គម្រោង
 Name[ko]=플래너
+Name[lt]=Planuoklis
 Name[lv]=Plānotājs
 Name[nb]=Planlegger
 Name[nn]=Planleggjar
@@ -53,6 +54,7 @@
 Comment[ja]=スケジュール帳の設定
 Comment[km]=កា​ររៀបចំ​កម្មវិធី​ធ្វើ​គម្រោង
 Comment[ko]=플래너 설정
+Comment[lt]=Planuoklio nustatymai
 Comment[lv]=Plānotāja iestatījumi
 Comment[nb]=Planlegger-oppsett
 Comment[nds]=Planner inrichten
Index: kontact/plugins/planner/plannerplugin.desktop
===================================================================
--- kontact/plugins/planner/plannerplugin.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/planner/plannerplugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -26,6 +26,7 @@
 Name[ja]=スケジュール帳
 Name[km]=កម្មវិធីធ្វើ​គម្រោង
 Name[ko]=플래너
+Name[lt]=Planuoklis
 Name[lv]=Plānotājs
 Name[nb]=Planlegger
 Name[nn]=Planleggjar
@@ -55,6 +56,7 @@
 Comment[ja]=スケジュール帳プラグイン
 Comment[km]=កម្មវិធី​ជំនួយ​​របស់​កម្មវិធី​ធ្វើ​គម្រោង
 Comment[ko]=플래너 플러그인
+Comment[lt]=Planuoklio priedas
 Comment[lv]=Plānotāja spraudnis
 Comment[nb]=Planlegger-programtillegg
 Comment[nds]=Planner-Moduul
Index: kontact/plugins/knode/knode.setdlg
===================================================================
--- kontact/plugins/knode/knode.setdlg	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/knode/knode.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -24,6 +24,7 @@
 Comment[kk]=Пошта компоненті
 Comment[km]=មាសភាគ​របស់ Usenet
 Comment[ko]=유즈넷 구성 요소
+Comment[lt]=Usenet komponentas
 Comment[lv]=Usenet komponente
 Comment[nb]=Usenet-komponent
 Comment[nds]=Usenet-Komponent
Index: kontact/plugins/specialdates/kcmsdsummary.desktop
===================================================================
--- kontact/plugins/specialdates/kcmsdsummary.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/specialdates/kcmsdsummary.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -30,6 +30,7 @@
 Name[kk]=Болашақ ерекше күндер
 Name[km]=កាលបរិច្ឆេទ​ពិសេស​ដែលនឹង​កើត​ឡើង
 Name[ko]=다가오는 기념일
+Name[lt]=Artėjančios ypatingos datos
 Name[lv]=Gaidāmie īpašie datumi
 Name[nb]=Kommende spesielle datoer
 Name[nds]=Anstahn besünner Daag
@@ -68,6 +69,7 @@
 Comment[kk]=Болашақ ерекше күндер тұжырымының баптау
 Comment[km]=ការ​រៀបចំ​សេចក្ដី​សង្ខេប​កាលបរិច្ឆេទ​ពិសេស​ដែល​នឹង​កើតឡើង
 Comment[ko]=다가오는 기념일 요약 설정
+Comment[lt]=Artėjančių ypatingų datų santraukos sąranka
 Comment[lv]=Gaidāmo īpašo datumu kopsavilkuma iestatījumi
 Comment[nb]=Sammendragsoppsett for kommende spesielle datoer
 Comment[nds]=De Översicht för anstahn besünner Daten instellen
Index: kontact/plugins/kmobiletools/kmobiletools.setdlg
===================================================================
--- kontact/plugins/kmobiletools/kmobiletools.setdlg	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/kmobiletools/kmobiletools.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -16,6 +16,7 @@
 Name[ja]=携帯電話
 Name[km]=ទូរស័ព្ទ​ចល័ត
 Name[ko]=휴대폰
+Name[lt]=Mobilieji telefonai
 Name[lv]=Mobilie telefoni
 Name[nb]=Mobiltelefoner
 Name[nds]=Mobiltelefonen
@@ -50,6 +51,7 @@
 Comment[ja]=携帯電話コンポーネント
 Comment[km]=សមាសភាគ​ទូរស័ព្ទ​ចល័ត
 Comment[ko]=휴대폰 구성 요소
+Comment[lt]=Mobilaus telefono komponentas
 Comment[lv]=Mobilo telefonu komponente
 Comment[nb]=Mobiltelefonkomponent
 Comment[nds]=Mobiltelefoon-Komponent
Index: kontact/plugins/kmobiletools/kmobiletools.desktop
===================================================================
--- kontact/plugins/kmobiletools/kmobiletools.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/kmobiletools/kmobiletools.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -27,6 +27,7 @@
 Comment[ja]=KMobileTools プラグイン
 Comment[km]=កម្មវិធី​ជំនួយ​របស់ KMmobileTools
 Comment[ko]=KMobileTools 플러그인
+Comment[lt]=KMobileTools priedas
 Comment[lv]=KMobileTools spraudnis
 Comment[nb]=KMobileTools programtillegg
 Comment[nds]=KMobileTools-Moduul
@@ -60,6 +61,7 @@
 Name[ja]=携帯電話
 Name[km]=ទូរស័ព្ទ​ចល័ត
 Name[ko]=휴대폰
+Name[lt]=Mobilieji telefonai
 Name[lv]=Mobilie telefoni
 Name[nb]=Mobiltelefoner
 Name[nds]=Mobiltelefonen
Index: kontact/plugins/knotes/knotes.setdlg
===================================================================
--- kontact/plugins/knotes/knotes.setdlg	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/knotes/knotes.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -14,6 +14,7 @@
 Name[ja]=ポップアップメモ
 Name[km]=ចំណាំ​លេច​ឡើង
 Name[ko]=팝업 노트
+Name[lt]=Lipnūs lapeliai
 Name[lv]=Piezīmju lapiņas
 Name[nb]=Sprettopp-notater
 Name[nds]=Opduk-Notizen
@@ -48,6 +49,7 @@
 Comment[ja]=ポップアップメモコンポーネント
 Comment[km]=សមាសភាគ​ចំណាំលេចឡើង​
 Comment[ko]=팝업 노트 구성 요소
+Comment[lt]=Lipnių lapelių komponentas
 Comment[lv]=Piezīmju lapiņu komponente
 Comment[nb]=Komponent for sprettoppnotater
 Comment[nds]=Opduknotiz-Komponent
Index: kontact/plugins/knotes/knotesplugin.desktop
===================================================================
--- kontact/plugins/knotes/knotesplugin.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/knotes/knotesplugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -84,6 +84,7 @@
 Name[ja]=ポップアップメモ
 Name[km]=ចំណាំ​លេច​ឡើង
 Name[ko]=팝업 노트
+Name[lt]=Lipnūs lapeliai
 Name[lv]=Piezīmju lapiņas
 Name[nb]=Sprettopp-notater
 Name[nds]=Opduk-Notizen
Index: kontact/plugins/knotes/knotes_part_p.h
===================================================================
--- kontact/plugins/knotes/knotes_part_p.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/knotes/knotes_part_p.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -155,7 +155,7 @@
       hbl->addWidget( mTitleEdit, 1, Qt::AlignVCenter );
 
       mNoteEdit = new KNoteEdit( actionCollection(), page );
-      ( (KTextEdit*)mNoteEdit )->setTextFormat( Qt::RichText );
+      ( (KTextEdit*)mNoteEdit )->setAcceptRichText( true );
       mNoteEdit->setFocus();
 
       KXMLGUIBuilder builder( page );
@@ -163,7 +163,8 @@
       factory.addClient( this );
 
       mTool = static_cast<KToolBar *>( factory.container( "note_tool", this ) );
-
+      mNoteEdit->setContextMenu( dynamic_cast<KMenu *>(
+                                   factory.container( "note_edit", this ) ) );
       layout->addWidget( mTool );
       layout->addWidget( mNoteEdit );
 
Index: kontact/plugins/knotes/knotetip.cpp
===================================================================
--- kontact/plugins/knotes/knotetip.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/knotes/knotetip.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -31,6 +31,7 @@
 */
 
 #include "knotetip.h"
+#include <kdebug.h>
 #include "knotes_part_p.h"
 
 #include <kglobalsettings.h>
@@ -89,11 +90,7 @@
     }
   } else {
     KCal::Journal *journal = item->journal();
-    if ( journal->customProperty( "KNotes", "RichText" ) == "true" ) {
-      mPreview->setTextFormat( Qt::RichText );
-    } else {
-      mPreview->setTextFormat( Qt::PlainText );
-    }
+    mPreview->setAcceptRichText( journal->customProperty( "KNotes", "RichText" ) == "true" );
 
     QColor fg( journal->customProperty( "KNotes", "FgColor" ) );
     QColor bg( journal->customProperty( "KNotes", "BgColor" ) );
@@ -103,12 +100,12 @@
     //mPreview->zoomTo( 8 );
     mPreview->sync();
 
-    int w = 400;
-    int h = mPreview->heightForWidth( w );
+    mPreview->document()->adjustSize ();
+    int w = mPreview->document () ->size().width();
+    int h = mPreview->document () ->size().height();
     while ( w > 60 && h == mPreview->heightForWidth( w - 20 ) ) {
       w -= 20;
     }
-
     QRect desk = KGlobalSettings::desktopGeometry( mNoteIVI->rect().center() );
     resize( w, qMin( h, desk.height() / 2 - 20 ) );
 
Index: kontact/plugins/ktimetracker/ktimetracker.setdlg
===================================================================
--- kontact/plugins/ktimetracker/ktimetracker.setdlg	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/ktimetracker/ktimetracker.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -14,6 +14,7 @@
 Name[ja]=タイムトラッカー
 Name[km]=កម្មវិធី​តាមដាន​ពេលវេលា
 Name[ko]=시간 추적기
+Name[lt]=Laiko sekiklis
 Name[lv]=Patērētā laika uzskatītājs
 Name[nb]=TimeTracker
 Name[nds]=Tietlogbook
@@ -45,6 +46,7 @@
 Comment[ja]=タイムトラッカーコンポーネント
 Comment[km]=សមាសភាគ​កម្មវិធី​តាមដាន​ពេលវេលា
 Comment[ko]=시간 추적기 구성 요소
+Comment[lt]=Laiko sekiklio komponentas
 Comment[lv]=Laika uzskaitītāja komponente
 Comment[nb]=Time Traacker-komponent
 Comment[nds]=Tietlogbook-Komponent
Index: kontact/plugins/ktimetracker/ktimetracker_plugin.desktop
===================================================================
--- kontact/plugins/ktimetracker/ktimetracker_plugin.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/ktimetracker/ktimetracker_plugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -29,6 +29,7 @@
 Comment[ja]=タイムトラッカープラグイン
 Comment[km]=កម្មវិធី​ជំនួយ TimeTracker
 Comment[ko]=시간 추적기 플러그인
+Comment[lt]=Laiko sekiklio priedas
 Comment[lv]=KTimeTracker spraudnis
 Comment[nb]=TimeTracker programtillegg
 Comment[nds]=Tietlogbook-Moduul
@@ -61,6 +62,7 @@
 Name[ja]=タイムトラッカー
 Name[km]=កម្មវិធី​តាមដាន​ពេលវេលា
 Name[ko]=시간 추적기
+Name[lt]=Laiko sekiklis
 Name[lv]=Patērētā laika uzskatītājs
 Name[nb]=TimeTracker
 Name[nds]=Tietlogbook
Index: kontact/plugins/kjots/kjots_plugin.desktop
===================================================================
--- kontact/plugins/kjots/kjots_plugin.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/kjots/kjots_plugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -62,6 +62,7 @@
 Name[ja]=メモ帳
 Name[km]=សៀវភៅ​ចំណាំ
 Name[ko]=공책
+Name[lt]=Užrašinės
 Name[lv]=Piezīmju grāmatiņas
 Name[nb]=Notisbøker
 Name[nds]=Notizböker
Index: kontact/plugins/kjots/kjots.setdlg
===================================================================
--- kontact/plugins/kjots/kjots.setdlg	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/kjots/kjots.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -13,6 +13,7 @@
 Name[ja]=メモ帳
 Name[km]=សៀវភៅ​ចំណាំ
 Name[ko]=공책
+Name[lt]=Užrašinės
 Name[lv]=Piezīmju grāmatiņas
 Name[nb]=Notisbøker
 Name[nds]=Notizböker
@@ -46,6 +47,7 @@
 Comment[ja]=メモ帳コンポーネント
 Comment[km]=សមាសភាគ​សៀវភៅ​
 Comment[ko]=공책 구성 요소
+Comment[lt]=Užrašinių komponentas
 Comment[lv]=Piezīmju grāmatiņu komponente
 Comment[nb]=Notisbok-komponent
 Comment[nds]=Notizbook-Komponent
Index: kontact/plugins/korganizer/kcmapptsummary.desktop
===================================================================
--- kontact/plugins/korganizer/kcmapptsummary.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/korganizer/kcmapptsummary.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -28,6 +28,7 @@
 Name[kk]=Болашақ оқиғалар
 Name[km]=ព្រឹត្តិការណ៍​ដែល​នឹង​កើតឡើង
 Name[ko]=다가오는 약속
+Name[lt]=Artėjantys įvykiai
 Name[lv]=Gaidāmie notikumi
 Name[nb]=Kommende hendelser
 Name[nds]=Anstahn Begeefnissen
@@ -65,6 +66,7 @@
 Comment[kk]=Болашақ оқигалар тұжырымының баптау
 Comment[km]=ការ​រៀបចំ​សេចក្ដី​សង្ខេប​ព្រឹត្តិការណ៍​ដែល​នឹង​កើតឡើង
 Comment[ko]=다가오는 약속 요약 설정
+Comment[lt]=Artėjančių įvykių santraukos nustatymai
 Comment[lv]=Gaidāmo notikumu kopsavilkuma iestatījumi
 Comment[nb]=Sammendragsoppsett for kommende hendelser
 Comment[nds]=De Översicht för anstahn Begeefnissen instellen
Index: kontact/plugins/korganizer/kcmtodosummary.desktop
===================================================================
--- kontact/plugins/korganizer/kcmtodosummary.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/korganizer/kcmtodosummary.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -28,6 +28,7 @@
 Name[kk]=Кейінге қалдырылған жоспарлар
 Name[km]=ការងារ​ត្រូវធ្វើ​ដែល​មិនទាន់​សម្រេច
 Name[ko]=남아 있는 할 일
+Name[lt]=Neatlikti darbai
 Name[lv]=Darāmie darbi
 Name[nb]=Ventende gjøremål
 Name[nds]=Anstahn Opgaven
@@ -65,6 +66,7 @@
 Comment[kk]=Кейінге қалдырылған жоспарлар тұжырымының баптау
 Comment[km]=ការ​រៀបចំ​សេចក្ដីសង្ខេបការងារ​​ធ្វើ​ដែល​មិន​ទាន់សម្រេច
 Comment[ko]=남아 있는 할 일 요약 설정
+Comment[lt]=Neatliktų darbų santraukos nustatymai
 Comment[lv]=Darbu kopsavilkuma iestatījumi
 Comment[nb]=Oppsett av sammendraget av ventende gjøremål
 Comment[nds]=De Översicht för anstahn Opgaven instellen
Index: kontact/plugins/kmail/summarywidget.cpp
===================================================================
--- kontact/plugins/kmail/summarywidget.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/kmail/summarywidget.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -88,9 +88,13 @@
 {
   // check whether we need to update the message counts
   org::kde::kmail::kmail kmail( DBUS_KMAIL, "/KMail", QDBusConnection::sessionBus() );
-  const int timeOfLastMessageCountChange = kmail.timeOfLastMessageCountChange();
-  if ( timeOfLastMessageCountChange > mTimeOfLastMessageCountUpdate ) {
-    slotUnreadCountChanged();
+  if ( kmail.isValid() ) {
+    QDBusReply<int> timeOfLastMessageCountChange = kmail.timeOfLastMessageCountChange();
+    if ( timeOfLastMessageCountChange.isValid() ) {
+      if ( timeOfLastMessageCountChange > mTimeOfLastMessageCountUpdate ) {
+        slotUnreadCountChanged();
+      }
+    }
   }
 }
 
@@ -127,70 +131,87 @@
   int counter = 0;
   QStringList::ConstIterator it;
   org::kde::kmail::kmail kmail( DBUS_KMAIL, "/KMail", QDBusConnection::sessionBus() );
-  for ( it = folders.begin(); it != folders.end(); ++it ) {
-    if ( activeFolders.contains( *it ) ) {
-      QDBusReply<QString> ref = kmail.getFolder( *it );
-      if ( ref.isValid() && !ref.value().isEmpty() ) {
-        OrgKdeKmailFolderInterface folderInterface(
-          DBUS_KMAIL, "/Folder", QDBusConnection::sessionBus() );
-        QDBusReply<int> replyNumMsg = folderInterface.messages();
-        const int numMsg = replyNumMsg;
-        QDBusReply<int> replyUnreadNumMsg = folderInterface.unreadMessages();
-        const int numUnreadMsg=replyUnreadNumMsg;
+  if ( kmail.isValid() ) {
+    for ( it = folders.begin(); it != folders.end(); ++it ) {
+      if ( activeFolders.contains( *it ) ) {
+        QDBusReply<QString> ref = kmail.getFolder( *it );
+        if ( ref.isValid() && !ref.value().isEmpty() ) {
+          OrgKdeKmailFolderInterface folderInterface(
+            DBUS_KMAIL, "/Folder", QDBusConnection::sessionBus() );
+          if ( !folderInterface.isValid() )
+            continue;
 
-        if ( numUnreadMsg == 0 ) {
-          continue;
-        }
+          QDBusReply<int> replyNumMsg = folderInterface.messages();
+          if ( !replyNumMsg.isValid() )
+            continue;
 
-        // folder icon
-        QString name = folderInterface.unreadIconPath();
-        if ( name.isEmpty() ) {
-          name = defName;
-        }
-        label = new QLabel( this );
-        label->setPixmap( KIconLoader::global()->loadIcon( name, KIconLoader::Small ) );
-        label->setMaximumWidth( label->minimumSizeHint().width() );
-        label->setAlignment( Qt::AlignVCenter );
-        mLayout->addWidget( label, counter, 0 );
-        mLabels.append( label );
+          const int numMsg = replyNumMsg;
+          QDBusReply<int> replyUnreadNumMsg = folderInterface.unreadMessages();
+          if ( !replyUnreadNumMsg.isValid() )
+            continue;
 
-        // folder path
-        QString folderPath;
-        QDBusReply<QString> replyFolderPath;
-        if ( config.readEntry( "ShowFullPath", true ) ) {
-          replyFolderPath= folderInterface.displayPath();
-        } else {
-          replyFolderPath= folderInterface.displayName();
-        }
-        folderPath = replyFolderPath;
-        KUrlLabel *urlLabel = new KUrlLabel( *it, folderPath, this );
-        urlLabel->installEventFilter( this );
-        urlLabel->setAlignment( Qt::AlignLeft );
-        urlLabel->setWordWrap( true );
-        mLayout->addWidget( urlLabel, counter, 1 );
-        mLabels.append( urlLabel );
+          const int numUnreadMsg = replyUnreadNumMsg;
+          if ( numUnreadMsg == 0 ) {
+            continue;
+          }
 
-        connect( urlLabel, SIGNAL(leftClickedUrl(const QString&)),
-                 SLOT(selectFolder(const QString&)) );
+          // folder icon
+          QDBusReply<QString> dbusName = folderInterface.unreadIconPath();
+          QString name;
+          if ( dbusName.isValid() ) {
+            name = dbusName;
+            if ( name.isEmpty() )
+              name = defName;
+          }
+          else
+            name = defName;
+          label = new QLabel( this );
+          label->setPixmap( KIconLoader::global()->loadIcon( name, KIconLoader::Small ) );
+          label->setMaximumWidth( label->minimumSizeHint().width() );
+          label->setAlignment( Qt::AlignVCenter );
+          mLayout->addWidget( label, counter, 0 );
+          mLabels.append( label );
 
-        // unread of total
-        label = new QLabel( i18nc( "%1: number of unread messages "
-                                   "%2: total number of messages",
-                                   "%1 / %2", numUnreadMsg, numMsg ), this );
-        label->setAlignment( Qt::AlignLeft );
-        mLayout->addWidget( label, counter, 2 );
-        mLabels.append( label );
+          // folder path
+          QString folderPath;
+          QDBusReply<QString> replyFolderPath;
+          if ( config.readEntry( "ShowFullPath", true ) ) {
+            replyFolderPath= folderInterface.displayPath();
+          } else {
+            replyFolderPath= folderInterface.displayName();
+          }
+          if ( replyFolderPath.isValid() )
+            folderPath = replyFolderPath;
 
-        // tooltip
-        urlLabel->setToolTip( i18n( "<qt><b>%1</b>"
-                                    "<br/>Total: %2<br/>"
-                                    "Unread: %3</qt>",
-                                    folderPath,
-                                    numMsg,
-                                    numUnreadMsg ) );
-        //TODO: put the folder size in the tooltip
-        //so we need to add a folderSize() to the interface
-        counter++;
+          KUrlLabel *urlLabel = new KUrlLabel( *it, folderPath, this );
+          urlLabel->installEventFilter( this );
+          urlLabel->setAlignment( Qt::AlignLeft );
+          urlLabel->setWordWrap( true );
+          mLayout->addWidget( urlLabel, counter, 1 );
+          mLabels.append( urlLabel );
+
+          connect( urlLabel, SIGNAL(leftClickedUrl(const QString&)),
+                  SLOT(selectFolder(const QString&)) );
+
+          // unread of total
+          label = new QLabel( i18nc( "%1: number of unread messages "
+                                    "%2: total number of messages",
+                                    "%1 / %2", numUnreadMsg, numMsg ), this );
+          label->setAlignment( Qt::AlignLeft );
+          mLayout->addWidget( label, counter, 2 );
+          mLabels.append( label );
+
+          // tooltip
+          urlLabel->setToolTip( i18n( "<qt><b>%1</b>"
+                                      "<br/>Total: %2<br/>"
+                                      "Unread: %3</qt>",
+                                      folderPath,
+                                      numMsg,
+                                      numUnreadMsg ) );
+          //TODO: put the folder size in the tooltip
+          //so we need to add a folderSize() to the interface
+          counter++;
+        }
       }
     }
   }
Index: kontact/plugins/kmail/kcmkmailsummary.desktop
===================================================================
--- kontact/plugins/kmail/kcmkmailsummary.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/kmail/kcmkmailsummary.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -31,6 +31,7 @@
 Name[kk]=Жаңа хабарламалар
 Name[km]=សារ​ថ្មី
 Name[ko]=새 메시지
+Name[lt]=Nauji laiškai
 Name[lv]=Jaunas vēstules
 Name[nb]=Nye meldinger
 Name[nds]=Nieg Narichten
Index: kontact/plugins/summary/kcmkontactsummary.desktop
===================================================================
--- kontact/plugins/summary/kcmkontactsummary.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/summary/kcmkontactsummary.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -26,6 +26,7 @@
 Name[ja]=要約
 Name[km]=សេចក្ដីសង្ខេប
 Name[ko]=요약
+Name[lt]=Santraukos
 Name[lv]=Kopsavilkumi
 Name[nb]=Sammendrag
 Name[nds]=Tosamenfaten
@@ -60,6 +61,7 @@
 Comment[ja]=表示する要約を選択
 Comment[km]=ជម្រើស​សេចក្ដី​សង្ខេប
 Comment[ko]=요약 선택
+Comment[lt]=Santraukos pasirinkimas
 Comment[lv]=Kopsavilkuma izvēle
 Comment[nb]=Sammendragsutvalg
 Comment[nds]=Tosamenfaten utsöken
Index: kontact/plugins/newsticker/kcmkontactknt.desktop
===================================================================
--- kontact/plugins/newsticker/kcmkontactknt.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ kontact/plugins/newsticker/kcmkontactknt.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -30,6 +30,7 @@
 Name[kk]=Ақпарлар
 Name[km]=មតិ​ព័ត៌មាន
 Name[ko]=뉴스 피드
+Name[lt]=Naujienų kanalai
 Name[lv]=Ziņu barotnes
 Name[nb]=Nyhetskilder
 Name[nds]=Mellenströöm
Index: knotes/knote.cpp
===================================================================
--- knotes/knote.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ knotes/knote.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -1166,6 +1166,7 @@
                fe->reason() != Qt::MouseFocusReason ) {
             updateFocus();
             if ( isModified() ) {
+              saveConfig();
               saveData();
             }
           }
Index: MAINTAINERS
===================================================================
--- MAINTAINERS	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ MAINTAINERS	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -7,13 +7,11 @@
                   Lutz Rogowski <lutz@klaralvdalens-datakonsult.se>
 kfile-plugins     ?
 kioslave          ?
-kitchensync       Tobias Koenig <tokoe@kde.org>
 kjots             Stephen Kelly <steveire@gmail.com>
 kleopatra         Marc Mutz <mutz@kde.org>
                   Steffen Hansen <hansen@kde.org>
 kmail             Thomas McGuire <mcguire@kde.org>
 kmailcvt          Danny Kukawka <danny.kukawka@web.de>
-kmobiletools      Marco Gulino <marco.gulino@gmail.com>
 knode             Volker Krause <vkrause@kde.org>
 knotes            Guillermo Antonio Amaral Bastidas <me@guillermoamaral.com>
 kode              Cornelius Schumacher <schumacher@kde.org>
@@ -22,7 +20,6 @@
 kontactinterfaces Allen Winter <winter@kde.org>
 korganizer        Reinhold Kainhofer <reinhold@kainhofer.com>
                   Cornelius Schumacher <schumacher@kde.org>
-korn              Mart Kelder <mart.mailing@hccnet.nl>
 kpilot            Jason 'vanRijn' Kasper <vR@movingparts.net>
                   Adriaan de Groot <groot@kde.org>
 kresources        ?
Index: korganizer/koeditorgeneralevent.h
===================================================================
--- korganizer/koeditorgeneralevent.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorgeneralevent.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -70,7 +70,7 @@
     */
     void readEvent( Event *event, bool tmpl = false );
     /** Write event settings to event object */
-    void writeEvent( Event * );
+    void fillEvent( Event * );
 
     /** Check if the input is valid. */
     bool validateInput();
Index: korganizer/koattendeeeditor.cpp
===================================================================
--- korganizer/koattendeeeditor.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koattendeeeditor.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -304,7 +304,7 @@
   }
 }
 
-void KOAttendeeEditor::writeIncidence( KCal::Incidence *incidence )
+void KOAttendeeEditor::fillIncidence( KCal::Incidence *incidence )
 {
   if ( mOrganizerCombo ) {
     // TODO: Don't take a string and split it up... Is there a better way?
Index: korganizer/koeditorgeneraltodo.cpp
===================================================================
--- korganizer/koeditorgeneraltodo.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorgeneraltodo.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -304,6 +304,7 @@
     mDueDateEdit->setDate( QDate::currentDate() );
     mDueTimeEdit->setTime( QTime::currentTime() );
     mDueCheck->setChecked( false );
+    mTimeZoneComboDue->setEnabled( false );
   }
 
   if ( todo->hasStartDate() ) {
@@ -319,6 +320,7 @@
     mStartDateEdit->setDate( QDate::currentDate() );
     mStartTimeEdit->setTime( QTime::currentTime() );
     mStartCheck->setChecked( false );
+    mTimeZoneComboStart->setEnabled( false );
   }
 
   mTimeButton->setChecked( !todo->allDay() );
@@ -335,9 +337,9 @@
   mStartDateModified = false;
 }
 
-void KOEditorGeneralTodo::writeTodo( Todo *todo )
+void KOEditorGeneralTodo::fillTodo( Todo *todo )
 {
-  KOEditorGeneral::writeIncidence( todo );
+  KOEditorGeneral::fillIncidence( todo );
 
   // temp. until something better happens.
   QString tmpStr;
Index: korganizer/koeditorgeneral.cpp
===================================================================
--- korganizer/koeditorgeneral.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorgeneral.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -493,7 +493,7 @@
   }
 }
 
-void KOEditorGeneral::writeIncidence( Incidence *incidence )
+void KOEditorGeneral::fillIncidence( Incidence *incidence )
 {
   incidence->setSummary( mSummaryEdit->text() );
   incidence->setLocation( mLocationEdit->text() );
@@ -532,7 +532,7 @@
       incidence->addAlarm( al );
     }
   }
-  mAttachments->writeIncidence( incidence );
+  mAttachments->fillIncidence( incidence );
 }
 
 void KOEditorGeneral::setSummary( const QString &text )
Index: korganizer/koeventeditor.cpp
===================================================================
--- korganizer/koeventeditor.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeventeditor.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -66,6 +66,16 @@
   }
 }
 
+bool KOEventEditor::incidenceModified() {
+  Event *newEvent = 0;
+
+  if ( mEvent ) {
+    newEvent = mEvent->clone();
+    fillEvent( newEvent );
+  }
+  return mEvent && !( *newEvent == *mEvent );
+}
+
 void KOEventEditor::init()
 {
   setupGeneral();
@@ -288,7 +298,7 @@
     Event *oldEvent = mEvent->clone();
     Event *event = mEvent->clone();
 
-    writeEvent( event );
+    fillEvent( event );
 
     if ( *event == *mEvent ) {
       // Don't do anything
@@ -301,7 +311,7 @@
       }
     } else {
       //IncidenceChanger::assignIncidence( mEvent, event );
-      writeEvent( mEvent );
+      fillEvent( mEvent );
       if ( mIsCounter ) {
         KOGroupware::instance()->sendCounterProposal( mCalendar, oldEvent, mEvent );
         // add dummy event at the position of the counter proposal
@@ -320,7 +330,7 @@
     mEvent = new Event;
     mEvent->setOrganizer( Person( KOPrefs::instance()->fullName(),
                           KOPrefs::instance()->email() ) );
-    writeEvent( mEvent );
+    fillEvent( mEvent );
     if ( !mChanger->addIncidence( mEvent, this ) ) {
       delete mEvent;
       mEvent = 0;
@@ -373,16 +383,16 @@
   }
 }
 
-void KOEventEditor::writeEvent( Event *event )
+void KOEventEditor::fillEvent( Event *event )
 {
-  mGeneral->writeEvent( event );
+  mGeneral->fillEvent( event );
   if ( mFreeBusy ) {
-    mFreeBusy->writeIncidence( event );
+    mFreeBusy->fillIncidence( event );
   }
 
   cancelRemovedAttendees( event );
 
-  mRecurrence->writeIncidence( event );
+  mRecurrence->fillIncidence( event );
 
   writeDesignerFields( event );
 }
@@ -429,7 +439,7 @@
 void KOEventEditor::slotSaveTemplate( const QString &templateName )
 {
   Event *event = new Event;
-  writeEvent( event );
+  fillEvent( event );
   saveAsTemplate( event, templateName );
 }
 
@@ -441,7 +451,7 @@
 void KOEventEditor::updateRecurrenceSummary()
 {
   Event *ev =  new Event();
-  writeEvent( ev );
+  fillEvent( ev );
   mGeneral->updateRecurrenceSummary( IncidenceFormatter::recurrenceString( ev ) );
   delete ev;
 }
Index: korganizer/koeditorfreebusy.cpp
===================================================================
--- korganizer/koeditorfreebusy.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorfreebusy.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -760,7 +760,7 @@
   dialog.exec();
 }
 
-void KOEditorFreeBusy::writeIncidence( Incidence *incidence )
+void KOEditorFreeBusy::fillIncidence( Incidence *incidence )
 {
   incidence->clearAttendees();
   QVector<FreeBusyItem*> toBeDeleted;
@@ -804,7 +804,7 @@
     }
   }
 
-  KOAttendeeEditor::writeIncidence( incidence );
+  KOAttendeeEditor::fillIncidence( incidence );
 
   // cleanup
   qDeleteAll( toBeDeleted );
Index: korganizer/koattendeeeditor.h
===================================================================
--- korganizer/koattendeeeditor.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koattendeeeditor.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -56,7 +56,7 @@
     virtual void insertAttendee( KCal::Attendee *attendee, bool fetchFB = true ) = 0;
 
     virtual void readIncidence( KCal::Incidence *incidence );
-    virtual void writeIncidence( KCal::Incidence *incidence );
+    virtual void fillIncidence( KCal::Incidence *incidence );
 
     /** return a clone of the incidence with attendees to be canceld*/
     void cancelAttendeeIncidence( KCal::Incidence *incidence );
Index: korganizer/dbuscalendar.desktop
===================================================================
--- korganizer/dbuscalendar.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/dbuscalendar.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -35,6 +35,7 @@
 Comment[kk]=D-BUS интерфейсті Ұйымдастырғыш
 Comment[km]=កម្មវិធី​រៀបចំ​ដែល​មាន​ចំណុច​ប្រទាក់ D-BUS
 Comment[ko]=D-BUS 인터페이스를 사용하는 오거나이저
+Comment[lt]=Planuoklis su D-Bus sąsaja
 Comment[lv]=Organizators ar D-BUS saskarni
 Comment[nb]=Organizer med D-BUS-grensesnitt
 Comment[nds]=En Daagpleger mit en D-Bus-Koppelsteed
Index: korganizer/koeditorgeneral.h
===================================================================
--- korganizer/koeditorgeneral.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorgeneral.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -88,7 +88,7 @@
     void readIncidence( Incidence *incidence );
 
     /** Write event settings to event object */
-    void writeIncidence( Incidence * );
+    void fillIncidence( Incidence * );
 
     /** Check if the input is valid. */
     bool validateInput();
Index: korganizer/koeventeditor.h
===================================================================
--- korganizer/koeventeditor.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeventeditor.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -95,7 +95,7 @@
     /**
       Write event settings to event object
     */
-    void writeEvent( Event * );
+    void fillEvent( Event * );
 
     QObject *typeAheadReceiver() const;
 
@@ -126,6 +126,7 @@
     int msgItemDelete();
     void loadTemplate( CalendarLocal & );
     QStringList &templates() const;
+    bool incidenceModified();
 
   private:
     Event *mEvent;
Index: korganizer/koeditorgeneralevent.cpp
===================================================================
--- korganizer/koeditorgeneralevent.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorgeneralevent.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -432,9 +432,9 @@
   readIncidence( event );
 }
 
-void KOEditorGeneralEvent::writeEvent( Event *event )
+void KOEditorGeneralEvent::fillEvent( Event *event )
 {
-  writeIncidence( event );
+  fillIncidence( event );
 
   QDate tmpDate;
   QTime tmpTime;
Index: korganizer/koeditorattachments.h
===================================================================
--- korganizer/koeditorattachments.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorattachments.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -104,7 +104,7 @@
     /** Read event object and setup widgets accordingly */
     void readIncidence( KCal::Incidence * );
     /** Write event settings to event object */
-    void writeIncidence( KCal::Incidence * );
+    void fillIncidence( KCal::Incidence * );
 
     bool hasAttachments();
 
Index: korganizer/korgac/alarmdialog.cpp
===================================================================
--- korganizer/korgac/alarmdialog.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/korgac/alarmdialog.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -413,8 +413,17 @@
       // FIXME: Check whether this should be done for all multiple alarms
       if ( alarm->type() == Alarm::Procedure ) {
         // FIXME: Add a message box asking whether the procedure should really be executed
-      kDebug() << "Starting program: '" << alarm->programFile() << "'";
-      QProcess::startDetached( alarm->programFile() );
+        kDebug() << "Starting program: '" << alarm->programFile() << "'";
+
+        QString program = alarm->programFile();
+
+        // if the program name contains spaces escape it
+        if ( program.contains( " " )   &&
+             !( program.startsWith( "\"" ) && program.endsWith( "\"" ) ) ) {
+          program = "\"" + program + "\"";
+        }
+
+        QProcess::startDetached( program + " " + alarm->programArguments() );
       } else if ( alarm->type() == Alarm::Audio ) {
         beeped = true;
         Phonon::MediaObject *player =
Index: korganizer/interfaces/calendar/calendarplugin.desktop
===================================================================
--- korganizer/interfaces/calendar/calendarplugin.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/interfaces/calendar/calendarplugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -14,6 +14,7 @@
 Name[ja]=カレンダープラグインインターフェース
 Name[km]=ប្រតិទិន​កម្មវិធី​ជំនួយ​ប្រតិទិន
 Name[ko]=달력 플러그인 인터페이스
+Name[lt]=Kalendoriaus priedo sąsaja
 Name[lv]=Kalendāra spraudņa saskarne
 Name[nb]=Calendar-grensesnitt for programtillegg
 Name[nds]=Kalennermoduul-Koppelsteed
Index: korganizer/interfaces/calendar/calendardecoration.desktop
===================================================================
--- korganizer/interfaces/calendar/calendardecoration.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/interfaces/calendar/calendardecoration.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -14,6 +14,7 @@
 Name[ja]=カレンダー装飾インターフェース
 Name[km]=ចំណុច​ប្រទាក់​តុបតែង​ប្រតិទិន
 Name[ko]=달력 장식 인터페이스
+Name[lt]=Kalendoriaus dekoracijų sąsaja
 Name[lv]=Kalendāra dekorāciju saskarne
 Name[nb]=Calendar dekorasjonsgrensesnitt
 Name[nds]=Kalennerdekoratschoon-Koppelsteed
Index: korganizer/kotodoeditor.cpp
===================================================================
--- korganizer/kotodoeditor.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/kotodoeditor.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -62,6 +62,16 @@
   emit dialogClose( mTodo );
 }
 
+bool KOTodoEditor::incidenceModified() {
+  Todo *newTodo = 0;
+
+  if ( mTodo ) {
+    newTodo = mTodo->clone();
+    fillTodo( newTodo );
+  }
+  return mTodo && !( *newTodo == *mTodo );
+}
+
 void KOTodoEditor::init()
 {
   setupGeneral();
@@ -220,13 +230,13 @@
     Todo *oldTodo = mTodo->clone();
     Todo *todo = mTodo->clone();
 
-    writeTodo( todo );
+    fillTodo( todo );
 
     if( *mTodo == *todo ) {
       // Don't do anything
     } else {
       //IncidenceChanger::assignIncidence( mTodo, todo );
-      writeTodo( mTodo );
+      fillTodo( mTodo );
       mChanger->changeIncidence( oldTodo, mTodo );
     }
     delete todo;
@@ -237,7 +247,7 @@
     mTodo = new Todo;
     mTodo->setOrganizer( Person( KOPrefs::instance()->fullName(), KOPrefs::instance()->email() ) );
 
-    writeTodo( mTodo );
+    fillTodo( mTodo );
 
     if ( !mChanger->addIncidence( mTodo, this ) ) {
       delete mTodo;
@@ -298,13 +308,13 @@
   readDesignerFields( todo );
 }
 
-void KOTodoEditor::writeTodo( Todo *todo )
+void KOTodoEditor::fillTodo( Todo *todo )
 {
   Incidence *oldIncidence = todo->clone();
 
-  mGeneral->writeTodo( todo );
-  mDetails->writeIncidence( todo );
-  mRecurrence->writeIncidence( todo );
+  mGeneral->fillTodo( todo );
+  mDetails->fillIncidence( todo );
+  mRecurrence->fillIncidence( todo );
 
   if ( *( oldIncidence->recurrence() ) != *( todo->recurrence() ) ) {
     todo->setDtDue( todo->dtDue(), true );
@@ -367,7 +377,7 @@
 void KOTodoEditor::slotSaveTemplate( const QString &templateName )
 {
   Todo *todo = new Todo;
-  writeTodo( todo );
+  fillTodo( todo );
   saveAsTemplate( todo, templateName );
 }
 
Index: korganizer/koeditorgeneraljournal.cpp
===================================================================
--- korganizer/koeditorgeneraljournal.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorgeneraljournal.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -176,7 +176,7 @@
   setCategories( journal->categories() );
 }
 
-void KOEditorGeneralJournal::writeJournal( Journal *journal )
+void KOEditorGeneralJournal::fillJournal( Journal *journal )
 {
   journal->setSummary( mSummaryEdit->text() );
   if ( mRichDescription->isChecked() ) {
Index: korganizer/koeditordetails.cpp
===================================================================
--- korganizer/koeditordetails.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditordetails.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -281,7 +281,7 @@
   emit updateAttendeeSummary( mListView->childCount() );
 }
 
-void KOEditorDetails::writeIncidence( Incidence *incidence )
+void KOEditorDetails::fillIncidence( Incidence *incidence )
 {
   incidence->clearAttendees();
   QVector<Q3ListViewItem*> toBeDeleted;
@@ -326,7 +326,7 @@
     }
   }
 
-  KOAttendeeEditor::writeIncidence( incidence );
+  KOAttendeeEditor::fillIncidence( incidence );
 
   // cleanup
   qDeleteAll( toBeDeleted );
Index: korganizer/koeditorfreebusy.h
===================================================================
--- korganizer/koeditorfreebusy.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorfreebusy.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -60,7 +60,7 @@
     void clearAttendees();
 
     void readIncidence( KCal::Incidence *incidence );
-    void writeIncidence( KCal::Incidence *incidence );
+    void fillIncidence( KCal::Incidence *incidence );
 
     void triggerReload();
     void cancelReload();
Index: korganizer/koeditorrecurrence.cpp
===================================================================
--- korganizer/koeditorrecurrence.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorrecurrence.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -1407,7 +1407,7 @@
   mExceptions->setDates( incidence->recurrence()->exDates() );
 }
 
-void KOEditorRecurrence::writeIncidence( Incidence *incidence )
+void KOEditorRecurrence::fillIncidence( Incidence *incidence )
 {
   if ( !mEnabledCheck->isChecked() || !isEnabled() ) {
     if ( incidence->recurs() ) {
Index: korganizer/kotodoeditor.h
===================================================================
--- korganizer/kotodoeditor.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/kotodoeditor.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -82,7 +82,7 @@
     void readTodo( Todo *todo, bool tmpl = false );
 
     /** Write To-do settings to todo object */
-    void writeTodo( Todo *todo );
+    void fillTodo( Todo *todo );
 
     /** Check if the input is valid. */
     bool validateInput();
@@ -108,6 +108,7 @@
     void setupGeneral();
     void setupRecurrence();
     int msgItemDelete();
+    bool incidenceModified();
 
   private:
     Todo *mTodo;
Index: korganizer/views/monthview/monthgraphicsitems.cpp
===================================================================
--- korganizer/views/monthview/monthgraphicsitems.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/views/monthview/monthgraphicsitems.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -164,7 +164,10 @@
 
 QPainterPath MonthGraphicsItem::shape() const
 {
-  return widgetPath( true );
+  // The returned shape must be a closed path,
+  // otherwise MonthScene:itemAt( pos ) can have
+  // problems detecting the item
+  return widgetPath( false );
 }
 
 // TODO: remove this method.
Index: korganizer/views/todoview/kotodomodel.cpp
===================================================================
--- korganizer/views/todoview/kotodomodel.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/views/todoview/kotodomodel.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -800,8 +800,10 @@
     if ( role == Qt::EditRole ) {
       switch ( index.column() ) {
         case SummaryColumn:
-          todo->setSummary( value.toString() );
-          modified = KOGlobals::SUMMARY_MODIFIED;
+          if ( !value.toString().isEmpty() ) {
+            todo->setSummary( value.toString() );
+            modified = KOGlobals::SUMMARY_MODIFIED;
+          }
           break;
         case PriorityColumn:
           todo->setPriority( value.toInt() );
Index: korganizer/views/todoview/kotodoview.cpp
===================================================================
--- korganizer/views/todoview/kotodoview.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/views/todoview/kotodoview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -233,6 +233,8 @@
   }
   connect( mPercentageCompletedPopupMenu, SIGNAL(triggered(QAction *)),
            SLOT(setNewPercentage(QAction *)) );
+
+  setMinimumHeight( 50 );
 }
 
 KOTodoView::~KOTodoView()
Index: korganizer/views/whatsnextview/kowhatsnextview.cpp
===================================================================
--- korganizer/views/whatsnextview/kowhatsnextview.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/views/whatsnextview/kowhatsnextview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -104,10 +104,10 @@
 
   Event::List events;
   KDateTime::Spec timeSpec = KOPrefs::instance()->timeSpec();
-  for ( QDate date = mStartDate; date <= mEndDate; date = date.addDays( 1 ) ) {
-    events += calendar()->events( date, timeSpec, EventSortStartDate, SortDirectionAscending );
-  }
 
+  events = calendar()->events( mStartDate, mEndDate, timeSpec, false );
+  calendar()->sortEvents( &events, EventSortStartDate, SortDirectionAscending );
+
   if ( events.count() > 0 ) {
     mText += "<p></p>";
     kil.loadIcon( "view-calendar-day", KIconLoader::NoGroup, 22,
Index: korganizer/views/agendaview/koagendaview.cpp
===================================================================
--- korganizer/views/agendaview/koagendaview.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/views/agendaview/koagendaview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -1244,8 +1244,15 @@
     }
     if ( todo ) {
       QTime t = todo->dtDue().toTimeSpec( KOPrefs::instance()->timeSpec() ).time();
-      endY = mAgenda->timeToY( t ) - 1;
-      startY = mAgenda->timeToY( t.addSecs( -1800 ) );
+
+      int halfHour = 1800;
+      if ( t.addSecs( -halfHour ) < t ) {
+        startY = mAgenda->timeToY( t.addSecs( -halfHour ) );
+        endY   = mAgenda->timeToY( t ) - 1;
+      } else {
+        startY = 0;
+        endY   = mAgenda->timeToY( t.addSecs( halfHour ) ) - 1;
+      }
     }
     if ( endY < startY ) {
       endY = startY;
@@ -1471,7 +1478,7 @@
 void KOAgendaView::updateEventIndicatorTop( int newY )
 {
   for ( int i = 0; i < mMinY.size(); ++i ) {
-    mEventIndicatorTop->enableColumn( i, newY >= mMinY[i] );
+    mEventIndicatorTop->enableColumn( i, newY > mMinY[i] );
   }
   mEventIndicatorTop->update();
 }
@@ -1544,8 +1551,12 @@
   KConfigGroup group = config->group( "Views" );
 
   QList<int> sizes = group.readEntry( "Separator AgendaView", QList<int>() );
-  mSplitterAgenda->setSizes( sizes );
 
+  // the size depends on the number of plugins used
+  if ( sizes.count() >= 2 ) {
+    mSplitterAgenda->setSizes( sizes );
+  }
+
   updateConfig();
 }
 
Index: korganizer/kojournaleditor.h
===================================================================
--- korganizer/kojournaleditor.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/kojournaleditor.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -97,7 +97,7 @@
     void readJournal( Journal *journal, bool tmpl = false );
 
     /** Write Journal settings to journal object */
-    void writeJournal( Journal * );
+    void fillJournal( Journal * );
 
     int msgItemDelete();
 
@@ -123,6 +123,7 @@
     void setupGeneral();
     void loadTemplate( CalendarLocal & );
     QStringList &templates() const;
+    bool incidenceModified();
 
   private:
     Journal *mJournal;
Index: korganizer/koeditordetails.h
===================================================================
--- korganizer/koeditordetails.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditordetails.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -95,7 +95,7 @@
     void readIncidence( Incidence * );
 
     /** Write settings to incidence */
-    void writeIncidence( Incidence * );
+    void fillIncidence( Incidence * );
 
     /** Check if the input is valid. */
     bool validateInput();
Index: korganizer/koeditorrecurrence.h
===================================================================
--- korganizer/koeditorrecurrence.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorrecurrence.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -314,7 +314,7 @@
     void readIncidence( Incidence * );
 
     /** Write event settings to event object */
-    void writeIncidence( Incidence * );
+    void fillIncidence( Incidence * );
 
     /** Check if the input is valid. */
     bool validateInput();
Index: korganizer/calendarview.cpp
===================================================================
--- korganizer/calendarview.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/calendarview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -1256,6 +1256,7 @@
   if ( alarms.isEmpty() ) {
     // Add an alarm if it didn't have one
     Alarm *alm = incidence->newAlarm();
+    alm->setType( Alarm::Display );
     alm->setEnabled( true );
   }
   mChanger->changeIncidence( oldincidence, incidence, KOGlobals::ALARM_MODIFIED );
Index: korganizer/koeditorgeneraltodo.h
===================================================================
--- korganizer/koeditorgeneraltodo.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorgeneraltodo.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -65,7 +65,7 @@
     void readTodo( Todo *todo, bool tmpl = false );
 
     /** Write todo settings to event object */
-    void writeTodo( Todo * );
+    void fillTodo( Todo * );
 
     /** Check if the input is valid. */
     bool validateInput();
Index: korganizer/kojournaleditor.cpp
===================================================================
--- korganizer/kojournaleditor.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/kojournaleditor.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -136,7 +136,7 @@
 
   if ( mJournal ) {
     Journal *oldJournal = mJournal->clone();
-    writeJournal( mJournal );
+    fillJournal( mJournal );
     mChanger->changeIncidence( oldJournal, mJournal );
     delete oldJournal;
   } else {
@@ -144,7 +144,7 @@
     mJournal->setOrganizer( Person( KOPrefs::instance()->fullName(),
                             KOPrefs::instance()->email() ) );
 
-    writeJournal( mJournal );
+    fillJournal( mJournal );
 
     if ( !mChanger->addIncidence( mJournal, this ) ) {
       delete mJournal;
@@ -176,6 +176,16 @@
   mGeneral->setTime( time );
 }
 
+bool KOJournalEditor::incidenceModified() {
+  Journal *newJournal = 0;
+
+  if ( mJournal ) {
+    newJournal = mJournal->clone();
+    fillJournal( newJournal );
+  }
+  return mJournal && !( *newJournal == *mJournal );
+}
+
 void KOJournalEditor::readJournal( Journal *journal, bool tmpl )
 {
   //TODO: just tmpl variable
@@ -189,10 +199,10 @@
   mDetails->readIncidence( journal );
 }
 
-void KOJournalEditor::writeJournal( Journal *journal )
+void KOJournalEditor::fillJournal( Journal *journal )
 {
-  mGeneral->writeJournal( journal );
-  mDetails->writeIncidence( journal );
+  mGeneral->fillJournal( journal );
+  mDetails->fillIncidence( journal );
 }
 
 bool KOJournalEditor::validateInput()
@@ -229,7 +239,7 @@
 void KOJournalEditor::slotSaveTemplate( const QString &templateName )
 {
   Journal *journal = new Journal;
-  writeJournal( journal );
+  fillJournal( journal );
   saveAsTemplate( journal, templateName );
 }
 
Index: korganizer/koeditorattachments.cpp
===================================================================
--- korganizer/koeditorattachments.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorattachments.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -775,7 +775,7 @@
   }
 }
 
-void KOEditorAttachments::writeIncidence( KCal::Incidence *i )
+void KOEditorAttachments::fillIncidence( KCal::Incidence *i )
 {
   i->clearAttachments();
 
Index: korganizer/koincidenceeditor.cpp
===================================================================
--- korganizer/koincidenceeditor.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koincidenceeditor.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -86,8 +86,13 @@
 {
 }
 
+bool KOIncidenceEditor::incidenceModified() {
+  return true;
+}
+
 void KOIncidenceEditor::slotButtonClicked( int button )
 {
+  bool dontQuit = false;
   switch( button ) {
   case KDialog::Ok:
   {
@@ -104,13 +109,16 @@
     processInput();
     break;
   case KDialog::Cancel:
-    if ( KMessageBox::questionYesNo(
-           this,
-           i18nc( "@info", "Do you really want to cancel?" ),
-           i18nc( "@title:window", "KOrganizer Confirmation" ) ) == KMessageBox::Yes ) {
-      processCancel();
-      KDialog::reject();
-    }
+    dontQuit = incidenceModified() &&
+               KMessageBox::questionYesNo(
+                 this,
+                 i18nc( "@info", "Do you really want to cancel?" ),
+                 i18nc( "@title:window", "KOrganizer Confirmation" ) ) == KMessageBox::No;
+
+    if ( !dontQuit ) {
+       processCancel();
+       KDialog::reject();
+     }
     break;
   default:
     KPageDialog::slotButtonClicked( button );
Index: korganizer/resourceview.cpp
===================================================================
--- korganizer/resourceview.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/resourceview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -308,6 +308,8 @@
   connect( mDeleteButton, SIGNAL( clicked() ), SLOT( removeResource() ) );
   connect( mEditButton, SIGNAL( clicked() ), SLOT( editResource() ) );
 
+  setMinimumHeight( 50 );
+
   updateView();
 }
 
Index: korganizer/koeventpopupmenu.cpp
===================================================================
--- korganizer/koeventpopupmenu.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeventpopupmenu.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -103,6 +103,7 @@
     }
     for ( it = mRecurrenceItems.begin(); it != mRecurrenceItems.end(); ++it ) {
       (*it)->setVisible( mCurrentIncidence->recurs() );
+      (*it)->setEnabled( !mCurrentIncidence->isReadOnly() );
     }
     popup( QCursor::pos() );
   } else {
Index: korganizer/koeventviewer.cpp
===================================================================
--- korganizer/koeventviewer.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeventviewer.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -46,6 +46,7 @@
 {
   mIncidence = 0;
   setNotifyClick( true );
+  setMinimumHeight( 1 );
 }
 
 KOEventViewer::~KOEventViewer()
Index: korganizer/kcmconfigs/korganizer_configtime.desktop
===================================================================
--- korganizer/kcmconfigs/korganizer_configtime.desktop	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/kcmconfigs/korganizer_configtime.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -29,6 +29,7 @@
 Name[ja]=日付と時間
 Name[km]=កាលបរិច្ឆេទ និង​ពេលវេលា
 Name[ko]=시간과 날짜
+Name[lt]=Laikas ir data
 Name[lv]=Laiks un datums
 Name[nb]=Dato og klokkeslett
 Name[nds]=Tiet un Datum
Index: korganizer/koeditorgeneraljournal.h
===================================================================
--- korganizer/koeditorgeneraljournal.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditorgeneraljournal.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -69,7 +69,7 @@
     /** Read journal object and setup widgets accordingly */
     void readJournal( Journal *, bool tmpl = false );
     /** Write journal settings to event object */
-    void writeJournal( Journal * );
+    void fillJournal( Journal * );
 
     /** Check if the input is valid. */
     bool validateInput();
Index: korganizer/koeditoralarms.cpp
===================================================================
--- korganizer/koeditoralarms.cpp	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koeditoralarms.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -199,6 +199,7 @@
   connect( this, SIGNAL(okClicked()), SLOT(slotOk()) );
   connect( this, SIGNAL(applyClicked()), SLOT(slotApply()) );
   init();
+  mWidget.mTypeEmailRadio->hide();
 }
 
 KOEditorAlarms::~KOEditorAlarms()
@@ -282,7 +283,7 @@
   mWidget.mRepeats->setChecked( alarm->repeatCount() > 0 );
   if ( alarm->repeatCount() > 0 ) {
     mWidget.mRepeatCount->setValue( alarm->repeatCount() );
-    mWidget.mRepeatInterval->setValue( alarm->snoozeTime().asSeconds() / 60 );
+    mWidget.mRepeatInterval->setValue( alarm->snoozeTime().asSeconds() / 60 ); // show as minutes
   }
   int id = 0;
 
@@ -355,7 +356,7 @@
   // Repeating
   if ( mWidget.mRepeats->isChecked() ) {
     alarm->setRepeatCount( mWidget.mRepeatCount->value() );
-    alarm->setSnoozeTime( mWidget.mRepeatInterval->value() );
+    alarm->setSnoozeTime( mWidget.mRepeatInterval->value() * 60 ); // convert back to seconds
   } else {
     alarm->setRepeatCount( 0 );
   }
Index: korganizer/koincidenceeditor.h
===================================================================
--- korganizer/koincidenceeditor.h	(.../tags/KDE/4.2.1/kdepim)	(wersja 938089)
+++ korganizer/koincidenceeditor.h	(.../branches/KDE/4.2/kdepim)	(wersja 938089)
@@ -133,6 +133,11 @@
     void readDesignerFields( Incidence *i );
     void writeDesignerFields( Incidence *i );
 
+    /**
+      Returns true if the user made any alteration
+    */
+    virtual bool incidenceModified();
+
     // Returns the page widget. To remove the tab, just delete that one.
     QWidget *addDesignerTab( const QString &uifile );
 

Zmiany atrybutów dla: .
___________________________________________________________________
Dodane: svn:externals
   + 


