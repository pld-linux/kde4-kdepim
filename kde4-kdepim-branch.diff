Index: akregator/plugins/onlinesync/akregator_onlinesync_plugin.desktop
===================================================================
--- akregator/plugins/onlinesync/akregator_onlinesync_plugin.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/plugins/onlinesync/akregator_onlinesync_plugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -11,6 +11,7 @@
 Name[fr]=Prise en charge des lecteurs en ligne pour Akregator
 Name[ga]=Tacaíocht Akregator do Léitheoirí Fothaí Ar Líne
 Name[gl]=Funcionalidade de Lector de Fontes en Liña do Akregator
+Name[hu]=Akregator-támogatás online hírolvasókhoz
 Name[it]=Supporto di Akregator per i lettori di fonti in linea
 Name[ja]=Akregator のオンラインフィードリーダーのサポート
 Name[km]=គាំទ្រ​កម្មវិធី​អាន​មតិព័ត៌មាន​លើ​បណ្ដាញ​របស់ Akregator
Index: akregator/plugins/onlinesync/akregator_config_onlinesync.desktop
===================================================================
--- akregator/plugins/onlinesync/akregator_config_onlinesync.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/plugins/onlinesync/akregator_config_onlinesync.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -21,6 +21,7 @@
 Name[fr]=Lecteurs en ligne
 Name[ga]=Léitheoirí Ar Líne
 Name[gl]=Lector de Novas en Liña
+Name[hu]=Online hírolvasók
 Name[it]=Lettore di fonti in linea
 Name[ja]=オンラインリーダー
 Name[km]=កម្មវិធី​អាន​លើ​បណ្ដាញ
@@ -55,6 +56,7 @@
 Comment[fr]=Configurer les lecteurs en ligne
 Comment[ga]=Cumraigh Léitheoirí Ar Líne
 Comment[gl]=Configurar Lectores en Liña
+Comment[hu]=Az online hírolvasók beállítása
 Comment[it]=Configura lettori di fonti in linea
 Comment[ja]=オンラインリーダーの設定
 Comment[km]=កំណត់​រចនាសម្ព័ន្ធ​កម្មវិធី​អាន​លើ​បណ្ដាញ
Index: akregator/src/notificationmanager.cpp
===================================================================
--- akregator/src/notificationmanager.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/notificationmanager.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -76,7 +76,7 @@
     if (feeds.count() == 1)
     {
         //KNotifyClient::Instance inst(m_instance);
-        KNotification::event("feed_added", i18n("Feed added:\n %1", feeds[0]), QPixmap() ,m_widget);
+        KNotification::event("FeedAdded", i18n("Feed added:\n %1", feeds[0]), QPixmap() ,m_widget, KNotification::CloseOnTimeout, m_instance);
     }
     else if (feeds.count() > 1)
     {
@@ -84,7 +84,7 @@
         for (QStringList::ConstIterator it = feeds.begin(); it != feeds.end(); ++it)
             message += *it + '\n';
         //KNotifyClient::Instance inst(m_instance);
-        KNotification::event("feed_added", i18n("Feeds added:\n %1", message), QPixmap() ,m_widget);
+        KNotification::event("FeedAdded", i18n("Feeds added:\n %1", message), QPixmap() ,m_widget, KNotification::CloseOnTimeout, m_instance);
     }
 }
 
@@ -92,20 +92,18 @@
 {
     QString message = "<html><body>";
     QString feedTitle;
-    QList<Article>::ConstIterator it = m_articles.constBegin();
-    QList<Article>::ConstIterator en = m_articles.constEnd();
-    for (; it != en; ++it)
+
+    Q_FOREACH( const Article& i, m_articles )
     {
-        if (feedTitle != (*it).feed()->title())
+        if (feedTitle != i.feed()->title())
         {
-            feedTitle = (*it).feed()->title();
+            feedTitle = i.feed()->title();
             message += QString("<p><b>%1:</b></p>").arg(feedTitle);
         }
-        message += (*it).title() + "<br>";
+        message += i.title() + "<br>";
     }
     message += "</body></html>";
-    //KNotifyClient::Instance inst(m_instance);
-    KNotification::event("new_articles", message,QPixmap() ,m_widget);
+    KNotification::event("NewArticles", message, QPixmap() ,m_widget, KNotification::CloseOnTimeout, m_instance);
 
     m_articles.clear();
     m_running = false;
@@ -125,7 +123,7 @@
         m_addedInLastInterval = false;
         QTimer::singleShot(m_checkInterval, this, SLOT(slotIntervalCheck()));
     }
-    
+
 }
 
 NotificationManager* NotificationManager::m_self;
Index: akregator/src/akregator.notifyrc
===================================================================
--- akregator/src/akregator.notifyrc	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/akregator.notifyrc	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -5,7 +5,7 @@
 Comment[pa]=ਅਕਰੀਗੇਟਰ
 Comment[x-test]=xxAkregatorxx
 
-[Event/feed_added]
+[Event/FeedAdded]
 Name=Feed added
 Name[af]=Stroom bygevoeg
 Name[ca]=Font afegida
@@ -101,9 +101,9 @@
 Comment[x-test]=xxA new feed was remotely added to Akregatorxx
 Comment[zh_CN]=远程添加新种子进了 Akregator
 Comment[zh_TW]=已從遠端新增 Feed 到 Akregator
-Action=Logfile
+Action=Popup
 
-[Event/new_articles]
+[Event/NewArticles]
 Name=New Articles
 Name[af]=Nuwe Artikels
 Name[br]=Pennadoù nevez
@@ -202,5 +202,5 @@
 Comment[x-test]=xxNew articles were fetchedxx
 Comment[zh_CN]=获取了新文章
 Comment[zh_TW]=有新文章進來
-Action=Logfile
+Action=Popup
 
Index: akregator/src/trayicon.h
===================================================================
--- akregator/src/trayicon.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/trayicon.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -50,11 +50,7 @@
         void settingsChanged();
         void slotSetUnread(int unread);
         void viewButtonClicked();
-        void slotActivated(QSystemTrayIcon::ActivationReason reason);
 
-    signals:
-        void toggleShowPart();
-
     private:
         static TrayIcon* m_instance;
 
Index: akregator/src/feed.cpp
===================================================================
--- akregator/src/feed.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/feed.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -31,6 +31,7 @@
 #include "feedstorage.h"
 #include "fetchqueue.h"
 #include "folder.h"
+#include "notificationmanager.h"
 #include "storage.h"
 #include "treenodevisitor.h"
 #include "types.h"
@@ -462,6 +463,7 @@
 {
     d->setTotalCountDirty();
     bool changed = false;
+    const bool notify = useNotification() || Settings::useNotifications();
 
     QList<ItemPtr> items = feed->items();
     QList<ItemPtr>::ConstIterator it = items.constBegin();
@@ -486,7 +488,8 @@
                 mya.setStatus(New);
             else
                 mya.setStatus(Read);
-
+            if ( notify )
+                NotificationManager::self()->slotNotifyArticle( mya );
             changed = true;
         }
         else // article is in list
@@ -513,6 +516,7 @@
         }
     }
 
+
     QList<Article>::ConstIterator dit = deletedArticles.constBegin();
     QList<Article>::ConstIterator dtmp;
     QList<Article>::ConstIterator den = deletedArticles.constEnd();
Index: akregator/src/akregator_part.h
===================================================================
--- akregator/src/akregator_part.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/akregator_part.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -133,7 +133,6 @@
         void showKNotifyOptions();
 
     signals:
-        void toggleShowPart();
         void signalSettingsChanged();
 
 
@@ -150,9 +149,6 @@
 
         void importFile(const KUrl& url);
 
-        /** FIXME: hack to get the tray icon working */
-        QWidget* getMainWindow();
-
         KParts::Part *hitTest(QWidget *widget, const QPoint &globalPos);
 
     private slots:
Index: akregator/src/mainwindow.cpp
===================================================================
--- akregator/src/mainwindow.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/mainwindow.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -110,7 +110,6 @@
 
     connect(m_part, SIGNAL(setWindowCaption(QString)), this, SLOT(setCaption(QString)) );
     connect(TrayIcon::getInstance(), SIGNAL(quitSelected()), this, SLOT(slotQuit()));
-    connect(m_part, SIGNAL(toggleShowPart()), this, SLOT(slotToggleVisibility()) );
 
     createGUI(m_part);
     browserExtension(m_part)->setBrowserInterface(m_browserIface);
@@ -236,11 +235,6 @@
     m_statusLabel->setText(text);
 }
 
-void MainWindow::slotToggleVisibility()
-{
-  setVisible(!isVisible());
-}
-
 void MainWindow::autoSaveProperties()
 {
     KConfig config("autosaved", KConfig::SimpleConfig,
Index: akregator/src/akregator_part.cpp
===================================================================
--- akregator/src/akregator_part.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/akregator_part.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -154,23 +154,18 @@
     // notify the part that this is our internal widget
     setWidget(m_mainWidget);
 
-    TrayIcon* trayIcon = new TrayIcon( getMainWindow() );
+    TrayIcon* trayIcon = new TrayIcon( m_mainWidget->window() );
     TrayIcon::setInstance(trayIcon);
     m_actionManager->initTrayIcon(trayIcon);
 
     connect(trayIcon, SIGNAL(toggleShowPart()), this, SIGNAL(toggleShowPart()));
 
     if ( isTrayIconEnabled() )
-    {
         trayIcon->show();
-#ifdef __GNUC__
-#warning this needs a way to get the position of the systray
-#endif
-        NotificationManager::self()->setWidget(0, componentData());
-    }
-    else
-        NotificationManager::self()->setWidget(getMainWindow(), componentData());
 
+    QWidget* const notificationParent = isTrayIconEnabled() ? m_mainWidget->window() : 0;
+    NotificationManager::self()->setWidget(notificationParent, componentData());
+
     connect( trayIcon, SIGNAL(quitSelected()),
             kapp, SLOT(quit())) ;
 
@@ -224,11 +219,7 @@
 
 void Part::slotSettingsChanged()
 {
-#ifdef __GNUC__
-#warning Tray icons are no longer widgets
-#endif
-//    NotificationManager::self()->setWidget(isTrayIconEnabled() ? TrayIcon::getInstance() : getMainWindow(), instance());
-    NotificationManager::self()->setWidget( getMainWindow(), componentData());
+    NotificationManager::self()->setWidget(isTrayIconEnabled() ? m_mainWidget->window() : 0, componentData());
 
     Syndication::FileRetriever::setUseCache(Settings::useHTMLCache());
 
@@ -458,29 +449,6 @@
     return Settings::showTrayIcon();
 }
 
-QWidget* Part::getMainWindow()
-{
-    // this is a dirty fix to get the main window used for the tray icon
-    QWidgetList l = QApplication::topLevelWidgets();
-    QWidget* wid = 0L;
-
-    // check if there is an akregator main window
-    foreach (wid, QApplication::topLevelWidgets())
-    {
-        if (wid->objectName() == "akregator_mainwindow")
-            return wid;
-    }
-
-    // if not, check if there is an kontact main window
-    foreach (wid, QApplication::topLevelWidgets())
-    {
-        if (wid->objectName().startsWith("kontact-mainwindow"))
-            return wid;
-    }
-
-    return 0;
-}
-
 void Part::importFile(const KUrl& url)
 {
     QString filename;
Index: akregator/src/akregator.desktop
===================================================================
--- akregator/src/akregator.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/akregator.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -18,6 +18,7 @@
 GenericName[fr]=Lecteur de flux
 GenericName[ga]=Léitheoir Fothaí
 GenericName[gl]=Lector de Novas
+GenericName[hu]=Hírolvasó
 GenericName[it]=Lettore di fonti
 GenericName[ja]=フィードリーダー
 GenericName[km]=កម្មវិធី​អាន​មតិព័ត៌មាន
@@ -53,6 +54,7 @@
 Comment[fr]=Un lecteur de flux pour KDE
 Comment[ga]=Léitheoir Fothaí KDE
 Comment[gl]=Un lector de novas para o KDE
+Comment[hu]=RSS-alapú hírolvasó a KDE-hez
 Comment[it]=Un lettore di fonti per KDE
 Comment[ja]=KDE のフィードリーダー
 Comment[km]=កម្មវិធី​អាន​មតិព័ត៌មាន​របស់ KDE
Index: akregator/src/mainwindow.h
===================================================================
--- akregator/src/mainwindow.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/mainwindow.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -88,7 +88,6 @@
 public slots:
     void slotClearStatusText();
     void slotSetStatusBarText(const QString &c);
-    void slotToggleVisibility();
 
 protected:
     /**
Index: akregator/src/mainwidget.cpp
===================================================================
--- akregator/src/mainwidget.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/mainwidget.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -125,8 +125,6 @@
     m_horizontalSplitter->setOpaqueResize(true);
     lt->addWidget(m_horizontalSplitter);
 
-    connect(Kernel::self()->fetchQueue(), SIGNAL(fetched(Akregator::Feed*)),
-             this, SLOT(slotFeedFetched(Akregator::Feed*)));
     connect(Kernel::self()->fetchQueue(), SIGNAL(signalStarted()),
              this, SLOT(slotFetchingStarted()));
     connect(Kernel::self()->fetchQueue(), SIGNAL(signalStopped()),
@@ -820,26 +818,6 @@
     m_mainFrame->slotSetStatusText(QString());
 }
 
-void Akregator::MainWidget::slotFeedFetched(Feed *feed)
-{
-    // iterate through the articles (once again) to do notifications properly
-    if (feed->articles().count() > 0)
-    {
-        QList<Article> articles = feed->articles();
-        QList<Article>::ConstIterator it;
-        QList<Article>::ConstIterator end = articles.constEnd();
-        for (it = articles.constBegin(); it != end; ++it)
-        {
-            if ((*it).status()==Akregator::New && ((*it).feed()->useNotification() || Settings::useNotifications()))
-            {
-                NotificationManager::self()->slotNotifyArticle(*it);
-            }
-        }
-    }
-}
-
-
-
 void Akregator::MainWidget::slotArticleSelected(const Akregator::Article& article)
 {
     if (m_viewMode == CombinedView)
Index: akregator/src/createfeedcommand.cpp
===================================================================
--- akregator/src/createfeedcommand.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/createfeedcommand.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -36,6 +36,7 @@
 
 #include <QPointer>
 #include <QTimer>
+#include <QClipboard>
 
 #include <cassert>
 
@@ -75,8 +76,20 @@
 
     QPointer<AddFeedDialog> afd = new AddFeedDialog( q->parentWidget(), "add_feed" );
 
-    afd->setUrl( KUrl::fromPercentEncoding( m_url.toLatin1() ) );
+    QString url = m_url;
 
+    if( url.isEmpty() )
+    {
+        const QClipboard* const clipboard = QApplication::clipboard();
+        assert( clipboard );
+        const QString clipboardText = clipboard->text();
+        // Check for the hostname, since the isValid method is not strict enough
+        if( !KUrl( clipboardText ).isEmpty() )
+            url = clipboardText;
+    }
+
+    afd->setUrl( KUrl::fromPercentEncoding( url.toLatin1() ) );
+
     QPointer<QObject> thisPointer( q );
 
     if ( m_autoexec )
Index: akregator/src/trayicon.cpp
===================================================================
--- akregator/src/trayicon.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/trayicon.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -64,21 +64,12 @@
     m_defaultIcon = KIcon("akregator").pixmap(22);
     setIcon(m_defaultIcon);
     this->setToolTip( i18n("Akregator - Feed Reader"));
-    connect( this, SIGNAL( activated( QSystemTrayIcon::ActivationReason ) ),
-             SLOT( slotActivated( QSystemTrayIcon::ActivationReason ) ) );
 }
 
 
 TrayIcon::~TrayIcon()
 {}
 
-
-void TrayIcon::slotActivated(QSystemTrayIcon::ActivationReason reason) {
-  if (reason == QSystemTrayIcon::Trigger )
-    emit toggleShowPart();
-}
-
-
 #if 0
 QPixmap TrayIcon::takeScreenshot() const
 {
Index: akregator/src/mainwidget.h
===================================================================
--- akregator/src/mainwidget.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/src/mainwidget.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -156,9 +156,6 @@
         /** displays a URL in the status bar when the user moves the mouse over a link */
         void slotMouseOverInfo(const KFileItem& kifi);
 
-        /** Feed has been fetched, populate article view if needed and update counters. */
-        void slotFeedFetched(Akregator::Feed *);
-
         /** adds a new feed to the feed tree */
         void slotFeedAdd();
         /** adds a feed group to the feed tree */
Index: akregator/configuration/akregator_config_browser.desktop
===================================================================
--- akregator/configuration/akregator_config_browser.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/configuration/akregator_config_browser.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -19,6 +19,7 @@
 Name[fr]=Navigateur
 Name[ga]=Brabhsálaí
 Name[gl]=Navegador
+Name[hu]=Böngésző
 Name[it]=Navigatore
 Name[ja]=ブラウザ
 Name[km]=កម្មវិធី​រុករក
@@ -53,6 +54,7 @@
 Comment[et]=Sisemise sirvimiskomponendi seadistamine
 Comment[fr]=Configurer le navigateur web interne
 Comment[gl]=Configurar o Componente Navegador Interno
+Comment[hu]=A belső böngészőkomponens beállítása
 Comment[it]=Configura il componente interno di navigazione internet
 Comment[ja]=内部ブラウザコンポーネントの設定
 Comment[km]=កំណត់​រចនាសម្ព័ន្ធ​សមាសភាគ​កម្មវិធី​រុករក​ខាង​ក្នុង
Index: akregator/configuration/akregator_config_appearance.desktop
===================================================================
--- akregator/configuration/akregator_config_appearance.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/configuration/akregator_config_appearance.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -79,6 +79,7 @@
 Comment[et]=Uudistevoogude lugeja välimuse seadistamine
 Comment[fr]=Configurer l'apparence du lecteur de flux
 Comment[gl]=Configurar a Aparencia do Lector de Novas
+Comment[hu]=Beállítások a hírolvasó megjelenéséhez
 Comment[it]=Configura l'aspetto del lettore di fonti
 Comment[ja]=フィードリーダーの外観設定
 Comment[km]=កំណត់​រចនាសម្ព័ន្ធ​រូបរាង​របស់​កម្មវិធី​អាន​​មតិព័ត៌មាន
Index: akregator/configuration/akregator_config_advanced.desktop
===================================================================
--- akregator/configuration/akregator_config_advanced.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/configuration/akregator_config_advanced.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -21,6 +21,7 @@
 Name[fr]=Avancé
 Name[ga]=Ardsocruithe
 Name[gl]=Avanzado
+Name[hu]=Speciális
 Name[is]=Nánari stillingar
 Name[it]=Avanzate
 Name[ja]=詳細
@@ -56,6 +57,7 @@
 Comment[et]=Uudistevoogude lugeja muud seadistused
 Comment[fr]=Configuration avancé du lecteur de flux
 Comment[gl]=Configuración Avanzada do Lector de Novas
+Comment[hu]=Hírolvasó-beállítások
 Comment[it]=Impostazioni avanzate per il lettore di fonti
 Comment[ja]=フィードリーダーの詳細設定
 Comment[km]=ការ​កំណត់​កម្មវិធី​អាន​មតិព័ត៌មានកម្រិត​ខ្ពស់
Index: akregator/configuration/akregator_config_general.desktop
===================================================================
--- akregator/configuration/akregator_config_general.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/configuration/akregator_config_general.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -75,6 +75,7 @@
 Comment[fr]=Configurer les flux
 Comment[ga]=Cumraigh Fothaí
 Comment[gl]=Configurar Fontes de Novas
+Comment[hu]=A hírcsatornák beállítása
 Comment[it]=Configura fonti
 Comment[ja]=フィードの全般設定
 Comment[km]=កំណត់​រចនាសម្ព័ន្ធ​មតិព័ត៌មាន
Index: akregator/configuration/akregator_config_archive.desktop
===================================================================
--- akregator/configuration/akregator_config_archive.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akregator/configuration/akregator_config_archive.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -20,6 +20,7 @@
 Name[et]=Arhiveerimine
 Name[ga]=Cartlann
 Name[gl]=Arquivo
+Name[hu]=Archívum
 Name[it]=Archivia
 Name[ja]=アーカイブ
 Name[km]=ប័ណ្ណសារ
@@ -54,6 +55,7 @@
 Comment[fr]=Configurer les archives des flux
 Comment[ga]=Cumraigh Cartlann na bhFothaí
 Comment[gl]=Configurar o Arquivo de Fontes de Novas
+Comment[hu]=A hírolvasó-archívum beállításai
 Comment[it]=Configura l'archiviazione delle fonti
 Comment[ja]=フィードのアーカイブ設定
 Comment[km]=កំណត់​រចនាសម្ព័ន្ធ​ប័ណ្ណសារ​មតិព័ត៌មាន
Index: libkleo/libkleopatrarc.desktop
===================================================================
--- libkleo/libkleopatrarc.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ libkleo/libkleopatrarc.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -285,6 +285,7 @@
 Name[et]=Kvalifitseeritud allkirjade võtmed
 Name[fr]=Clés pour les signatures qualifiées
 Name[gl]=Chaves para Asinaturas Cualificadas
+Name[hu]=Kulcsok minősített aláírásokhoz
 Name[it]=Chiavi per le firme qualificate
 Name[ja]=適格電子署名用の鍵
 Name[km]=សោ​សម្រាប់​ហត្ថលេខា​ដែល​មាន​​គុណភាព
@@ -323,6 +324,7 @@
 Name[fy]=Oare kaaien
 Name[ga]=Eochracha Eile
 Name[gl]=Outras Chaves
+Name[hu]=Egyéb kulcsok
 Name[it]=Altre chiavi
 Name[ja]=その他の鍵
 Name[km]=សោ​ផ្សេង​ទៀត
Index: kode/kwsdl/kwsdl_compiler.desktop
===================================================================
--- kode/kwsdl/kwsdl_compiler.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kode/kwsdl/kwsdl_compiler.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[et]=KWSDL kompilaator
 Name[ga]=Tiomsaitheoir KWSDL
 Name[gl]=Compilador KWSDL
+Name[hu]=KWSDL-fordító
 Name[it]=Compilatore KWSDL
 Name[ja]=KWSDL コンパイラ
 Name[kk]=KWSDL компиляторы
Index: kode/kxforms/kxforms.desktop
===================================================================
--- kode/kxforms/kxforms.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kode/kxforms/kxforms.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -18,6 +18,7 @@
 GenericName[fr]=Éditeur de formulaires XML
 GenericName[ga]=Eagarthóir Foirme XML
 GenericName[gl]=Editor de Formularios XML
+GenericName[hu]=XML-űrlapszerkesztő
 GenericName[it]=Editor di moduli XML
 GenericName[ja]=XML フォームエディタ
 GenericName[kk]=XML пішін өңдегіші
Index: kleopatra/kleopatra_import.desktop
===================================================================
--- kleopatra/kleopatra_import.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kleopatra/kleopatra_import.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -22,6 +22,7 @@
 Comment[et]=Sertifikaadihaldur ja ühendatud krüptimise graafiline kasutajaliides
 Comment[fr]=Interface de gestion des certificats et cryptographie unifiée
 Comment[gl]=Xestor de Certificados e Interface Gráfica Unificada de Criptografí­a
+Comment[hu]=Tanúsítványkezelő és egységes kriptográfiai kezelőfelület
 Comment[it]=Gestore di certificati e interfaccia grafica unificata di crittografia
 Comment[ja]=証明書マネージャと、統合された暗号 GUI
 Comment[km]=កម្មវិធី​គ្រប់គ្រង​វិញ្ញាបនបត្រ និង​មិន​​​បញ្ចូល​ Crypto GUI
Index: kleopatra/conf/kleopatra_config_smimevalidation.desktop
===================================================================
--- kleopatra/conf/kleopatra_config_smimevalidation.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kleopatra/conf/kleopatra_config_smimevalidation.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -22,6 +22,7 @@
 Name[et]=S/MIME valideerimine
 Name[fr]=Validation S/MIME
 Name[gl]=Validación S/MIME
+Name[hu]=S/MIME-ellenőrzés
 Name[it]=Convalida S/MIME
 Name[ja]=S/MIME 検証
 Name[km]=ការ​ធ្វើ​ឲ្យ S/MIME មាន​សុពលភាព
@@ -54,6 +55,7 @@
 Comment[et]=S/MIME sertifikaatide valideerimise valikute seadistamine
 Comment[fr]=Configuration des options de validation des certificats S/MIME
 Comment[gl]=Configuración das opcións de validación de certificados S/MIME
+Comment[hu]=Az S/MIME-tanúsítványok ellenőrzési beállításai
 Comment[it]=Configurazione delle opzioni di convalida del certificato S/MIME
 Comment[ja]=S/MIME 証明書の検証オプションの設定
 Comment[km]=ជម្រើស​ធ្វើ​ឲ្យ​ការ​កំណត់​​រចនា​សម្ព័ន្ធ​របស់​វិញ្ញាបនបត្រ​របស់ S/MIME ប្រើ​បាន
Index: kleopatra/conf/kleopatra_config_dirserv.desktop
===================================================================
--- kleopatra/conf/kleopatra_config_dirserv.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kleopatra/conf/kleopatra_config_dirserv.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -75,6 +75,7 @@
 Comment[fr]=Configuration des annuaires
 Comment[ga]=Cumraíocht seirbhísí eolaire
 Comment[gl]=Configuración dos servizos de directorio
+Comment[hu]=A címtárszolgáltatások beállításai
 Comment[it]=Configurazione dei servizi directory
 Comment[ja]=ディレクトリサービスの設定
 Comment[km]=ការ​កំណត់​រចនាសម្ព័ន្ធ​សេវា​ថត
Index: kleopatra/kleopatra_decryptverifyfolders.desktop
===================================================================
--- kleopatra/kleopatra_decryptverifyfolders.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kleopatra/kleopatra_decryptverifyfolders.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -12,6 +12,7 @@
 Name[et]=Kleopatra kõigi kataloogi failide lahtikrüptimine/kontrollimine
 Name[fr]=Kleopatra vérification et déchiffrement de tous les fichiers dans un dossier
 Name[gl]=Descifrar/Verificar Todos os Ficheiros do Cartafol co Kleopatra
+Name[hu]=Kleopatra - Fájlok dekódolása és ellenőrzése egy mappában
 Name[it]=Kleopatra decodifica/verifica tutti i file nella cartella
 Name[ja]=Kleopatra フォルダのすべてのファイルを復号/検証
 Name[km]=Kleopatra ឌិគ្រីប/ផ្ទៀងផ្ទាត់​ឯកសារ​ទាំងអស់​នៅ​ក្នុង​ថត
@@ -47,6 +48,7 @@
 Name[et]=Kõigi kataloogi failide lahtikrüptimine/kontrollimine
 Name[fr]=Vérifier et déchiffrer tous les fichiers dans un dossier
 Name[gl]=Descifrar/Verificar Todos os Ficheiros do Cartafol
+Name[hu]=Dekódol és ellenőriz minden fájlt egy mappában
 Name[it]=Decodifica/verifica tutti i file nella cartella
 Name[ja]=フォルダのすべてのファイルを復号/検証
 Name[km]=ឌិគ្រីប/ផ្ទៀងផ្ទាត់​ឯកសារ​ទាំងអស់​នៅ​ក្នុង​ថត
Index: kleopatra/kleopatra_decryptverifyfiles.desktop
===================================================================
--- kleopatra/kleopatra_decryptverifyfiles.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kleopatra/kleopatra_decryptverifyfiles.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -13,6 +13,7 @@
 Name[et]=Kleopatra failide lahtikrüptimine/kontrollimine
 Name[fr]=Kleopatra vérification et déchiffrement de fichiers
 Name[gl]=Descifrar/Verificar Ficheiros con Kleopatra
+Name[hu]=Kleopatra - Fájlok dekódolása és ellenőrzése
 Name[it]=Kleopatra decodifica/verifica file
 Name[ja]=Kleopatra ファイルを復号/検証
 Name[km]=Kleopatra ឌិគ្រិប​/ផ្ទៀងផ្ទាត់​ឯកសារ​របស់
@@ -48,6 +49,7 @@
 Name[et]=Faili lahtikrüptimine/kontrollimine
 Name[fr]=Vérifier et déchiffrer le fichier
 Name[gl]=Descifrar/Verificar Ficheiros
+Name[hu]=Fájlok dekódolása és ellenőrzése
 Name[it]=Decodifica/verifica file
 Name[ja]=ファイルを復号/検証
 Name[km]=ឌិគ្រិប/ផ្ទៀងផ្ទាត់​ឯកសារ
Index: kleopatra/kleopatra_signencryptfolders.desktop
===================================================================
--- kleopatra/kleopatra_signencryptfolders.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kleopatra/kleopatra_signencryptfolders.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -13,6 +13,7 @@
 Name[et]=Kleopatra kataloogide allkirjastamine/krüptimine
 Name[fr]=Kleopatra signature et chiffrement de dossiers
 Name[gl]=Asinar/Cifrar Cartafoles co Kleopatra
+Name[hu]=Kleopatra - Mappák aláírása és titkosítása
 Name[it]=Kleopatra firma/codifica cartelle
 Name[ja]=Kleopatra フォルダに署名/暗号化
 Name[km]=Kleopatra ចុះហត្ថលេខា/អ៊ីនគ្រិប​ថត
@@ -47,6 +48,7 @@
 Name[et]=Kataloogi arhiveerimine, allkirjastamine ja krüptimine
 Name[fr]=Archiver, signer et chiffrer le dossier
 Name[gl]=Arquivar, Asinar e Cifrar Cartafol
+Name[hu]=Mappa archiválása, aláírása és titkosítása
 Name[it]=Archivia, firma e codifica cartella
 Name[ja]=フォルダをアーカイブして署名、暗号化
 Name[km]=ប័ណ្ណសារ ចុះហត្ថលេខា និង​អ៊ីនគ្រិប​ថត
@@ -85,6 +87,7 @@
 Name[fr]=Archiver et chiffrer le dossier
 Name[ga]=Cuir Fillteán i gCartlann agus Criptigh É
 Name[gl]=Arquivar e Cifrar Cartafol
+Name[hu]=Mappa archiválása és titkosítása
 Name[it]=Archivia e codifica cartella
 Name[ja]=フォルダをアーカイブして暗号化
 Name[km]=ប័ណ្ណសារ និង​អ៊ីនគ្រិប​ថត
Index: kleopatra/kleopatra_signencryptfiles.desktop
===================================================================
--- kleopatra/kleopatra_signencryptfiles.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kleopatra/kleopatra_signencryptfiles.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -14,6 +14,7 @@
 Name[et]=Kleopatra failide allkirjastamine/krüptimine
 Name[fr]=Kleopatra signature et chiffrement de fichiers
 Name[gl]=Asinar/Cifrar Ficheiros co Kleopatra
+Name[hu]=Kleopatra - Fájlok aláírása és titkosítása
 Name[it]=Kleopatra firma/codifica file
 Name[ja]=Kleopatra ファイルに署名/暗号化
 Name[km]=Kleopatra ចុះហត្ថលេខា/អ៊ីនគ្រិប​ឯកសារ
@@ -49,6 +50,7 @@
 Name[et]=Faili krüptimine ja allkirjastamine
 Name[fr]=Chiffrer et signer le fichier
 Name[gl]=Cifrar e Asinar Ficheiro
+Name[hu]=Fájl aláírása és titkosítása
 Name[it]=Codifica e firma file
 Name[ja]=ファイルに署名/暗号化
 Name[km]=អ៊ីនគ្រិប និង​ចុះហត្ថលេខា​ឯកសារ
@@ -88,6 +90,7 @@
 Name[fr]=Chiffrer le fichier
 Name[ga]=Criptigh Comhad
 Name[gl]=Cifrar Ficheiro
+Name[hu]=Fájl titkosítása
 Name[it]=Codifica file
 Name[ja]=ファイルを暗号化
 Name[km]=អ៊ីនគ្រិប​ឯកសារ
@@ -126,6 +129,7 @@
 Name[et]=Faili OpenPGP-allkirjastamine
 Name[fr]=Signer le fichier avec OpenPGP
 Name[gl]=Asinar Ficheiro con OpenPGP
+Name[hu]=OpenPGP-aláírásfájl
 Name[it]=Firma file con OpenPGP
 Name[ja]=OpenPGP でファイルに署名
 Name[km]=OpenPGP-ចុះហត្ថលេខា​ឯកសារ
@@ -163,6 +167,7 @@
 Name[et]=Faili S/MIME-allkirjastamine
 Name[fr]=Signer le fichier avec S/MIME
 Name[gl]=Asinar Ficheiro con S/MIME
+Name[hu]=S/MIME-aláírásfájl
 Name[it]=Firma file con S/MIME
 Name[ja]=S/MIME でファイルに署名
 Name[km]=S/MIME-ចុះហត្ថលេខា​​ឯកសារ
Index: wizards/groupwisemain.cpp
===================================================================
--- wizards/groupwisemain.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ wizards/groupwisemain.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -48,8 +48,8 @@
 
   bool verbose = false;
   if ( args->isSet( "verbose" ) ) verbose = true;
-
+  args->clear();
   GroupwiseWizard wizard;
 
-  wizard.exec();
+  return wizard.exec();
 }
Index: wizards/sloxmain.cpp
===================================================================
--- wizards/sloxmain.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ wizards/sloxmain.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -47,8 +47,8 @@
 
   bool verbose = false;
   if ( args->isSet( "verbose" ) ) verbose = true;
-
+  args->clear();
   SloxWizard wizard;
 
-  wizard.exec();
+  return wizard.exec();
 }
Index: wizards/kolabmain.cpp
===================================================================
--- wizards/kolabmain.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ wizards/kolabmain.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -47,8 +47,8 @@
 
   bool verbose = false;
   if ( args->isSet( "verbose" ) ) verbose = true;
-
+  args->clear();
   KolabWizard wizard;
 
-  wizard.exec();
+  return wizard.exec();
 }
Index: wizards/groupwaremain.cpp
===================================================================
--- wizards/groupwaremain.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ wizards/groupwaremain.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -48,11 +48,11 @@
   QString serverType;
   if ( args->isSet( "serverType" ) )
     serverType = args->getOption( "serverType" );
-
+  args->clear();
   GroupwareWizard wizard( 0 );
   app.setMainWidget( &wizard );
 
   wizard.show();
 
-  app.exec();
+  return app.exec();
 }
Index: wizards/egroupwaremain.cpp
===================================================================
--- wizards/egroupwaremain.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ wizards/egroupwaremain.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -48,8 +48,8 @@
 
   bool verbose = false;
   if ( args->isSet( "verbose" ) ) verbose = true;
-
+  args->clear();
   EGroupwareWizard wizard;
 
-  wizard.exec();
+  return wizard.exec();
 }
Index: wizards/kmailchanges.cpp
===================================================================
--- wizards/kmailchanges.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ wizards/kmailchanges.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -243,14 +243,12 @@
   group = c.group( QString("Folder-%1").arg( uid ) );
   group.writeEntry( "isOpen", true );
 
-  if ( mEnableSavePassword ) {
-    group.writeEntry( "pass", KStringHandler::obscure( mPassword ) );
-    group.writeEntry( "store-passwd", true );
-  }
-
   group = c.group( QLatin1String( "AccountWizard" ) );
   group.writeEntry( QLatin1String( "ShowOnStartup" ), false );
 
+  group = c.group( QLatin1String( "Composer" ) );
+  group.writeEntry( "default-transport", mAccountName );
+
   KConfig transport( "mailtransports" );
   group = transport.group( QString("Transport %1").arg( transportId ) );
   group.writeEntry( "name", mAccountName );
Index: wizards/scalixmain.cpp
===================================================================
--- wizards/scalixmain.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ wizards/scalixmain.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -47,7 +47,8 @@
   bool verbose = false;
   if ( args->isSet( "verbose" ) ) verbose = true;
 
+  args->clear();
   ScalixWizard wizard;
 
-  wizard.exec();
+  return wizard.exec();
 }
Index: kresources/blog/blog.desktop
===================================================================
--- kresources/blog/blog.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/blog/blog.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -13,6 +13,7 @@
 Name[fr]=Journal dans un blog
 Name[ga]=Dialann i mblag
 Name[gl]=Diario nun blogue
+Name[hu]=Blogos naptár
 Name[it]=Diario in un blog
 Name[ja]=ブログの日記
 Name[km]=ទិនានុប្បវត្តិ​នៅ​ក្នុង​ប្លុក
@@ -47,6 +48,7 @@
 Comment[fr]=Permet de de poster des évènements du calendrier comme des entrées de journal
 Comment[ga]=Leis an mbreiseán seo is féidir leat iontrálacha dialainne a chur suas ar do bhlag
 Comment[gl]=Permite publicar as entradas do diario como entradas de blogue
+Comment[hu]=Lehetővé teszi naplóbejegyzések publikálását blogba
 Comment[it]=Consente di inserire voci di diario in un blog
 Comment[ja]=日記のエントリをブログのエントリとして投稿できるようにします
 Comment[km]=អនុញ្ញាត​ឲ្យ​ប្រកាស​ធាតុ​ទិនានុប្បវត្ត​ជា​ធាតុ​កំណត់ហេតុ​បណ្ដាញ
Index: kresources/scalix/kabc/scalix.desktop
===================================================================
--- kresources/scalix/kabc/scalix.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/scalix/kabc/scalix.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -6,12 +6,14 @@
 Name[da]=Adressebog på Scalix-server via KMail
 Name[de]=Scalix-Adressbuch via KMail
 Name[el]=Ημερολόγιο σε εξυπηρετητή Scalix μέσω του KMail
+Name[en_GB]=Address book on Scalix Server via KMail
 Name[es]=Libreta de direcciones en servidor Scalix por medio de KMail
 Name[et]=Aadressiraamat Scalix-serveris (KMaili vahendusel)
 Name[fi]=Osoitekirja Scalix-palvelimella KMailin avulla
 Name[fr]=Carnet d'adresses sur serveur Scalix (via KMail)
 Name[ga]=Leabhar Seoltaí ar Fhreastalaí Scalix via KMail
 Name[gl]=Caderno de enderezos nun servidor Scalix mediante KMail
+Name[hu]=Scalix-kiszolgálón tárolt címjegyzék elérése KMaillel
 Name[it]=Rubrica indirizzi su server Scalix via KMail
 Name[ja]=KMail 経由 Scalix サーバのアドレス帳
 Name[km]=សៀវភៅ​អាសយដ្ឋាន​នៅ​លើ​ម៉ាស៊ីន​បម្រើ Scalix តាមរយៈ KMail
@@ -42,6 +44,7 @@
 Comment[et]=Võimaldab kasutada kontakte, mis on salvestatud Scalix-serverisse IMAP abil KMaili või Kontacti vahendusel
 Comment[fr]=Fourni l'accès aux contacts stockés dans un serveur Scalix en utilisant IMAP via KMail ou Kontact
 Comment[gl]=Permite acceder aos contactos almacenados nun servidor de Scalix empregando IMAP mediante o KMail ou o Kontact
+Comment[hu]=Hozzáférést biztosít Scalix-kiszolgálón tárolt névjegyekhez IMAP protokollal, a KMailen vagy a Kontacton keresztül
 Comment[it]=Consente l'accesso ai contatti memorizzati su un server Scalix che usa IMAP tramite KMail o Kontact
 Comment[ja]=KMail または Kontact 経由で IMAP を使って、Scalix サーバに保存されている連絡先へのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ទំនាក់ទំនង​ដែល​បាន​រក្សាទុក​នៅ​លើ​ម៉ាស៊ីន​បម្រើ Scalix ដោយប្រើ IMAP តាមរយៈ KMail ឬ Kontact
Index: kresources/scalix/knotes/scalix.desktop
===================================================================
--- kresources/scalix/knotes/scalix.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/scalix/knotes/scalix.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -11,6 +11,7 @@
 Name[fr]=Notes sur serveur Scalix (via KMail)
 Name[ga]=Nótaí ar Fhreastalaí Scalix via KMail
 Name[gl]=Notas nun servidor Scalix mediante o KMail
+Name[hu]=Scalix-kiszolgálón tárolt feljegyzések elérése KMaillel
 Name[it]=Note su server Scalix via KMail
 Name[ja]=KMail 経由 Scalix サーバのメモ
 Name[km]=ចំណាំ​នៅ​លើ​ម៉ាស៊ីន​បម្រើ Scalix តាមរយៈ KMail
Index: kresources/scalix/kcal/scalix.desktop
===================================================================
--- kresources/scalix/kcal/scalix.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/scalix/kcal/scalix.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -12,6 +12,7 @@
 Name[fr]=Agenda sur serveur Scalix (via KMail)
 Name[ga]=Féilire ar Fhreastalaí Scalix via KMail
 Name[gl]=Calendario nun servidor Scalix mediante o KMail
+Name[hu]=Scalix-kiszolgálón tárolt naptár elérése KMaillel
 Name[it]=Calendario su server Scalix via KMail
 Name[ja]=KMail 経由 Scalix サーバのカレンダー
 Name[km]=ប្រតិទិន​នៅ​លើ​ម៉ាស៊ីន​បម្រើ Scalix តាមរយៈ KMail
Index: kresources/slox/kabc_ox.desktop
===================================================================
--- kresources/slox/kabc_ox.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/slox/kabc_ox.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -54,6 +54,7 @@
 Comment[et]=Võimaldab kasutada kontakte, mis on salvestatud Open-Xchange'i serverisse
 Comment[fr]=Fourni l'accès aux contacts stockés dans un serveur Open-Xchange
 Comment[gl]=Permite acceder aos contactos almacenados nun servidor de Open-Xchange
+Comment[hu]=Hozzáférést biztosít Open-Xchange-kiszolgálón tárolt névjegyekhez
 Comment[it]=Consente l'accesso ai contatti memorizzati su un server Open-Xchange
 Comment[ja]=Open-Xchange サーバに保存されている連絡先へのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ទំនាក់ទំនង​ដែល​បាន​រក្សាទុក​នៅ​លើ​ម៉ាស៊ីន​បម្រើ Open-Xchange
Index: kresources/groupdav/kabc_groupdav.desktop
===================================================================
--- kresources/groupdav/kabc_groupdav.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/groupdav/kabc_groupdav.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -55,6 +55,7 @@
 Comment[et]=Võimaldab kasutada kontakte, mis on salvestatud aadressiraamatutesse GroupDAVi toetusega serverites (nt OpenGroupware)
 Comment[fr]=Fourni l'accès aux contacts stockés dans les dossiers du carnet d'adresses d'un serveur prenant en charge GroupDAV comme par exemple OpenGroupware
 Comment[gl]=Permite acceder aos contactos almacenados nos cadernos de enderezos dos servidores con GroupDAV, p. ex. OpenGroupware
+Comment[hu]=Hozzáférést biztosít GroupDAV-típusú címjegyzékek tartalmához, pl. az OpenGroupware-ben
 Comment[it]=Consente l'accesso ai contatti della rubrica nei server GroupDAV, come ad esempio OpenGroupware
 Comment[ja]=GroupDAV に対応したサーバ (例: OpenGroupware) のアドレス帳に保存されている連絡先へのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ទំនាក់ទំនង​ដែល​បាន​រក្សាទុក​នៅ​ក្នុង​សៀវភៅ​អាសយដ្ឋាន​នៅលើ​ម៉ាស៊ីន​បម្រើ​ដែល​បាន​អនុញ្ញាត GroupDAV ឧ. OpenGroupware
Index: kresources/kolab/kabc/kolab.desktop
===================================================================
--- kresources/kolab/kabc/kolab.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/kolab/kabc/kolab.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -56,6 +56,7 @@
 Comment[et]=Võimaldab kasutada kontakte, mis on salvestatud Kolabi serverisse IMAP abil KMaili või Kontacti vahendusel
 Comment[fr]=Fourni l'accès aux contacts stockés dans un serveur Kolab utilisant IMAP via KMail ou Kontact
 Comment[gl]=Permite acceder aos contactos almacenados nun servidor de Kolab empregando IMAP mediante o KMail ou o Kontact
+Comment[hu]=Hozzáférést biztosít Kolab-kiszolgálókon tárolt névjegyekhez IMAP protokollal, a KMailen vagy a Kontacton keresztül
 Comment[it]=Consente l'accesso ai contatti memorizzati su un server Kolab che usa IMAP tramite KMail o Kontact
 Comment[ja]=KMail または Kontact 経由で IMAP を使って、Kolab サーバに保存されている連絡先へのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ទំនាក់ទំនង​ដែល​បាន​រក្សាទុក​នៅ​លើ​ម៉ាស៊ីន​បម្រើ Kolab ដោយប្រើ IMAP តាមរយៈ KMail ឬ Kontact
Index: kresources/kolab/kcal/kolab.desktop
===================================================================
--- kresources/kolab/kcal/kolab.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/kolab/kcal/kolab.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -56,6 +56,7 @@
 Comment[et]=Võimaldab kasutada kalendrit, mis on salvestatud Kolabi serverisse IMAP abil KMaili või Kontacti vahendusel
 Comment[fr]=Fourni l'accès à un calendrier stocké dans un serveur Kolab utilisant IMAP via KMail ou Kontact
 Comment[gl]=Permite acceder a un calendario almacenado nun servidor de Kolab empregando IMAP mediante o KMail ou o Kontact
+Comment[hu]=Hozzáférést biztosít Kolab-kiszolgálón tárolt naptárakhoz IMAP protokollal, a KMailen vagy a Kontacton keresztül
 Comment[it]=Consente l'accesso ad un calendario memorizzato su un server Kolab che usa IMAP tramite KMail o Kontact
 Comment[ja]=KMail または Kontact 経由で IMAP を使って、Kolab サーバに保存されているカレンダーへのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ប្រតិទិន​ដែល​បាន​ទុក​នៅ​លើ​ម៉ាស៊ីន​បម្រើ Kolab ដោយប្រើ IMAP តាមរយៈ KMail ឬ Kontact
Index: kresources/birthdays/kabc.desktop
===================================================================
--- kresources/birthdays/kabc.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/birthdays/kabc.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -63,6 +63,7 @@
 Comment[et]=Võimaldab kasutada KDE aadressiraamatusse kalendrisündmustena salvestatud kontaktide sünnipäevi
 Comment[fr]=Fourni l'accès aux dates d'anniversaire des contacts du carnet d'adresses comme des évènements du calendrier
 Comment[gl]=Permite acceder ás datas de cumpreanos dos contactos do caderno de enderezos do KDE como eventos do calendario
+Comment[hu]=Hozzáférést biztosít a névjegyekben tárolt születésnapokhoz a KDE címjegyzékben (eseményként)
 Comment[it]=Consente l'accesso alle date di nascita dei contatti della rubrica di KDE come eventi di calendario.
 Comment[ja]=KDE のアドレス帳にカレンダーイベントとして保存されている誕生日へのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​កាលបរិច្ឆេទ​ថ្ងៃ​ខួប​កំណើត​នៃ​ទំនាក់ទំនង​នៅ​ក្នុង​សៀវភៅ​អាសយដ្ឋាន KDE ជា​ព្រឹត្តិការណ៍​ប្រតិទិន
@@ -75,7 +76,7 @@
 Comment[pl]=Zapewnia dostęp do dat urodzin wizytówek w książce adresowej KDE jako zdarzeń kalendarza
 Comment[pt]=Oferece o acesso às datas de aniversário dos contactos no livro de endereços como eventos do calendário
 Comment[pt_BR]=Fornece acesso às datas de aniversário de contatos do livro de endereços do KDE como eventos de calendário
-Comment[ru]=Показ дней рождения из адресной книги KDE как событий календаря
+Comment[ru]=Дни рождения из адресной книги KDE в органайзере
 Comment[sl]=Omogoča dostop do rojstnih dnevov stikov, shranjenih v KDE-jevem adresarju. Na voljo so kot koledarski dogodki.
 Comment[sv]=Ger tillgång till födelsedagsdatum för kontakter i KDE:s adressbok som kalenderhändelser
 Comment[tr]=KDE Adres defterindeki kişilerin doğumgünü günlerine takvim olayları olarak erişmeyi sağlar
Index: kresources/remote/remote.desktop
===================================================================
--- kresources/remote/remote.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/remote/remote.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -60,6 +60,7 @@
 Comment[et]=Võimaldab kasutada võrgufaili salvestatud kalendrit KDE võrguraamistiku KIO abil
 Comment[fr]=Fourni l'accès à un calendrier dans un fichier distant en utilisant les composants réseaux KIO de KDE
 Comment[gl]=Permite acceder a un calendario nun ficheiro remoto empregando a infraestrutura de rede KIO do KDE
+Comment[hu]=Hozzáférést biztosít távoli fájlban tárolt naptárkhoz a KDE KIO keretrendszerén keresztül
 Comment[it]=Consente l'accesso ad un calendario su un file remoto tramite l'infrastruttura di rete KIO di KDE
 Comment[ja]=KDE のネットワークフレームワーク KIO を使って、リモートファイルに保存されているカレンダーへのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ប្រតិទិន​នៅ​ក្នុង​ឯកសារ​ពីចម្ងាយ​ដោយប្រើ​គ្រោងការណ៍​បណ្ដាញ KIO របស់ KDE
Index: kresources/akonadi/kabc/resourceakonadi.cpp
===================================================================
--- kresources/akonadi/kabc/resourceakonadi.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/akonadi/kabc/resourceakonadi.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -21,8 +21,9 @@
 #include "resourceakonadi.h"
 #include "resourceakonadiconfig.h"
 
+#include "../shared/concurrentjobs.h"
+
 #include <akonadi/collection.h>
-#include <akonadi/collectionfetchjob.h>
 #include <akonadi/collectionfilterproxymodel.h>
 #include <akonadi/collectionmodel.h>
 #include <akonadi/control.h>
@@ -31,7 +32,6 @@
 #include <akonadi/item.h>
 #include <akonadi/itemcreatejob.h>
 #include <akonadi/itemdeletejob.h>
-#include <akonadi/itemfetchjob.h>
 #include <akonadi/itemfetchscope.h>
 #include <akonadi/itemmodifyjob.h>
 #include <akonadi/transactionsequence.h>
@@ -41,8 +41,6 @@
 #include <kconfiggroup.h>
 #include <kdebug.h>
 
-#include <QtConcurrentRun>
-#include <QFuture>
 #include <QHash>
 
 using namespace Akonadi;
@@ -56,81 +54,42 @@
   virtual Collection collectionForUid( const QString &uid ) const = 0;
 };
 
-static KJob *createSaveSequence( const UidToCollectionMapper &mapper,
+static Akonadi::Job *createSaveSequence( const UidToCollectionMapper &mapper,
     const Item::List &addedItems, const Item::List &modifiedItems, const Item::List &deletedItems );
 
-class ThreadJobContext
+class ConcurrentItemSaveJob : public ConcurrentJob<Akonadi::Job>
 {
   public:
-    explicit ThreadJobContext( const UidToCollectionMapper &mapper )
-      : mMapper( mapper ) {}
+    ConcurrentItemSaveJob(  const UidToCollectionMapper &mapper,
+        const Item::List &addedItems, const Item::List &modifiedItems,
+        const Item::List &deletedItems )
+      : ConcurrentJob<Akonadi::Job>(),
+        mMapper( mapper ),
+        mAddedItems( addedItems ),
+        mModifiedItems( modifiedItems ),
+        mDeletedItems( deletedItems ) {}
 
-    void clear()
+    const ConcurrentItemSaveJob *operator->() const
     {
-      mJobError.clear();
-      mCollections.clear();
-      mItems.clear();
-
-      mAddedItems.clear();
-      mModifiedItems.clear();
-      mDeletedItems.clear();
+      return this;
     }
 
-    bool fetchCollections()
-    {
-      CollectionFetchJob *job = new CollectionFetchJob( Collection::root(), CollectionFetchJob::Recursive );
+  protected:
+    const UidToCollectionMapper &mMapper;
 
-      bool jobResult = job->exec();
-      if ( jobResult )
-        mCollections = job->collections();
-      else
-        mJobError = job->errorString();
+    const Item::List mAddedItems;
+    const Item::List mModifiedItems;
+    const Item::List mDeletedItems;
 
-      delete job;
-      return jobResult;
-    }
-
-    bool fetchItems( const Collection &collection )
+  protected:
+    void createJob()
     {
-      ItemFetchJob *job = new ItemFetchJob( collection );
-      job->fetchScope().fetchFullPayload();
-
-      bool jobResult = job->exec();
-      if ( jobResult )
-        mItems = job->items();
-      else
-        mJobError = job->errorString();
-
-      delete job;
-      return jobResult;
+      mJob = createSaveSequence( mMapper, mAddedItems, mModifiedItems, mDeletedItems );
     }
 
-    bool saveChanges()
+    void handleSuccess()
     {
-      KJob *job = createSaveSequence( mMapper, mAddedItems, mModifiedItems, mDeletedItems );
-
-      bool jobResult = job->exec();
-      if ( !jobResult )
-        mJobError = job->errorString();
-
-      delete job;
-      return jobResult;
     }
-
-  public:
-    QString mJobError;
-
-    Collection::List mCollections;
-    Item::List mItems;
-
-    Item::List mAddedItems;
-    Item::List mModifiedItems;
-    Item::List mDeletedItems;
-
-  private:
-    const UidToCollectionMapper &mMapper;
-
-  private:
 };
 
 typedef QMap<Item::Id, Item> ItemMap;
@@ -210,8 +169,7 @@
 {
   public:
     Private( ResourceAkonadi *parent )
-      : mParent( parent ), mMonitor( 0 ), mCollectionModel( 0 ), mCollectionFilterModel( 0 ),
-        mThreadJobContext( *this ), mOpenState(Opened)
+      : mParent( parent ), mMonitor( 0 ), mCollectionModel( 0 ), mCollectionFilterModel( 0 ), mOpenState(Opened)
     {
     }
 
@@ -258,8 +216,6 @@
 
     QSet<QString> mAsyncLoadCollections;
 
-    ThreadJobContext mThreadJobContext;
-
     enum OpenState
     {
       Closed,
@@ -285,7 +241,7 @@
 
     Collection findDefaultCollection() const;
     bool prepareSaving();
-    KJob *createSaveSequence() const;
+    Akonadi::Job *createSaveSequence() const;
 
     void createItemListsForSave( Item::List &added, Item::List &modified, Item::List &deleted ) const;
 
@@ -464,15 +420,13 @@
 
   // if we do not have any collection yet, fetch them explicitly
   if ( collections.isEmpty() ) {
-    d->mThreadJobContext.clear();
-    QFuture<bool> threadResult =
-      QtConcurrent::run( &(d->mThreadJobContext), &ThreadJobContext::fetchCollections );
-    if ( !threadResult.result() ) {
-      emit loadingError( this, d->mThreadJobContext.mJobError );
+    ConcurrentCollectionFetchJob fetchJob;
+    if ( !fetchJob.exec() ) {
+      emit loadingError( this, fetchJob->errorString() );
       return false;
     }
 
-    collections = d->mThreadJobContext.mCollections;
+    collections = fetchJob->collections();
   }
 
   bool result = true;
@@ -529,15 +483,13 @@
 
   // if we do not have any collection yet, fetch them explicitly
   if ( collections.isEmpty() ) {
-    d->mThreadJobContext.clear();
-    QFuture<bool> threadResult =
-      QtConcurrent::run( &(d->mThreadJobContext), &ThreadJobContext::fetchCollections );
-    if ( !threadResult.result() ) {
-      emit loadingError( this, d->mThreadJobContext.mJobError );
+    ConcurrentCollectionFetchJob fetchJob;
+    if ( !fetchJob.exec() ) {
+      emit loadingError( this, fetchJob->errorString() );
       return false;
     }
 
-    foreach ( const Collection &collection, d->mThreadJobContext.mCollections ) {
+    foreach ( const Collection &collection, fetchJob->collections() ) {
       if ( !collection.contentMimeTypes().contains( QLatin1String( "text/directory" ) )
             && !collection.contentMimeTypes().contains( KPIM::ContactGroup::mimeType() ) )
         continue;
@@ -588,22 +540,22 @@
   if ( !d->prepareSaving() )
     return false;
 
-  d->mThreadJobContext.clear();
+  Item::List addedItems;
+  Item::List modifiedItems;
+  Item::List deletedItems;
 
-  d->createItemListsForSave( d->mThreadJobContext.mAddedItems,
-                             d->mThreadJobContext.mModifiedItems,
-                             d->mThreadJobContext.mDeletedItems );
+  d->createItemListsForSave( addedItems, modifiedItems, deletedItems );
 
-  QFuture<bool> threadResult =
-    QtConcurrent::run( &(d->mThreadJobContext), &ThreadJobContext::saveChanges );
-  if ( !threadResult.result() ) {
-    // TODO error handling
-    kError(5700) << "Save Sequence failed:" << d->mThreadJobContext.mJobError;
+  ConcurrentItemSaveJob saveJob( *d, addedItems, modifiedItems, deletedItems );
+  if ( !saveJob.exec() ) {
+    kError(5700) << "Save Sequence failed:" << saveJob->errorString();
+    emit savingError( this, saveJob->errorString() );
     return false;
   }
 
   d->mChanges.clear();
 
+  emit savingFinished( this );
   return true;
 }
 
@@ -619,7 +571,7 @@
   if ( !d->prepareSaving() )
     return false;
 
-  KJob *job = d->createSaveSequence();
+  Akonadi::Job *job = d->createSaveSequence();
   if ( job == 0 )
     return false;
 
@@ -1420,7 +1372,7 @@
   return true;
 }
 
-static KJob *createSaveSequence( const UidToCollectionMapper &mapper,
+static Akonadi::Job *createSaveSequence( const UidToCollectionMapper &mapper,
     const Item::List &addedItems, const Item::List &modifiedItems, const Item::List &deletedItems )
 {
   TransactionSequence *sequence = new TransactionSequence();
@@ -1482,7 +1434,7 @@
   return sequence;
 }
 
-KJob *ResourceAkonadi::Private::createSaveSequence() const
+Akonadi::Job *ResourceAkonadi::Private::createSaveSequence() const
 {
   Item::List addedItems;
   Item::List modifiedItems;
@@ -1574,15 +1526,14 @@
 bool ResourceAkonadi::Private::reloadSubResource( SubResource *subResource, bool &changed )
 {
   changed = false;
-  mThreadJobContext.clear();
-  QFuture<bool> threadResult =
-    QtConcurrent::run( &mThreadJobContext, &ThreadJobContext::fetchItems, subResource->mCollection );
-  if ( !threadResult.result() ) {
-    emit mParent->loadingError( mParent, mThreadJobContext.mJobError );
+
+  ConcurrentItemFetchJob fetchJob( subResource->mCollection );
+  if ( !fetchJob.exec() ) {
+    emit mParent->loadingError( mParent, fetchJob->errorString() );
     return false;
   }
 
-  Item::List items = mThreadJobContext.mItems;
+  Item::List items = fetchJob->items();
 
   const QString collectionUrl = subResource->mCollection.url().url();
 
Index: kresources/akonadi/kabc/CMakeLists.txt
===================================================================
--- kresources/akonadi/kabc/CMakeLists.txt	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/akonadi/kabc/CMakeLists.txt	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -3,7 +3,7 @@
 
 ########### next target ###############
 
-set(kabc_akonadi_SRCS resourceakonadiplugin.cpp resourceakonadi.cpp resourceakonadiconfig.cpp)
+set(kabc_akonadi_SRCS resourceakonadiplugin.cpp resourceakonadi.cpp resourceakonadiconfig.cpp ../shared/concurrentjobs.cpp)
 
 
 kde4_add_plugin(kabc_akonadi ${kabc_akonadi_SRCS})
Index: kresources/akonadi/kabc/akonadi.desktop
===================================================================
--- kresources/akonadi/kabc/akonadi.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/akonadi/kabc/akonadi.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Carnet d'adresses Akonadi
 Name[ga]=Leabhair Sheoltaí Akonadi
 Name[gl]=Caderno de Enderezos do Akonadi
+Name[hu]=Akonadi-címjegyzékek
 Name[it]=Rubrica indirizzi di Akonadi
 Name[ja]=Akonadi アドレス帳
 Name[km]=សៀវភៅ​អាសយដ្ឋាន Akonadi
@@ -41,6 +42,7 @@
 Comment[et]=Võimaldab kasutada Akonadi aadressiraamatukaustadesse salvestatud kontakte
 Comment[fr]=Fourni l'accès aux contacts stockés dans les dossiers du carnet d'adresses Akonadi
 Comment[gl]=Fornece acceso aos contactos almacenados nos cartafoles do caderno de enderezos do Akonadi
+Comment[hu]=Hozzáférést biztosít Akonadi-címjegyzékekben tárolt névjegyekhez
 Comment[it]=Consente l'accesso ai contatti memorizzati in cartelle di tipo rubrica di Akonadi
 Comment[ja]=Akonadi のアドレス帳フォルダに保存されている連絡先へのアクセスを提供します
 Comment[km]=ចូលដំណើរការ​ទៅ​កាន់ទំនាក់ទំនង​ដែល​បាន​ទុក​នៅ​ក្នុង​ថត​សៀវភៅ​អាសយដ្ឋាន Akonadi
Index: kresources/akonadi/shared/concurrentjobs.cpp
===================================================================
--- kresources/akonadi/shared/concurrentjobs.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 0)
+++ kresources/akonadi/shared/concurrentjobs.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -0,0 +1,146 @@
+/*
+    This file is part of kdepim.
+    Copyright (c) 2009 Kevin Krammer <kevin.krammer@gmx.at>
+
+    This library is free software; you can redistribute it and/or
+    modify it under the terms of the GNU Library General Public
+    License as published by the Free Software Foundation; either
+    version 2 of the License, or (at your option) any later version.
+
+    This library is distributed in the hope that it will be useful,
+    but WITHOUT ANY WARRANTY; without even the implied warranty of
+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+    Library General Public License for more details.
+
+    You should have received a copy of the GNU Library General Public License
+    along with this library; see the file COPYING.LIB.  If not, write to
+    the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
+    Boston, MA 02110-1301, USA.
+*/
+
+#include "concurrentjobs.h"
+
+//#include "itemsavecontext.h"
+
+#include <akonadi/itemfetchscope.h>
+
+using namespace Akonadi;
+
+ConcurrentJobBase::~ConcurrentJobBase()
+{
+}
+
+ConcurrentJobBase::JobRunner::JobRunner( ConcurrentJobBase *parent )
+  : QThread(), mParent( parent )
+{
+  Q_ASSERT( mParent != 0 );
+}
+
+void ConcurrentJobBase::JobRunner::run()
+{
+  QMutexLocker mutexLocker( &(mParent->mMutex) );
+
+  mParent->createJob();
+  Job *job = mParent->job();
+  Q_ASSERT( job != 0 );
+
+  mParent->mRunnerResult = job->exec();
+  if ( mParent->mRunnerResult ) {
+    mParent->handleSuccess();
+  } else {
+    mParent->mErrorString = job->errorString();
+  }
+
+  delete job;
+
+  mParent->mCondition.wakeAll();
+}
+
+const ConcurrentCollectionFetchJob *ConcurrentCollectionFetchJob::operator->() const
+{
+  return this;
+}
+
+Collection::List ConcurrentCollectionFetchJob::collections() const
+{
+  return mCollections;
+}
+
+void ConcurrentCollectionFetchJob::createJob()
+{
+  mJob = new CollectionFetchJob( Collection::root(), CollectionFetchJob::Recursive );
+}
+
+void ConcurrentCollectionFetchJob::handleSuccess()
+{
+  mCollections = mJob->collections();
+}
+
+ConcurrentItemFetchJob::ConcurrentItemFetchJob( const Collection &collection )
+  : ConcurrentJob<ItemFetchJob>(),
+    mCollection( collection )
+{
+}
+
+const ConcurrentItemFetchJob *ConcurrentItemFetchJob::operator->() const
+{
+  return this;
+}
+
+Item::List ConcurrentItemFetchJob::items() const
+{
+  return mItems;
+}
+
+void ConcurrentItemFetchJob::createJob()
+{
+  mJob = new ItemFetchJob( mCollection );
+  mJob->fetchScope().fetchFullPayload();
+}
+
+void ConcurrentItemFetchJob::handleSuccess()
+{
+  mItems = mJob->items();
+}
+
+ConcurrentCollectionCreateJob::ConcurrentCollectionCreateJob( const Akonadi::Collection &collection )
+  : ConcurrentJob<CollectionCreateJob>(),
+    mCollection( collection )
+{
+}
+
+const ConcurrentCollectionCreateJob *ConcurrentCollectionCreateJob::operator->() const
+{
+  return this;
+}
+
+void ConcurrentCollectionCreateJob::createJob()
+{
+  mJob = new CollectionCreateJob( mCollection );
+}
+
+void ConcurrentCollectionCreateJob::handleSuccess()
+{
+}
+
+ConcurrentCollectionDeleteJob::ConcurrentCollectionDeleteJob( const Akonadi::Collection &collection )
+  : ConcurrentJob<CollectionDeleteJob>(),
+    mCollection( collection )
+{
+}
+
+const ConcurrentCollectionDeleteJob *ConcurrentCollectionDeleteJob::operator->() const
+{
+  return this;
+}
+
+void ConcurrentCollectionDeleteJob::createJob()
+{
+  mJob = new CollectionDeleteJob( mCollection );
+}
+
+void ConcurrentCollectionDeleteJob::handleSuccess()
+{
+}
+
+// kate: space-indent on; indent-width 2; replace-tabs on;
Index: kresources/akonadi/shared/concurrentjobs.h
===================================================================
--- kresources/akonadi/shared/concurrentjobs.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 0)
+++ kresources/akonadi/shared/concurrentjobs.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -0,0 +1,178 @@
+/*
+    This file is part of kdepim.
+    Copyright (c) 2009 Kevin Krammer <kevin.krammer@gmx.at>
+
+    This library is free software; you can redistribute it and/or
+    modify it under the terms of the GNU Library General Public
+    License as published by the Free Software Foundation; either
+    version 2 of the License, or (at your option) any later version.
+
+    This library is distributed in the hope that it will be useful,
+    but WITHOUT ANY WARRANTY; without even the implied warranty of
+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+    Library General Public License for more details.
+
+    You should have received a copy of the GNU Library General Public License
+    along with this library; see the file COPYING.LIB.  If not, write to
+    the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
+    Boston, MA 02110-1301, USA.
+*/
+
+#ifndef KRES_AKONADI_CONCURRENTJOBS_H
+#define KRES_AKONADI_CONCURRENTJOBS_H
+
+//#include "itemsavejob.h"
+
+#include <akonadi/collection.h>
+#include <akonadi/collectioncreatejob.h>
+#include <akonadi/collectiondeletejob.h>
+#include <akonadi/collectionfetchjob.h>
+#include <akonadi/item.h>
+#include <akonadi/itemfetchjob.h>
+
+#include <QtCore/QMutex>
+#include <QtCore/QMutexLocker>
+#include <QtCore/QThread>
+#include <QtCore/QWaitCondition>
+
+class ConcurrentJobBase
+{
+  public:
+    virtual ~ConcurrentJobBase();
+
+    QString errorString() const
+    {
+      return mErrorString;
+    }
+
+  protected:
+    bool mRunnerResult;
+
+    QString mErrorString;
+
+    QMutex mMutex;
+    QWaitCondition mCondition;
+
+  protected:
+    virtual void createJob() = 0;
+
+    virtual void handleSuccess() = 0;
+
+    virtual Akonadi::Job *job() = 0;
+
+  private:
+    class JobRunner : public QThread
+    {
+      public:
+        JobRunner( ConcurrentJobBase *parent );
+
+      protected:
+        void run();
+
+      private:
+        ConcurrentJobBase *mParent;
+    };
+};
+
+template <class JobClass>
+class ConcurrentJob : public ConcurrentJobBase
+{
+  public:
+    ConcurrentJob() : mJob( 0 ) {}
+
+    virtual ~ConcurrentJob() {}
+
+    bool exec()
+    {
+      JobRunner *runner = new JobRunner( this );
+      QObject::connect( runner, SIGNAL( finished() ), runner, SLOT( deleteLater() ) );
+
+      QMutexLocker mutexLocker( &mMutex );
+
+      runner->start();
+
+      mCondition.wait( &mMutex );
+
+      return mRunnerResult;
+    }
+
+  protected:
+    JobClass *mJob;
+
+  protected:
+    Akonadi::Job *job()
+    {
+      return mJob;
+    }
+};
+
+class ConcurrentCollectionFetchJob : public ConcurrentJob<Akonadi::CollectionFetchJob>
+{
+  public:
+    const ConcurrentCollectionFetchJob *operator->() const;
+
+    Akonadi::Collection::List collections() const;
+
+  protected:
+    Akonadi::Collection::List mCollections;
+
+  protected:
+    void createJob();
+
+    void handleSuccess();
+};
+
+class ConcurrentItemFetchJob : public ConcurrentJob<Akonadi::ItemFetchJob>
+{
+  public:
+    ConcurrentItemFetchJob( const Akonadi::Collection &collection );
+
+    const ConcurrentItemFetchJob *operator->() const;
+
+    Akonadi::Item::List items() const;
+
+  protected:
+    const Akonadi::Collection mCollection;
+    Akonadi::Item::List mItems;
+
+  protected:
+    void createJob();
+
+    void handleSuccess();
+};
+
+class ConcurrentCollectionCreateJob : public ConcurrentJob<Akonadi::CollectionCreateJob>
+{
+  public:
+    ConcurrentCollectionCreateJob( const Akonadi::Collection &collection );
+
+    const ConcurrentCollectionCreateJob *operator->() const;
+
+  protected:
+    Akonadi::Collection mCollection;
+
+  protected:
+    void createJob();
+
+    void handleSuccess();
+};
+
+class ConcurrentCollectionDeleteJob : public ConcurrentJob<Akonadi::CollectionDeleteJob>
+{
+  public:
+    ConcurrentCollectionDeleteJob( const Akonadi::Collection &collection );
+
+    const ConcurrentCollectionDeleteJob *operator->() const;
+
+  protected:
+    Akonadi::Collection mCollection;
+
+  protected:
+    void createJob();
+
+    void handleSuccess();
+};
+
+#endif
+
+// kate: space-indent on; indent-width 2; replace-tabs on;
Index: kresources/akonadi/kcal/resourceakonadi.cpp
===================================================================
--- kresources/akonadi/kcal/resourceakonadi.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/akonadi/kcal/resourceakonadi.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -21,6 +21,8 @@
 #include "resourceakonadi.h"
 #include "resourceakonadiconfig.h"
 
+#include "../shared/concurrentjobs.h"
+
 #include "kcal/calendarlocal.h"
 #include "kabc/locknull.h"
 
@@ -28,9 +30,6 @@
 #include <akonadi/agentinstance.h>
 #include <akonadi/agentinstancemodel.h>
 #include <akonadi/collection.h>
-#include <akonadi/collectioncreatejob.h>
-#include <akonadi/collectiondeletejob.h>
-#include <akonadi/collectionfetchjob.h>
 #include <akonadi/collectionfilterproxymodel.h>
 #include <akonadi/collectionmodel.h>
 #include <akonadi/control.h>
@@ -39,7 +38,6 @@
 #include <akonadi/item.h>
 #include <akonadi/itemcreatejob.h>
 #include <akonadi/itemdeletejob.h>
-#include <akonadi/itemfetchjob.h>
 #include <akonadi/itemfetchscope.h>
 #include <akonadi/itemmodifyjob.h>
 #include <akonadi/transactionsequence.h>
@@ -50,8 +48,6 @@
 #include <kdebug.h>
 #include <kmimetype.h>
 
-#include <QtConcurrentRun>
-#include <QFuture>
 #include <QHash>
 
 #include <boost/shared_ptr.hpp>
@@ -91,81 +87,42 @@
   virtual Collection collectionForUid( const QString &uid ) const = 0;
 };
 
-static KJob *createSaveSequence( const UidToCollectionMapper &mapper,
+static Akonadi::Job *createSaveSequence( const UidToCollectionMapper &mapper,
     const Item::List &addedItems, const Item::List &modifiedItems, const Item::List &deletedItems );
 
-class ThreadJobContext
+class ConcurrentItemSaveJob : public ConcurrentJob<Akonadi::Job>
 {
   public:
-    explicit ThreadJobContext( const UidToCollectionMapper &mapper )
-      : mMapper( mapper ) {}
+    ConcurrentItemSaveJob(  const UidToCollectionMapper &mapper,
+        const Item::List &addedItems, const Item::List &modifiedItems,
+        const Item::List &deletedItems )
+      : ConcurrentJob<Akonadi::Job>(),
+        mMapper( mapper ),
+        mAddedItems( addedItems ),
+        mModifiedItems( modifiedItems ),
+        mDeletedItems( deletedItems ) {}
 
-    void clear()
+    const ConcurrentItemSaveJob *operator->() const
     {
-      mJobError.clear();
-      mCollections.clear();
-      mItems.clear();
-
-      mAddedItems.clear();
-      mModifiedItems.clear();
-      mDeletedItems.clear();
+      return this;
     }
 
-    bool fetchCollections()
-    {
-      CollectionFetchJob *job = new CollectionFetchJob( Collection::root(), CollectionFetchJob::Recursive );
+  protected:
+    const UidToCollectionMapper &mMapper;
 
-      bool jobResult = job->exec();
-      if ( jobResult )
-        mCollections = job->collections();
-      else
-        mJobError = job->errorString();
+    const Item::List mAddedItems;
+    const Item::List mModifiedItems;
+    const Item::List mDeletedItems;
 
-      delete job;
-      return jobResult;
-    }
-
-    bool fetchItems( const Collection &collection )
+  protected:
+    void createJob()
     {
-      ItemFetchJob *job = new ItemFetchJob( collection );
-      job->fetchScope().fetchFullPayload();
-
-      bool jobResult = job->exec();
-      if ( jobResult )
-        mItems = job->items();
-      else
-        mJobError = job->errorString();
-
-      delete job;
-      return jobResult;
+      mJob = createSaveSequence( mMapper, mAddedItems, mModifiedItems, mDeletedItems );
     }
 
-    bool saveChanges()
+    void handleSuccess()
     {
-      KJob *job = createSaveSequence( mMapper, mAddedItems, mModifiedItems, mDeletedItems );
-
-      bool jobResult = job->exec();
-      if ( !jobResult )
-        mJobError = job->errorString();
-
-      delete job;
-      return jobResult;
     }
-
-  public:
-    QString mJobError;
-
-    Collection::List mCollections;
-    Item::List mItems;
-
-    Item::List mAddedItems;
-    Item::List mModifiedItems;
-    Item::List mDeletedItems;
-
-  private:
-    const UidToCollectionMapper &mMapper;
-
-  private:
 };
 
 class SubResource
@@ -245,7 +202,7 @@
         mMimeVisitor( new KCalMimeTypeVisitor() ),
         mCollectionModel( 0 ), mCollectionFilterModel( 0 ),
         mAgentModel( 0 ), mAgentFilterModel( 0 ),
-        mThreadJobContext( *this ), mOpenState( Closed )
+        mOpenState( Closed )
     {
       mCalendar.registerObserver( this );
     }
@@ -299,8 +256,6 @@
     AgentInstanceModel *mAgentModel;
     AgentFilterProxyModel *mAgentFilterModel;
 
-    ThreadJobContext mThreadJobContext;
-
     AssignmentVisitor mIncidenceAssigner;
 
     enum OpenState
@@ -639,10 +594,9 @@
   // TODO should we set content mime types at all?
   collection.setContentMimeTypes( QStringList( QLatin1String( "text/calendar" ) ) );
 
-  CollectionCreateJob *job = new CollectionCreateJob( collection );
-
-  if ( !job->exec() ) {
-    kError(5800) << "Creating collection failed:" << job->errorString();
+  ConcurrentCollectionCreateJob createJob( collection );
+  if ( !createJob.exec() ) {
+    kError(5800) << "Creating collection failed:" << createJob->errorString();
     return false;
   }
 
@@ -663,10 +617,10 @@
     return false;
   }
 
-  CollectionDeleteJob *job = new CollectionDeleteJob( subResource->mCollection );
+  ConcurrentCollectionDeleteJob deleteJob( subResource->mCollection );
 
-  if ( !job->exec() ) {
-    kError(5800) << "Deleting collection failed:" << job->errorString();
+  if ( !deleteJob.exec() ) {
+    kError(5800) << "Deleting collection failed:" << deleteJob->errorString();
     return false;
   }
 
@@ -789,15 +743,13 @@
 
   // if we do not have any collection yet, fetch them explicitly
   if ( collections.isEmpty() ) {
-    d->mThreadJobContext.clear();
-    QFuture<bool> threadResult =
-      QtConcurrent::run( &(d->mThreadJobContext), &ThreadJobContext::fetchCollections );
-    if ( !threadResult.result() ) {
-      loadError( d->mThreadJobContext.mJobError );
+    ConcurrentCollectionFetchJob fetchJob;
+    if ( !fetchJob.exec() ) {
+      loadError( fetchJob->errorString() );
       return false;
     }
 
-    collections = d->mThreadJobContext.mCollections;
+    collections = fetchJob->collections();
   }
 
   bool result = true;
@@ -841,18 +793,16 @@
   if ( !d->prepareSaving() )
     return false;
 
-  d->mThreadJobContext.clear();
+  Item::List addedItems;
+  Item::List modifiedItems;
+  Item::List deletedItems;
 
-  d->createItemListsForSave( d->mThreadJobContext.mAddedItems,
-                             d->mThreadJobContext.mModifiedItems,
-                             d->mThreadJobContext.mDeletedItems );
+  d->createItemListsForSave( addedItems, modifiedItems, deletedItems );
 
-  QFuture<bool> threadResult =
-    QtConcurrent::run( &(d->mThreadJobContext), &ThreadJobContext::saveChanges );
-  if ( !threadResult.result() ) {
-    // TODO error handling
-    kError(5800) << "Save Sequence failed:" << d->mThreadJobContext.mJobError;
-    saveError( d->mThreadJobContext.mJobError );
+  ConcurrentItemSaveJob saveJob( *d, addedItems, modifiedItems, deletedItems );
+  if ( !saveJob.exec() ) {
+    kError(5800) << "Save Sequence failed:" << saveJob->errorString();
+    saveError( saveJob->errorString() );
     return false;
   }
 
@@ -903,17 +853,16 @@
     }
   }
 
-  d->mThreadJobContext.clear();
+  Item::List addedItems;
+  Item::List modifiedItems;
+  Item::List deletedItems;
 
-  d->processChange( changeIt, d->mThreadJobContext.mAddedItems,
-                    d->mThreadJobContext.mModifiedItems, d->mThreadJobContext.mDeletedItems );
+  d->processChange( changeIt, addedItems, modifiedItems, deletedItems );
 
-  QFuture<bool> threadResult =
-    QtConcurrent::run( &(d->mThreadJobContext), &ThreadJobContext::saveChanges );
-  if ( !threadResult.result() ) {
-    // TODO error handling
-    kError(5800) << "Save Sequence failed:" << d->mThreadJobContext.mJobError;
-    saveError( d->mThreadJobContext.mJobError );
+  ConcurrentItemSaveJob saveJob( *d, addedItems, modifiedItems, deletedItems );
+  if ( !saveJob.exec() ) {
+    kError(5800) << "Save Sequence failed:" << saveJob->errorString();
+    saveError( saveJob->errorString() );
     return false;
   }
 
@@ -1465,7 +1414,7 @@
   return true;
 }
 
-static KJob *createSaveSequence( const UidToCollectionMapper &mapper,
+static Akonadi::Job *createSaveSequence( const UidToCollectionMapper &mapper,
     const Item::List &addedItems, const Item::List &modifiedItems, const Item::List &deletedItems )
 {
   TransactionSequence *sequence = new TransactionSequence();
@@ -1632,15 +1581,13 @@
 {
   changed = false;
 
-  mThreadJobContext.clear();
-  QFuture<bool> threadResult =
-    QtConcurrent::run( &mThreadJobContext, &ThreadJobContext::fetchItems, subResource->mCollection );
-  if ( !threadResult.result() ) {
-    mParent->loadError( mThreadJobContext.mJobError );
+  ConcurrentItemFetchJob fetchJob( subResource->mCollection );
+  if ( !fetchJob.exec() ) {
+    mParent->loadError( fetchJob->errorString() );
     return false;
   }
 
-  Item::List items = mThreadJobContext.mItems;
+  Item::List items = fetchJob->items();
 
   const QString collectionUrl = subResource->mCollection.url().url();
 
Index: kresources/akonadi/kcal/CMakeLists.txt
===================================================================
--- kresources/akonadi/kcal/CMakeLists.txt	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/akonadi/kcal/CMakeLists.txt	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -4,7 +4,7 @@
 
 ########### next target ###############
 
-set(kcal_akonadi_SRCS resourceakonadiplugin.cpp resourceakonadi.cpp resourceakonadiconfig.cpp)
+set(kcal_akonadi_SRCS resourceakonadiplugin.cpp resourceakonadi.cpp resourceakonadiconfig.cpp ../shared/concurrentjobs.cpp)
 
 
 kde4_add_plugin(kcal_akonadi ${kcal_akonadi_SRCS})
Index: kresources/akonadi/kcal/akonadi.desktop
===================================================================
--- kresources/akonadi/kcal/akonadi.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/akonadi/kcal/akonadi.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -12,6 +12,7 @@
 Comment[et]=Võimaldab kasutada Akonadi kalendrikaustadesse salvestatud kalendreid
 Comment[fr]=Fourni l'accès aux calendriers stockés dans les dossiers de calendrier Akonadi
 Comment[gl]=Permite acceder aos calendarios almacenados nos cartafoles de calendario do Akonadi
+Comment[hu]=Hozzáférést biztosít Akonadi-naptárak tartalmához
 Comment[it]=Consente l'accesso alle voci di calendario memorizzate in cartelle di tipo calendario di Akonadi
 Comment[ja]=Akonadi のカレンダーフォルダに保存されているカレンダーへのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ប្រតិទិន​ដែល​បាន​រក្សាទុក​នៅ​ក្នុង​ថត​ប្រតិទិន Akonadi
@@ -25,7 +26,7 @@
 Comment[pl]=Zapewnia dostęp do kalendarzy przechowywanych w katalogach kalendarzy Akonadi
 Comment[pt]=Oferece o acesso aos calendários guardados nas pastas de calendários do Akonadi
 Comment[pt_BR]=Fornece acesso aos calendários armazenados nas pastas de calendários do Akonadi
-Comment[ru]=Доступ к папкам календарей Akonadi
+Comment[ru]=Доступ к папкам органайзера Akonadi
 Comment[sl]=Omogoča dostop do koledarjev, shranjenih v Akonadijevih mapah s koledarji
 Comment[sv]=Ger tillgång till kalendrar lagrade i Akonadi-kalenderkataloger
 Comment[tr]=Akonadi takvim dizinlerindeki takvimlere erişim sağlar
Index: kresources/groupware/kabc_groupware.desktop
===================================================================
--- kresources/groupware/kabc_groupware.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/groupware/kabc_groupware.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -37,7 +37,7 @@
 Name[pt]=Servidor de Groupware
 Name[pt_BR]=Servidor Groupware
 Name[ro]=Server Groupware
-Name[ru]=Сервер Groupware
+Name[ru]=Groupware-cервер
 Name[sl]=Strežnik za skupinsko delo
 Name[sv]=Grupprogramserver
 Name[ta]=குழுவாரி சேவகன்
@@ -56,6 +56,7 @@
 Comment[et]=Võimaldab kasutada grupitöö serverisse salvestatud kontakte.
 Comment[fr]=Fourni l'accès aux contacts stockés un serveur collaboratif.
 Comment[gl]=Permite acceder aos contactos almacenados nun servidor de Groupware.
+Comment[hu]=Hozzáférést biztosít Groupware-kiszolgálón tárolt névjegyekhez.
 Comment[it]=Consente l'accesso ai contatti memorizzati su un server Groupware.
 Comment[ja]=グループウェアサーバに保存されている連絡先へのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ទំនាក់ទំនង​ដែល​បាន​រក្សាទុក​នៅលើ​ម៉ាស៊ីន​បម្រើ Groupware ។
@@ -68,7 +69,7 @@
 Comment[pl]=Zapewnia dostęp do wizytówek przechowywanych na serwerach pracy grupowej.
 Comment[pt]=Oferece o acesso aos contactos guardados num servidor de Groupware.
 Comment[pt_BR]=Fornece acesso aos contatos armazenados em um servidor de Groupware.
-Comment[ru]=Доступ к контактам на сервере Groupware.
+Comment[ru]=Доступ к контактам на сервере коллективной работы.
 Comment[sl]=Omogoča dostop do stikov, shranjenih na strežniku Groupware.
 Comment[sv]=Ger tillgång till kontakter lagrade på en grupprogramserver.
 Comment[tr]=Groupware sunucusu üzerindeki kişilere erişim sağlar.
Index: kresources/groupware/kcal_groupware.desktop
===================================================================
--- kresources/groupware/kcal_groupware.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kresources/groupware/kcal_groupware.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -37,7 +37,7 @@
 Name[pt]=Servidor de Groupware
 Name[pt_BR]=Servidor Groupware
 Name[ro]=Server Groupware
-Name[ru]=Сервер Groupware
+Name[ru]=Groupware-cервер
 Name[sl]=Strežnik za skupinsko delo
 Name[sv]=Grupprogramserver
 Name[ta]=குழுவாரி சேவகன்
Index: kmail/folderstorage.h
===================================================================
--- kmail/folderstorage.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/folderstorage.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -638,7 +638,7 @@
   /** number of unread messages, -1 if not yet set */
   int mUnreadMsgs, mGuessedUnreadMsgs;
   int mTotalMsgs;
-  qint64 mSize;
+  mutable qint64 mCachedSize;
   bool mWriteConfigEnabled :1;
   /** sven: true if on destruct folder needs to be compacted. */
   bool needsCompact :1;
Index: kmail/kmmainwin.cpp
===================================================================
--- kmail/kmmainwin.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmmainwin.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -181,6 +181,25 @@
 }
 
 //-----------------------------------------------------------------------------
+bool KMMainWin::restoreDockedState( int n )
+{
+  // Default restore behavior is to show the window once it is restored.
+  // Override this if the main window was hidden in the system tray
+  // when the session was saved.
+  KConfigGroup config( kapp->sessionConfig(), QString::number( n ) );
+  bool show = !config.readEntry ("docked", false );
+
+  return KMainWindow::restore ( n, show );
+}
+
+void KMMainWin::saveProperties( KConfigGroup &config )
+{
+  // This is called by the session manager on log-off
+  // Save the shown/hidden status so we can restore to the same state.
+  KMainWindow::saveProperties( config );
+  config.writeEntry( "docked", isHidden() );
+}
+
 bool KMMainWin::queryClose()
 {
   if ( kmkernel->shuttingDown() || kapp->sessionSaving() || mReallyClose )
Index: kmail/managesievescriptsdialog_p.h
===================================================================
--- kmail/managesievescriptsdialog_p.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/managesievescriptsdialog_p.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -15,7 +15,8 @@
 
   QString script() const { return mTextEdit->toPlainText(); }
   void setScript( const QString & script ) { mTextEdit->setText( script ); }
-
+private slots:
+  void slotTextChanged();
 private:
   KTextEdit * mTextEdit;
 };
Index: kmail/kmailicalifaceimpl.cpp
===================================================================
--- kmail/kmailicalifaceimpl.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmailicalifaceimpl.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -713,7 +713,8 @@
       QStringList remainder(parts);
       remainder.pop_front();
       remainder.pop_front();
-      if ( dimapAccountCount() > 1 ) {
+      if ( dimapAccountCount() > 1 && folder && folder->storage() &&
+           static_cast<const KMFolderCachedImap*>( folder->storage() )->account() ) {
         label = i18n( "My %1 (%2)", remainder.join( QString::fromLatin1("/") ),
                       static_cast<const KMFolderCachedImap*>( folder->storage() )->account()->name() );
       } else {
Index: kmail/dbusmail.desktop
===================================================================
--- kmail/dbusmail.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/dbusmail.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -15,6 +15,7 @@
 Comment[fr]=Programme de messagerie avec une interface D-Bus
 Comment[ga]=Clár ríomhphoist le comhéadan DBUS
 Comment[gl]=Programa de correo electrónico cunha interface DBUS
+Comment[hu]=Levelezőprogram D-Bus-felülettel
 Comment[it]=Programma di posta con un'interfaccia D-Bus
 Comment[ja]=D-Bus インターフェースを持つメールクライアント
 Comment[kk]=DBUS интерфейсті пошта бағдарламасы
Index: kmail/messagelistview/storagemodel.cpp
===================================================================
--- kmail/messagelistview/storagemodel.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/messagelistview/storagemodel.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -287,7 +287,8 @@
     receiver = unknown;
 
   mi->initialSetup(
-      msg->date(), msg->msgSize(),
+      msg->date(),
+      mFolder->folderType() == KMFolderTypeImap ? msg->msgSizeServer() : msg->msgSize(),
       sender, receiver,
       bUseReceiver ? receiver : sender
     );
Index: kmail/kmmainwin.h
===================================================================
--- kmail/kmmainwin.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmmainwin.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -44,6 +44,11 @@
   StatusbarProgressWidget* progressWidget() const { return mLittleProgress; }
   ProgressDialog* progressDialog() const { return mProgressDialog; }
 
+  /// Same as KMMainWin::restore(), except that it also restores the docked state,
+  /// which we have saved in saveProperties().
+  /// TODO: KDE5: Move to kdelibs, see http://reviewboard.kde.org/r/504
+  bool restoreDockedState( int number );
+
 public slots:
   void displayStatusMsg(const QString&);
   void slotEditToolbars();
@@ -51,6 +56,10 @@
   void setupStatusBar();
 
 protected:
+
+  /// Reimplemented to save the docked state
+  virtual void saveProperties( KConfigGroup & );
+
   virtual bool queryClose ();
 
 protected slots:
Index: kmail/kmfoldermaildir.cpp
===================================================================
--- kmail/kmfoldermaildir.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmfoldermaildir.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -434,7 +434,7 @@
     }
   }
   ++mTotalMsgs;
-  mSize = -1;
+  mCachedSize = -1;
 
   if ( aMsg->attachmentState() == KMMsgAttachmentUnknown &&
        aMsg->readyToShow() )
@@ -1076,7 +1076,7 @@
   KIO::DirectorySizeJob * dirsize = dynamic_cast<KIO::DirectorySizeJob*>( job );
   if ( dirsize && !dirsize->error() )
   {
-    mSize = dirsize->totalSize();
+    mCachedSize = dirsize->totalSize();
     //kDebug(5006) << << "DirectorySizeJob completed. Folder"
     //             << location() << "has size" << mSize;
     emit folderSizeChanged();
Index: kmail/kmreadermainwin.cpp
===================================================================
--- kmail/kmreadermainwin.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmreadermainwin.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -388,7 +388,7 @@
   mUrl = aUrl;
   mMsg = &aMsg;
   bool urlMenuAdded = false;
-
+  bool copyAdded = false;
   if ( !aUrl.isEmpty() ) {
     if ( aUrl.protocol() == "mailto" ) {
       // popup on a mailto URL
@@ -408,6 +408,7 @@
         menu->addAction( mReaderWin->openAddrBookAction() );
       }
       menu->addAction( mReaderWin->copyAction() );
+      copyAdded = true;
     } else {
       // popup on a not-mailto URL
       menu->addAction( mReaderWin->urlOpenAction() );
@@ -423,8 +424,8 @@
     }
     menu->addAction( mMsgActions->replyMenu() );
     menu->addSeparator();
-
-    menu->addAction( mReaderWin->copyAction() );
+    if( !copyAdded )
+      menu->addAction( mReaderWin->copyAction() );
     menu->addAction( mReaderWin->selectAllAction() );
   } else if ( !urlMenuAdded ) {
     // popup somewhere else (i.e., not a URL) on the message
Index: kmail/managesievescriptsdialog.h
===================================================================
--- kmail/managesievescriptsdialog.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/managesievescriptsdialog.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -34,7 +34,6 @@
   void slotPutResult( KMail::SieveJob *, bool );
   void slotSieveEditorOkClicked();
   void slotSieveEditorCancelClicked();
-
 private:
   void killAllJobs();
   void changeActiveScript( Q3CheckListItem * );
Index: kmail/kmpopfiltercnfrmdlg.cpp
===================================================================
--- kmail/kmpopfiltercnfrmdlg.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmpopfiltercnfrmdlg.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -309,14 +309,14 @@
   mainLayout->setMargin( 0 );
 
   QLabel *infoLabel = new QLabel(
-            i18nc( "@info", "<title>Messages to filter found on POP Account: <emphasis>%1</emphasis></title>"
+            i18nc( "@info/plain", "<title>Messages to filter found on POP Account: <emphasis>%1</emphasis></title>"
                   "<para>The messages shown exceed the maximum size limit you defined "
                   "for this account.</para><para>You can select what you want to do "
                   "with them by checking the appropriate button.</para>",
                   account ), mainWidget );
   mainLayout->addWidget( infoLabel );
 
-  QGroupBox *upperBox = new QGroupBox(i18nc( "@info", "Messages Exceeding Size"), mainWidget );
+  QGroupBox *upperBox = new QGroupBox(i18nc( "@title:group", "Messages Exceeding Size"), mainWidget );
   QVBoxLayout *upperBoxLayout = new QVBoxLayout( upperBox );
   upperBox->hide();
   KMPopHeadersView *upperHeadersView = new KMPopHeadersView( upperBox, this );
Index: kmail/kmail_config_composer.desktop
===================================================================
--- kmail/kmail_config_composer.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmail_config_composer.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -76,6 +76,7 @@
 Comment[et]=Kirjakoostaja seadistused
 Comment[fr]=Configuration de l'éditeur de messages
 Comment[gl]=Configuracións do Compositor de Mensaxes
+Comment[hu]=Az üzenetszerkesztő beállításai
 Comment[it]=Impostazioni compositore messaggi
 Comment[ja]=メール作成の設定
 Comment[km]=ការ​កំណត់​កម្មវិធី​តែង​សារ
Index: kmail/searchwindow.cpp
===================================================================
--- kmail/searchwindow.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/searchwindow.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -464,6 +464,9 @@
   mFetchingInProgress = 0;
 
   mSearchFolderOpenBtn->setEnabled( true );
+  if ( mSearchFolderEdt->text().isEmpty() ) {
+    mSearchFolderEdt->setText( i18n("Last Search") );
+  }
   enableButton( User1, false );
   enableButton( User2, true );
 
@@ -476,9 +479,6 @@
   // If we haven't openend an existing search folder, find or create one.
   if ( !mFolder ) {
     KMFolderMgr *mgr = kmkernel->searchFolderMgr();
-    if ( mSearchFolderEdt->text().isEmpty() ) {
-      mSearchFolderEdt->setText( i18n("Last Search") );
-    }
     QString baseName = mSearchFolderEdt->text();
     QString fullName = baseName;
     int count = 0;
@@ -637,7 +637,7 @@
     mSearchFolderOpenBtn->setEnabled( false );
   } else {
     mRenameTimer.stop();
-    mSearchFolderOpenBtn->setEnabled( true );
+    mSearchFolderOpenBtn->setEnabled( !s.isEmpty() );
   }
 }
 
Index: kmail/dbusimap.desktop
===================================================================
--- kmail/dbusimap.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/dbusimap.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -15,6 +15,7 @@
 Comment[fr]=Programme de messagerie avec une interface D-Bus
 Comment[ga]=Clár ríomhphoist le comhéadan DBUS
 Comment[gl]=Programa de correo electrónico cunha interface DBUS
+Comment[hu]=Levelezőprogram D-Bus-felülettel
 Comment[it]=Programma di posta con un'interfaccia D-Bus
 Comment[ja]=D-Bus インターフェースを持つメールクライアント
 Comment[kk]=DBUS интерфейсті пошта бағдарламасы
Index: kmail/templatesconfiguration_kfg.kcfg
===================================================================
--- kmail/templatesconfiguration_kfg.kcfg	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/templatesconfiguration_kfg.kcfg	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 
   <group name="Templates #$(folder)">
     <entry name="UseCustomTemplates" type="Bool" key="UseCustomTemplates">
+      <default>false</default>
     </entry>
     <entry name="TemplateNewMessage" type="String" key="TemplateNewMessage">
     </entry>
Index: kmail/messageactions.cpp
===================================================================
--- kmail/messageactions.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/messageactions.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -168,7 +168,12 @@
 
 void MessageActions::updateActions()
 {
-  const bool singleMsg = (mCurrentMessage != 0);
+  bool singleMsg = (mCurrentMessage != 0);
+  if ( mCurrentMessage && mCurrentMessage->parent() ) {
+    if ( mCurrentMessage->parent()->isSent() ||
+         mCurrentMessage->parent()->isTemplates())
+      singleMsg = false;
+  }
   const bool multiVisible = mVisibleSernums.count() > 0 || mCurrentMessage;
   const bool flagsAvailable = GlobalSettings::self()->allowLocalFlags() ||
       !((mCurrentMessage && mCurrentMessage->parent()) ? mCurrentMessage->parent()->isReadOnly() : true);
Index: kmail/managesievescriptsdialog.cpp
===================================================================
--- kmail/managesievescriptsdialog.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/managesievescriptsdialog.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -181,7 +181,8 @@
     // top-levels:
     menu.addAction( i18n( "New Script..." ), this, SLOT(slotNewScript()) );
   }
-  menu.exec( p );
+  if ( !menu.actions().isEmpty() )
+    menu.exec( p );
   mContextMenuItem = 0;
 }
 
@@ -253,7 +254,6 @@
                                    KStandardGuiItem::del() )
        != KMessageBox::Continue )
     return;
-
   SieveJob * job = SieveJob::del( u );
   connect( job, SIGNAL(result(KMail::SieveJob*,bool,const QString&,bool)),
            this, SLOT(slotRefresh()) );
@@ -321,16 +321,22 @@
   vlay->setSpacing( spacingHint() );
   vlay->setMargin( 0 );
   mTextEdit = new KTextEdit( frame);
+  mTextEdit->setFocus();
   vlay->addWidget( mTextEdit );
   mTextEdit->setAcceptRichText( false );
   mTextEdit->setWordWrapMode ( QTextOption::NoWrap );
   mTextEdit->setFont( KGlobalSettings::fixedFont() );
-
+  connect( mTextEdit, SIGNAL( textChanged () ), SLOT( slotTextChanged() ) );
   resize( 3 * sizeHint() );
 }
 
 KMail::SieveEditor::~SieveEditor() {}
 
+void KMail::SieveEditor::slotTextChanged()
+{
+  enableButtonOk( !script().isEmpty() );
+}
+
 void KMail::ManageSieveScriptsDialog::slotGetResult( KMail::SieveJob *, bool success, const QString & script, bool isActive ) {
   if ( !success )
     return;
@@ -357,6 +363,7 @@
 void KMail::ManageSieveScriptsDialog::slotSieveEditorCancelClicked() {
   mSieveEditor->deleteLater(); mSieveEditor = 0;
   mCurrentURL = KUrl();
+  slotRefresh();
 }
 
 void KMail::ManageSieveScriptsDialog::slotPutResult( KMail::SieveJob *, bool success ) {
Index: kmail/kmkernel.cpp
===================================================================
--- kmail/kmkernel.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmkernel.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -1583,7 +1583,7 @@
     while (KMMainWin::canBeRestored(n)){
       //only restore main windows! (Matthias);
       if (KMMainWin::classNameOfToplevel(n) == "KMMainWin")
-        (new KMMainWin)->restore(n);
+        (new KMMainWin)->restoreDockedState(n);
       n++;
     }
     return true; // we were restored by SM
Index: kmail/filterlogdlg.cpp
===================================================================
--- kmail/filterlogdlg.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/filterlogdlg.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -67,16 +67,14 @@
   mTextEdit = new KTextEdit( page );
   mTextEdit->setReadOnly( true );
   mTextEdit->setLineWrapMode ( KTextEdit::NoWrap );
-  mTextEdit->setAcceptRichText( false );
 
   QString text;
-  QStringList logEntries = FilterLog::instance()->getLogEntries();
-  for ( QStringList::Iterator it = logEntries.begin();
-        it != logEntries.end(); ++it )
+  const QStringList logEntries = FilterLog::instance()->getLogEntries();
+  for ( QStringList::ConstIterator it = logEntries.constBegin();
+        it != logEntries.constEnd(); ++it )
   {
-    text+=*it;
+      mTextEdit->append(*it);
   }
-  mTextEdit->setText(text);
 
   mLogActiveBox = new QCheckBox( i18n("&Log filter activities"), page );
   mLogActiveBox->setChecked( FilterLog::instance()->isLogging() );
Index: kmail/kmpopheaders.cpp
===================================================================
--- kmail/kmpopheaders.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmpopheaders.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -31,8 +31,7 @@
 
 KMPopHeaders::~KMPopHeaders()
 {
-  if ( mHeader )
-    delete mHeader;
+  delete mHeader;
 }
 
 KMPopHeaders::KMPopHeaders( const QByteArray & id, const QByteArray & uid,
Index: kmail/kmmainwidget.cpp
===================================================================
--- kmail/kmmainwidget.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmmainwidget.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -792,6 +792,7 @@
   QVBoxLayout *vboxlayout = new QVBoxLayout;
   vboxlayout->setMargin(0);
   mFolderQuickSearch = new KTreeWidgetSearchLine( mSearchAndTree );
+  mFolderQuickSearch->setClickMessage( i18n( "Search" ) );
   vboxlayout->addWidget( mFolderQuickSearch );
   mSearchAndTree->setLayout( vboxlayout );
 
@@ -2510,7 +2511,7 @@
 //-----------------------------------------------------------------------------
 void KMMainWidget::slotJumpToFolder()
 {
-  KMail::FolderSelectionDialog dlg( this, i18n("Jump to Folder"), true );
+  KMail::FolderSelectionDialog dlg( this, i18n("Jump to Folder"), false );
   KMFolder* dest;
 
   if (!dlg.exec()) return;
@@ -4442,7 +4443,7 @@
   mPreferHtmlAction->setChecked( mHtmlPref ? !mFolderHtmlPref : mFolderHtmlPref );
   mPreferHtmlLoadExtAction->setChecked( mHtmlLoadExtPref ? !mFolderHtmlLoadExtPref : mFolderHtmlLoadExtPref );
 
-  mNewFolderAction->setEnabled( !multiFolder );
+  mNewFolderAction->setEnabled( !multiFolder && ( mFolder && mFolder->folderType() != KMFolderTypeSearch) );
   mRemoveDuplicatesAction->setEnabled( !multiFolder && mFolder && mFolder->canDeleteMessages() );
   mFolderShortCutCommandAction->setEnabled( !multiFolder );
 }
@@ -5008,6 +5009,7 @@
 
   actionCollection()->action("check_mail")->setEnabled( actList.size() > 0 );
   actionCollection()->action("check_mail_in")->setEnabled( actList.size() > 0 );
+  actionCollection()->action("favorite_check_mail")->setEnabled( actList.size() > 0 );
 }
 
 //-----------------------------------------------------------------------------
Index: kmail/recipientseditor.h
===================================================================
--- kmail/recipientseditor.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/recipientseditor.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -158,6 +158,7 @@
     void analyzeLine( const QString & );
     void slotFocusUp();
     void slotFocusDown();
+    void slotEditingFinished();
     void slotPropagateDeletion();
     void slotTypeModified();
 
Index: kmail/kmfolderdialog.cpp
===================================================================
--- kmail/kmfolderdialog.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmfolderdialog.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -126,7 +126,7 @@
   addTab( tab );
 
   // Don't add template tab for special folders
-  if (!mFolder->isSystemFolder() || mFolder->isMainInbox()) 
+  if (!mFolder->isSystemFolder() || mFolder->isMainInbox())
   {
     box = new KVBox( this );
     addPage( box, i18n("Templates") );
@@ -158,7 +158,7 @@
   for ( int i = 0 ; i < mTabs.count() ; ++i )
     mTabs[i]->load();
   connect( this, SIGNAL( okClicked() ), SLOT( slotOk() ) );
-  connect( this, SIGNAL( applyClicked() ), SLOT( slotApply() ) ); 
+  connect( this, SIGNAL( applyClicked() ), SLOT( slotApply() ) );
 }
 
 void KMFolderDialog::addTab( FolderDialogTab* tab )
@@ -267,12 +267,7 @@
                                                  QWidget* parent, const char* name )
   : FolderDialogTab( parent, name ), mDlg( dlg )
 {
-
-
-  mIsLocalSystemFolder = mDlg->folder()->isSystemFolder() &&
-       mDlg->folder()->folderType() != KMFolderTypeImap &&
-       mDlg->folder()->folderType() != KMFolderTypeCachedImap;
-
+  mIsLocalSystemFolder = mDlg->folder()->isSystemFolder();
   QLabel *label;
 
   QVBoxLayout *topLayout = new QVBoxLayout( this );
@@ -453,7 +448,6 @@
         "automatically. Identities can be set up in the main configuration "
         "dialog. (Settings -> Configure KMail)") );
 
-
   // sender or receiver column?
   ++row;
   QString tip = i18n("Show Sender/Receiver Column in List of Messages");
@@ -520,7 +514,7 @@
     mIncidencesForComboBox->addItem( i18n( "Nobody" ) );
     mIncidencesForComboBox->addItem( i18n( "Admins of This Folder" ) );
     mIncidencesForComboBox->addItem( i18n( "All Readers of This Folder" ) );
-    const QString whatsThisForMyOwnFolders = 
+    const QString whatsThisForMyOwnFolders =
       i18n( "This setting defines which users sharing "
           "this folder should get \"busy\" periods in their freebusy lists "
           "and should see the alarms for the events or tasks in this folder. "
@@ -536,7 +530,7 @@
           "since it is not known who will go to those events." );
 
     mIncidencesForComboBox->setWhatsThis( whatsThisForMyOwnFolders );
- 
+
     ++row;
     const QString whatsThisForReadOnlyFolders =
       i18n( "This setting allows you to disable alarms for folders shared by "
@@ -709,7 +703,7 @@
     if ( folder->folderType() == KMFolderTypeCachedImap ) {
       KMFolderCachedImap* dimap = static_cast<KMFolderCachedImap *>( mDlg->folder()->storage() );
       if ( mIncidencesForComboBox ) {
-        KMFolderCachedImap::IncidencesFor incfor = 
+        KMFolderCachedImap::IncidencesFor incfor =
                static_cast<KMFolderCachedImap::IncidencesFor>( mIncidencesForComboBox->currentIndex() );
         if ( dimap->incidencesFor() != incfor ) {
           dimap->setIncidencesFor( incfor );
@@ -757,11 +751,8 @@
                                                      QWidget *parent )
   : FolderDialogTab( parent, 0 ), mDlg( dlg )
 {
+  mIsLocalSystemFolder = mDlg->folder()->isSystemFolder();
 
-  mIsLocalSystemFolder = mDlg->folder()->isSystemFolder() &&
-       mDlg->folder()->folderType() != KMFolderTypeImap &&
-       mDlg->folder()->folderType() != KMFolderTypeCachedImap;
-
   QVBoxLayout *topLayout = new QVBoxLayout( this );
   topLayout->setMargin( 0 );
   topLayout->setSpacing( KDialog::spacingHint() );
Index: kmail/kmsearchpatternedit.cpp
===================================================================
--- kmail/kmsearchpatternedit.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmsearchpatternedit.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -41,8 +41,15 @@
 //       you change the following i18n-ized strings!
 // Note: The index of the values in the following array has to correspond to
 //       the value of the entries in the enum in KMSearchRuleWidget.
+
+#undef I18N_NOOP
+#define I18N_NOOP(t) 0, t
+#undef I18N_NOOP2
+#define I18N_NOOP2(c,t) c, t
+
 static const struct {
   const char *internalName;
+  const char *context;
   const char *displayName;
 } SpecialRuleFields[] = {
   { "<message>",     I18N_NOOP( "Complete Message" )       },
@@ -214,7 +221,7 @@
 QByteArray KMSearchRuleWidget::ruleFieldToEnglish( const QString & i18nVal )
 {
   for ( int i = 0; i < SpecialRuleFieldsCount; ++i ) {
-    if ( i18nVal == i18n( SpecialRuleFields[i].displayName ) )
+    if ( i18nVal == i18nc( SpecialRuleFields[i].context, SpecialRuleFields[i].displayName ) )
       return SpecialRuleFields[i].internalName;
   }
   return i18nVal.toLatin1();
@@ -223,7 +230,7 @@
 int KMSearchRuleWidget::ruleFieldToId( const QString & i18nVal )
 {
   for ( int i = 0; i < SpecialRuleFieldsCount; ++i ) {
-    if ( i18nVal == i18n( SpecialRuleFields[i].displayName ) )
+    if ( i18nVal == i18nc( SpecialRuleFields[i].context, SpecialRuleFields[i].displayName ) )
       return i;
   }
   return -1; // no pseudo header
@@ -233,7 +240,7 @@
 {
   for ( int i = 0; i < SpecialRuleFieldsCount; ++i ) {
     if ( internal == SpecialRuleFields[i].internalName )
-      return i18n(SpecialRuleFields[i].displayName);
+      return i18nc(SpecialRuleFields[i].context, SpecialRuleFields[i].displayName);
   }
   return internal.toLatin1();
 }
@@ -260,18 +267,18 @@
   mFilterFieldList.clear();
   mFilterFieldList.append(""); // empty entry for user input
   if( !headersOnly ) {
-    mFilterFieldList.append( i18n( SpecialRuleFields[Message].displayName ) );
-    mFilterFieldList.append( i18n( SpecialRuleFields[Body].displayName ) );
+    mFilterFieldList.append( i18nc( SpecialRuleFields[Message].context, SpecialRuleFields[Message].displayName ) );
+    mFilterFieldList.append( i18nc( SpecialRuleFields[Body].context, SpecialRuleFields[Body].displayName ) );
   }
-  mFilterFieldList.append( i18n( SpecialRuleFields[AnyHeader].displayName ) );
-  mFilterFieldList.append( i18n( SpecialRuleFields[Recipients].displayName ) );
-  mFilterFieldList.append( i18n( SpecialRuleFields[Size].displayName ) );
+  mFilterFieldList.append( i18nc( SpecialRuleFields[AnyHeader].context, SpecialRuleFields[AnyHeader].displayName ) );
+  mFilterFieldList.append( i18nc( SpecialRuleFields[Recipients].context, SpecialRuleFields[Recipients].displayName ) );
+  mFilterFieldList.append( i18nc( SpecialRuleFields[Size].context, SpecialRuleFields[Size].displayName ) );
   if ( !absoluteDates )
-    mFilterFieldList.append( i18n( SpecialRuleFields[AgeInDays].displayName ) );
-  mFilterFieldList.append( i18n( SpecialRuleFields[Subject].displayName ) );
-  mFilterFieldList.append( i18n( SpecialRuleFields[From].displayName ) );
-  mFilterFieldList.append( i18n( SpecialRuleFields[To].displayName ) );
-  mFilterFieldList.append( i18n( SpecialRuleFields[CC].displayName ) );
+    mFilterFieldList.append( i18nc( SpecialRuleFields[AgeInDays].context, SpecialRuleFields[AgeInDays].displayName ) );
+  mFilterFieldList.append( i18nc( SpecialRuleFields[Subject].context, SpecialRuleFields[Subject].displayName ) );
+  mFilterFieldList.append( i18nc( SpecialRuleFields[From].context, SpecialRuleFields[From].displayName ) );
+  mFilterFieldList.append( i18nc( SpecialRuleFields[To].context, SpecialRuleFields[To].displayName ) );
+  mFilterFieldList.append( i18nc( SpecialRuleFields[CC].context, SpecialRuleFields[CC].displayName ) );
 
   // these others only represent message headers and you can add to
   // them as you like
Index: kmail/kmcomposewin.cpp
===================================================================
--- kmail/kmcomposewin.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmcomposewin.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -3265,6 +3265,7 @@
 //-----------------------------------------------------------------------------
 void KMComposeWin::setEncryption( bool encrypt, bool setByUser )
 {
+  bool wasModified = isModified();
   if ( setByUser ) {
     setModified( true );
   }
@@ -3284,6 +3285,7 @@
                                "in the identity configuration.</p>"
                                "</qt>"),
                           i18n("Undefined Encryption Key") );
+      setModified( wasModified );
     }
     encrypt = false;
   }
@@ -3320,6 +3322,7 @@
 //-----------------------------------------------------------------------------
 void KMComposeWin::setSigning( bool sign, bool setByUser )
 {
+  bool wasModified = isModified();
   if ( setByUser ) {
     setModified( true );
   }
@@ -3339,6 +3342,7 @@
                                "in the identity configuration.</p>"
                                "</qt>"),
                           i18n("Undefined Signing Key") );
+      setModified( wasModified );
     }
     sign = false;
   }
Index: kmail/kmail_view.desktop
===================================================================
--- kmail/kmail_view.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmail_view.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[et]=KMaili vaade
 Name[ga]=Amharc KMail
 Name[gl]=Vista KMail 
+Name[hu]=KMail-nézet
 Name[it]=Vista KMail
 Name[ja]=KMail ビュー
 Name[km]=ទិដ្ឋភាព KMail
Index: kmail/templatesinsertcommand.cpp
===================================================================
--- kmail/templatesinsertcommand.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/templatesinsertcommand.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -33,9 +33,7 @@
   : QPushButton( parent )
 {
   setObjectName( name );
-  setText( i18n( "&Insert Command..." ) );
-  connect( this, SIGNAL( clicked() ),
-           this, SLOT( slotClicked() ) );
+  setText( i18n( "&Insert Command" ) );
 
   KAction *action;
   KActionMenu *menu;
@@ -44,7 +42,7 @@
   connect( mapper, SIGNAL( mapped(int) ),
            this, SLOT( slotMapped(int) ) );
 
-  mMenu = new KActionMenu( i18n( "Insert Command..." ), this );
+  mMenu = new KActionMenu( i18n( "Insert Command" ), this );
 
   // ******************************************************
   menu = new KActionMenu( i18n( "Original Message" ), mMenu );
@@ -371,18 +369,14 @@
   connect(action,SIGNAL(triggered(bool)),mapper,SLOT(map()));
   mapper->setMapping( action, CDebugOff );
   menu->addAction( action );
+
+  setMenu( mMenu->menu() );
 }
 
 TemplatesInsertCommand::~TemplatesInsertCommand()
 {
 }
 
-void TemplatesInsertCommand::slotClicked()
-{
-  QSize ps = mMenu->menu()->sizeHint();
-  mMenu->menu()->popup( mapToGlobal( QPoint( 0, -(ps.height()) ) ) );
-}
-
 void TemplatesInsertCommand::slotMapped( int cmd )
 {
   emit insertCommand( static_cast<Command>( cmd ) );
Index: kmail/folderstorage.cpp
===================================================================
--- kmail/folderstorage.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/folderstorage.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -76,7 +76,7 @@
   mUnreadMsgs = -1;
   mGuessedUnreadMsgs = -1;
   mTotalMsgs = -1;
-  mSize = -1;
+  mCachedSize = -1;
   needsCompact = false;
   mConvertToUtf8 = false;
   mCompactable = true;
@@ -415,7 +415,7 @@
   }
   --mTotalMsgs;
 
-  mSize = -1;
+  mCachedSize = -1;
   QString msgIdMD5 = mb->msgIdMD5();
   emit msgRemoved( idx, msgIdMD5 );
   emit msgRemoved( folder() );
@@ -453,7 +453,7 @@
   --mTotalMsgs;
   msg->setParent(0);
   setDirty( true );
-  mSize = -1;
+  mCachedSize = -1;
   needsCompact=true; // message is taken from here - needs to be compacted
   QString msgIdMD5 = msg->msgIdMD5();
   emit msgRemoved( idx, msgIdMD5 );
@@ -828,7 +828,7 @@
 
   mUnreadMsgs = 0;
   mTotalMsgs = 0;
-  mSize = 0;
+  mCachedSize = 0;
   emit numUnreadMsgsChanged( folder() );
   if ( mAutoCreateIndex ) {  // FIXME Heh? - Till
     writeConfig();
@@ -877,11 +877,10 @@
 
 qint64 FolderStorage::folderSize() const
 {
-    if ( mSize != -1 ) {
-        return mSize;
-    } else {
-        return doFolderSize();
-    }
+  if ( mCachedSize == -1 ) {
+    mCachedSize = doFolderSize();
+  }
+  return mCachedSize;
 }
 
 
@@ -954,8 +953,8 @@
   if (mTotalMsgs == -1)
     mTotalMsgs = group.readEntry("TotalMsgs", -1 );
   mCompactable = group.readEntry("Compactable", true );
-  if ( mSize == -1 )
-    mSize = group.readEntry( "FolderSize", Q_INT64_C(-1) );
+  if ( mCachedSize == -1 )
+    mCachedSize = group.readEntry( "FolderSize", Q_INT64_C(-1) );
 
   int type = group.readEntry( "ContentsType", 0 );
   if ( type < 0 || type > KMail::ContentsTypeLast ) type = 0;
@@ -974,7 +973,7 @@
   group.writeEntry( "TotalMsgs", mTotalMsgs );
   group.writeEntry( "Compactable", mCompactable );
   group.writeEntry( "ContentsType", (int)mContentsType );
-  group.writeEntry( "FolderSize", mSize );
+  group.writeEntry( "FolderSize", mCachedSize );
 
   // Write the KMFolder parts
   if( folder() ) folder()->writeConfig( group );
@@ -1101,7 +1100,7 @@
     //FIXME: the questions is : should we iterate through all
     //messages in jobs? I don't think so, because it would
     //mean canceling the jobs that work with other messages
-    if ( (*it)->msgList().first() == msg )
+    if ( !(*it)->msgList().isEmpty() && (*it)->msgList().first() == msg )
     {
       FolderJob* job = (*it);
       it = mJobList.erase( it );
Index: kmail/configuredialog.cpp
===================================================================
--- kmail/configuredialog.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/configuredialog.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -270,7 +270,7 @@
   int width = geometry.readEntry( "ConfigureDialogWidth", 0 );
   int height = geometry.readEntry( "ConfigureDialogHeight", 0 );
   if ( width != 0 && height != 0 ) {
-     setMinimumSize( width, height );
+     resize( width, height );
   }
 
 }
Index: kmail/kmfolderimap.cpp
===================================================================
--- kmail/kmfolderimap.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmfolderimap.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -2304,6 +2304,21 @@
 }
 
 //-----------------------------------------------------------------------------
+qint64 KMFolderImap::doFolderSize() const
+{
+  if ( count() == -1 )
+  {
+    return -1;
+  }
+
+  qint64 folderSize = 0;
+  for ( int i = 0, end = count(); i < end; ++i ) {
+    folderSize += getMsgBase( i )->msgSizeServer();
+  }
+  return folderSize;
+}
+
+//-----------------------------------------------------------------------------
 void
 KMFolderImap::setUserRights( unsigned int userRights )
 {
Index: kmail/popaccount.cpp
===================================================================
--- kmail/popaccount.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/popaccount.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -322,7 +322,9 @@
     const bool addedOk = processNewMsg( msg ); //added ok? Error displayed if not.
 
     if ( !addedOk ) {
+      kWarning() << "Error while processing new mail, aborting mail check.";
       mMsgsPendingDownload.clear();
+      slotAbortRequested();
       break;
     }
 
Index: kmail/kmcomposereditor.cpp
===================================================================
--- kmail/kmcomposereditor.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmcomposereditor.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -126,41 +126,34 @@
     KMCommand *command = new KMForwardAttachedCommand( m_composerWin, messageList,
                                                        identity, m_composerWin );
     command->start();
-  } else if ( md->hasFormat( "image/png" ) ) {
-    emit attachPNGImageData( e->encodedData( "image/png" ) );
-  } else {
-    KUrl::List urlList = KUrl::List::fromMimeData( md );
-    if ( !urlList.isEmpty() ) {
-      e->accept();
-      KMenu p;
-      const QAction *addAsTextAction = p.addAction( i18n("Add as Text") );
-      const QAction *addAsAtmAction = p.addAction( i18n("Add as Attachment") );
-      const QAction *selectedAction = p.exec( mapToGlobal( e->pos() ) );
-      if ( selectedAction == addAsTextAction ) {
-        for ( KUrl::List::Iterator it = urlList.begin();
-              it != urlList.end(); ++it ) {
-          textCursor().insertText( (*it).url() );
-        }
-      } else if ( selectedAction == addAsAtmAction ) {
-        for ( KUrl::List::Iterator it = urlList.begin();
-              it != urlList.end(); ++it ) {
-          m_composerWin->addAttach( *it );
-        }
-      }
-    } else if ( md->hasText() ) {
-      textCursor().insertText( md->text() );
-      e->accept();
-    } else {
-      kDebug(5006) << "Unable to add dropped object";
-      return KMeditor::dropEvent( e );
+    return;
+  }
+
+  // If this is a PNG image or URL list, let MimeData functions handle it.
+  if ( md->hasFormat( "image/png" ) || md->hasUrls() ) {
+    if ( canInsertFromMimeData( md ) ) {
+      insertFromMimeData( md );
+      return;
     }
   }
+
+  // If this is normal text, paste the text
+  if ( md->hasText() ) {
+    KMeditor::dropEvent( e );
+    e->accept();
+    return;
+  }
+
+  kDebug() << "Unable to add dropped object";
+  return KMeditor::dropEvent( e );
 }
 
 bool KMComposerEditor::canInsertFromMimeData( const QMimeData *source ) const
 {
   if ( source->hasFormat( "text/x-kmail-textsnippet" ) )
     return true;
+  if ( source->hasUrls() )
+    return true;
   return KMeditor::canInsertFromMimeData( source );
 }
 
@@ -168,6 +161,16 @@
 {
   if ( source->hasFormat( "text/x-kmail-textsnippet" ) )
     emit insertSnippet();
+
+  // If this is a URL list, add those files as attachments
+  const KUrl::List urlList = KUrl::List::fromMimeData( source );
+  if ( !urlList.isEmpty() ) {
+    foreach( const KUrl &url, urlList ) {
+       m_composerWin->addAttach( url );
+    }
+    return;
+  }
+
   KMeditor::insertFromMimeData( source );
 }
 
Index: kmail/templatesinsertcommand.h
===================================================================
--- kmail/templatesinsertcommand.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/templatesinsertcommand.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -50,7 +50,6 @@
     void insertCommand( const QString& cmd, int adjustCursor = 0 );
 
   public slots:
-    void slotClicked();
     void slotMapped( int cmd );
 
   protected:
Index: kmail/kmfoldermbox.cpp
===================================================================
--- kmail/kmfoldermbox.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmfoldermbox.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -1135,7 +1135,7 @@
     }
   }
   ++mTotalMsgs;
-  mSize = -1;
+  mCachedSize = -1;
 
   if ( aMsg->attachmentState() == KMMsgAttachmentUnknown &&
        aMsg->readyToShow() )
Index: kmail/recipientseditor.cpp
===================================================================
--- kmail/recipientseditor.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/recipientseditor.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -170,6 +170,7 @@
   connect( mEdit, SIGNAL( rightPressed() ), SIGNAL( rightPressed() ) );
 
   connect( mEdit, SIGNAL( leftPressed() ), mCombo, SLOT( setFocus() ) );
+  connect( mEdit, SIGNAL( editingFinished() ), SLOT( slotEditingFinished() ) );
   connect( mEdit, SIGNAL( clearButtonClicked() ), SLOT( slotPropagateDeletion() ) );
   connect( mCombo, SIGNAL( rightPressed() ), mEdit, SLOT( setFocus() ) );
 
@@ -271,6 +272,13 @@
   emit deleteLine( this );
 }
 
+void RecipientLine::slotEditingFinished()
+{
+  if ( mEdit->text().isEmpty() ) {
+    emit deleteLine( this );
+  }
+}
+
 void RecipientLine::keyPressEvent( QKeyEvent *ev )
 {
   if ( ev->key() == Qt::Key_Up ) {
@@ -490,7 +498,7 @@
     mModified = true;
   if ( mLines.count() == 1 ) {
     line->clear();
-  } else {
+  } else if ( mLines.indexOf( line ) != mLines.count() - 1 ) {
     mCurDelLine = line;
     QTimer::singleShot( 0, this, SLOT( slotDeleteLine( ) ) );
   }
@@ -504,13 +512,15 @@
   RecipientLine *line = mCurDelLine;
   int pos = mLines.indexOf( line );
 
-  int newPos;
-  if ( pos == 0 ) newPos = pos + 1;
-  else newPos = pos - 1;
+  if ( mCurDelLine->isActive() ) {
+    int newPos;
+    if ( pos == 0 ) newPos = pos + 1;
+    else newPos = pos - 1;
 
-  // if there is something left to activate, do so
-  if ( mLines.at( newPos ) )
-    mLines.at( newPos )->activate();
+    // if there is something left to activate, do so
+    if ( mLines.at( newPos ) )
+      mLines.at( newPos )->activate();
+  }
 
   mLines.removeAll( line );
   line->setParent( 0 );
@@ -900,7 +910,8 @@
 {
   DistributionListDialog *dlg = new DistributionListDialog( this );
   dlg->setRecipients( mRecipientsView->recipients() );
-  dlg->show();
+  dlg->exec();
+  delete dlg;
 }
 
 Recipient::List RecipientsEditor::recipients() const
Index: kmail/kmfolderimap.h
===================================================================
--- kmail/kmfolderimap.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmfolderimap.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -421,6 +421,9 @@
     the various index files deleted.  Returns 0 on success. */
   virtual int expungeContents();
 
+  /**  reimp */
+  virtual qint64 doFolderSize() const;
+
   void setChildrenState( const QString &attributes );
 
   /** Create or find the INBOX and initialize it */
Index: kmail/folderview.cpp
===================================================================
--- kmail/folderview.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/folderview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -575,7 +575,7 @@
         Util::reconnectSignalSlotPair( fld, SIGNAL( folderSizeChanged( KMFolder * ) ), fvi, SLOT( slotFolderCountsChanged( KMFolder * ) ) );
 
         Util::reconnectSignalSlotPair( fld, SIGNAL( shortcutChanged( KMFolder * ) ), mMainWidget, SLOT( slotShortcutChanged( KMFolder * ) ) );
-      }  
+      }
     }
     i++;
   }
@@ -839,7 +839,7 @@
         // not end up in endless loops trying to update and never making progress.
         elapsed = tStart.msecsTo( QTime::currentTime() );
         if ( ( elapsed > gUpdateCountsProcessingInterval ) || ( elapsed < 0 ) )
-          return OperationInterrupted; // it's taking too long, will continue later.  
+          return OperationInterrupted; // it's taking too long, will continue later.
       break;
       case OperationCompletedClean:
         // no children were dirty
@@ -861,7 +861,7 @@
       {
         elapsed = tStart.msecsTo( QTime::currentTime() );
         if ( ( elapsed > gUpdateCountsProcessingInterval ) || ( elapsed < 0 ) )
-          return OperationInterrupted; // it's taking too long, will continue later.  
+          return OperationInterrupted; // it's taking too long, will continue later.
       }
     }
   }
@@ -997,7 +997,7 @@
 
   if ( notifyManager )
     mManager->viewFolderActivated( this, folder, middleButton );
- 
+
   if ( folder )
   {
     // update counts up to top-level parent
@@ -1007,7 +1007,7 @@
          break; // nothing has changed at this level: parents can't change
       fvi = static_cast< FolderViewItem * >( static_cast< QTreeWidgetItem *>( fvi )->parent() );
     }
-    
+
   }
 
   updateCopyActions();
@@ -1071,7 +1071,7 @@
       {
         // yes, it can happen
         bCanMove = false; // stay safe
-        break; 
+        break;
       }
 
       if( !( *it )->isMoveable() )
@@ -1201,7 +1201,7 @@
   tip += QString::fromLatin1(
           "</td>" \
           "<td align=\"right\" valign=\"top\">" \
-            "<table border=\"0\"><tr><td width=\"32\" height=\"32\" align=\"center\" valign=\"middle\">" 
+            "<table border=\"0\"><tr><td width=\"32\" height=\"32\" align=\"center\" valign=\"middle\">"
               "<img src=\"%1\">" \
             "</td></tr></table>" \
           "</td>" \
@@ -1215,7 +1215,7 @@
 
   QToolTip::showText( he->globalPos(), tip, viewport(), visualItemRect( it ) );
 
-  return true;  
+  return true;
 }
 
 bool FolderView::fillHeaderContextMenu( KMenu * menu, const QPoint &clickPoint )
@@ -1353,7 +1353,7 @@
 {
   if ( multiSelection )
     return; // no multiSelection Account Related actions
- 
+
   KMFolder *folder = item->folder();
 
   if ( !folder )
@@ -1399,7 +1399,7 @@
 {
   if ( multiSelection )
     return; // no multiSelection Account Related actions
- 
+
   KMFolder *folder = item->folder();
 
   if ( !folder )
@@ -2182,7 +2182,7 @@
   } else {
     // FIXME: anybody sets this option to false ?
     if ( GlobalSettings::self()->showPopupAfterDnD() || alwaysAsk )
-    { 
+    {
       KMenu menu;
       QAction *moveAction = menu.addAction( KIcon( "go-jump"), i18n( "&Move Here" ) );
       if ( ! canMove )
@@ -2312,7 +2312,7 @@
 
     e->acceptProposedAction();
   } else
-    e->ignore(); 
+    e->ignore();
 }
 
 
@@ -2402,7 +2402,7 @@
   // First of all call the base class implementation in order to
   // handle scrolling and item expanding
   FolderTreeWidget::dragMoveEvent( e );
- 
+
   if ( e->mimeData()->hasFormat( DraggedFolderList::mimeDataType() ) )
     handleFoldersDragMoveEvent( e );
   else if ( e->mimeData()->hasFormat( KPIM::MailList::mimeDataType() ) )
@@ -2454,7 +2454,7 @@
         static_cast<QTreeWidgetItem *>( fvi )->parent()
       )
     )
-    return; 
+    return;
 
   if ( folder->getSubfolderState() != KMFolderImap::imapNoInformation )
     return;
@@ -2462,7 +2462,7 @@
   // the tree will be reloaded after that
   bool success = folder->listDirectory();
   if (!success)
-    fvi->setExpanded( false ); // failed to list the directory 
+    fvi->setExpanded( false ); // failed to list the directory
 
   if ( ( fvi->childCount() == 0 ) && static_cast<QTreeWidgetItem *>( fvi )->parent() )
     fvi->setChildIndicatorPolicy( QTreeWidgetItem::DontShowIndicatorWhenChildless ); // no children after listing
@@ -2547,7 +2547,7 @@
           depth++;
         }
         QString prefix;
-        prefix.fill( ' ', 2 * depth );   
+        prefix.fill( ' ', 2 * depth );
         folderNames->append( prefix + fvi->labelText() );
       } else {
         folderNames->append( fvi->labelText() );
@@ -2568,7 +2568,7 @@
   if ( !item->folder() )
     return;
   if ( item->folder()->folderType() != KMFolderTypeImap )
-    return; 
+    return;
 
   KMFolderImap *folder = static_cast< KMFolderImap * >( item->folder()->storage() );
   folder->setSubfolderState( KMFolderImap::imapNoInformation );
@@ -2662,7 +2662,11 @@
         icon = "document-new";
       break;
       default:
-        icon = kmkernel->iCalIface().folderPixmap( folderType() );
+      {
+        //If not a resource folder don't try to use icalIface folder pixmap
+        if(kmkernel->iCalIface().isResourceFolder( mFolder ))
+          icon = kmkernel->iCalIface().folderPixmap( folderType() );
+      }
       break;
     }
 
@@ -2711,7 +2715,9 @@
     if ( fld && fld->noContent() )
       icon = "folder-open-grey";
     else {
-      icon = kmkernel->iCalIface().folderPixmap( folderType() );
+      //If not a resource folder don't try to use icalIface folder pixmap
+      if(kmkernel->iCalIface().isResourceFolder( mFolder ))
+        icon = kmkernel->iCalIface().folderPixmap( folderType() );
       if ( icon.isEmpty() )
          icon = "folder-open";
     }
@@ -2736,7 +2742,7 @@
   if ( protocol() == Search )
     return "Folder_search";     // FIXME: Why we're using a different prefix here ? Folder-Virtual-Search wouldn't be nice ?
 
-  return QString();  
+  return QString();
 }
 
 void FolderViewItem::slotIconsChanged()
Index: kmail/kmmsgpartdlg.cpp
===================================================================
--- kmail/kmmsgpartdlg.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmail/kmmsgpartdlg.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -38,10 +38,10 @@
   KMMsgPartDialog::Encoding encoding;
   const char * displayName;
 } encodingTypes[] = {
-  { KMMsgPartDialog::SevenBit, I18N_NOOP("None (7-bit text)") },
-  { KMMsgPartDialog::EightBit, I18N_NOOP("None (8-bit text)") },
-  { KMMsgPartDialog::QuotedPrintable, I18N_NOOP("Quoted Printable") },
-  { KMMsgPartDialog::Base64, I18N_NOOP2("Base 64 message encoding.", "Base 64") },
+  { KMMsgPartDialog::SevenBit, I18N_NOOP2("message encoding type", "None (7-bit text)") },
+  { KMMsgPartDialog::EightBit, I18N_NOOP2("message encoding type", "None (8-bit text)") },
+  { KMMsgPartDialog::QuotedPrintable, I18N_NOOP2("message encoding type", "Quoted Printable") },
+  { KMMsgPartDialog::Base64, I18N_NOOP2("message encoding type", "Base 64") },
 };
 static const int numEncodingTypes =
   sizeof encodingTypes / sizeof *encodingTypes;
@@ -64,7 +64,7 @@
   setHelp( QString::fromLatin1("attachments") );
 
   for ( int i = 0 ; i < numEncodingTypes ; ++i )
-    mI18nizedEncodings << i18n( encodingTypes[i].displayName );
+    mI18nizedEncodings << i18nc( "message encoding type", encodingTypes[i].displayName );
   QFrame *frame = new QFrame( this );
   setMainWidget( frame );
   glay = new QGridLayout(frame );
Index: knode/knarticlefilter.cpp
===================================================================
--- knode/knarticlefilter.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/knarticlefilter.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -75,7 +75,8 @@
 bool KNArticleFilter::loadInfo()
 {
   if (i_d!=-1) {
-    QString fname(KStandardDirs::locate("data",QString( "knode/filters/%1.fltr" ).arg(i_d) ) );
+    QString fname( KStandardDirs::locate( "data",
+                                          QString( "knode/filters/%1.fltr" ).arg( i_d ) ) );
 
     if (fname.isNull())
       return false;
@@ -95,7 +96,7 @@
 
 void KNArticleFilter::load()
 {
-  QString fname(KStandardDirs::locate("data",QString( "knode/filters/%1.fltr").arg(i_d) ) );
+  QString fname(KStandardDirs::locate( "data", QString( "knode/filters/%1.fltr" ).arg( i_d ) ) );
 
   if (fname.isNull())
     return;
@@ -137,7 +138,7 @@
 {
   if (i_d==-1)
     return;
-  QString dir(KStandardDirs::locateLocal("data","knode/")+"filters/");
+  QString dir( KStandardDirs::locateLocal( "data", "knode/filters/" ) );
   if (dir.isNull()) {
     KNHelper::displayInternalFileError();
     return;
Index: knode/articlewidget.cpp
===================================================================
--- knode/articlewidget.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/articlewidget.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -133,8 +133,12 @@
   mInstances.removeAll( this );
   delete mTimer;
   delete mCSSHelper;
-  if ( mArticle && mArticle->isOrphant() )
+  if ( mArticle && mArticle->isOrphant() ) {
+    // if the article manager is still loading the current article,
+    // cancel the job.
+    knGlobals.articleManager()->cancelJobs( mArticle );
     delete mArticle;
+  }
   removeTempFiles();
 }
 
Index: knode/knfiltermanager.cpp
===================================================================
--- knode/knfiltermanager.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/knfiltermanager.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -105,7 +105,7 @@
 
 void KNFilterManager::loadFilters()
 {
-  QString fname(KStandardDirs::locate("data","knode/filters/filters.rc") );
+  QString fname( KStandardDirs::locate( "data","knode/filters/filters.rc" ) );
 
   if (!fname.isNull()) {
     KConfig conf( fname, KConfig::SimpleConfig);
@@ -128,7 +128,7 @@
 
 void KNFilterManager::saveFilterLists()
 {
-  QString dir(KStandardDirs::locateLocal("data","knode/")+"filters/");
+  QString dir( KStandardDirs::locateLocal( "data","knode/filters/" ) );
 
   if (dir.isNull()) {
     KNHelper::displayInternalFileError();
Index: knode/knjobdata.cpp
===================================================================
--- knode/knjobdata.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/knjobdata.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -54,7 +54,17 @@
     processJob( j );
 }
 
+void KNJobConsumer::cancelJobs( KNJobItem *item )
+{
+  Q_FOREACH( KNJobData *job, mJobs ) {
+    if ( job->data() == item ) {
+      job->d_ata = 0;
+      job->cancel();
+    }
+  }
+}
 
+
 void KNJobConsumer::processJob( KNJobData *j )
 {
   delete j;
@@ -77,7 +87,9 @@
 
 KNJobData::~KNJobData()
 {
-  d_ata->setLocked(false);
+  if ( d_ata ) {
+    d_ata->setLocked( false );
+  }
 }
 
 
@@ -131,6 +143,7 @@
         job->addMetaData( "tls", "off" );
     }
   }
+  job->setUiDelegate(0);
   setupKJob( job );
 }
 
Index: knode/kncomposer.cpp
===================================================================
--- knode/kncomposer.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/kncomposer.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -515,7 +515,7 @@
   QWidget* fw = focusWidget();
   if (!fw) return;
 
-  if (fw->inherits("KEdit"))
+  if (fw->inherits("KTextEdit"))
     ((KTextEdit*)fw)->cut();
   else if (fw->inherits("QLineEdit"))
     ((QLineEdit*)fw)->cut();
Index: knode/knconfig.cpp
===================================================================
--- knode/knconfig.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/knconfig.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -219,7 +219,7 @@
 
 KNode::DisplayedHeaders::DisplayedHeaders()
 {
-  QString fname( KStandardDirs::locate("data","knode/headers.rc") );
+  QString fname( KStandardDirs::locate( "data","knode/headers.rc" ) );
 
   if (!fname.isNull()) {
     KConfig headerConf( fname, KConfig::SimpleConfig);
@@ -266,7 +266,7 @@
 
   kDebug(5003) <<"KNConfig::DisplayedHeaders::save()";
 
-  QString dir(KStandardDirs::locateLocal("data","knode/"));
+  QString dir( KStandardDirs::locateLocal( "data", "knode/" ) );
   if (dir.isNull()) {
     KNHelper::displayInternalFileError();
     return;
Index: knode/knfoldermanager.cpp
===================================================================
--- knode/knfoldermanager.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/knfoldermanager.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -35,7 +35,7 @@
 KNFolderManager::KNFolderManager(KNArticleManager *a) : a_rtManager(a)
 {
   //standard folders
-  QString dir(KStandardDirs::locateLocal("data","knode/")+"folders/");
+  QString dir( KStandardDirs::locateLocal( "data", "knode/folders/" ) );
   if (dir.isNull()) {
     KNHelper::displayInternalFileError();
     return;
@@ -422,7 +422,7 @@
 
 void KNFolderManager::syncFolders()
 {
-  QString dir(KStandardDirs::locateLocal("data","knode/")+"folders/");
+  QString dir( KStandardDirs::locateLocal( "data", "knode/folders/" ) );
   if (dir.isNull()) {
     KNHelper::displayInternalFileError();
     return;
@@ -440,7 +440,7 @@
 int KNFolderManager::loadCustomFolders()
 {
   int cnt=0;
-  QString dir(KStandardDirs::locateLocal("data","knode/")+"folders/");
+  QString dir( KStandardDirs::locateLocal( "data", "knode/folders/" ) );
   KNFolder *f;
 
   if (dir.isNull()) {
Index: knode/knnntpaccount.cpp
===================================================================
--- knode/knnntpaccount.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/knnntpaccount.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -174,7 +174,7 @@
 
 QString KNNntpAccount::path()
 {
-  QString dir(KStandardDirs::locateLocal("data","knode/")+QString("nntp.%1/").arg(i_d));
+  QString dir( KStandardDirs::locateLocal( "data", QString( "knode/nntp.%1/" ).arg( i_d ) ) );
   if (dir.isNull())
     KNHelper::displayInternalFileError();
   return (dir);
Index: knode/knfolder.cpp
===================================================================
--- knode/knfolder.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/knfolder.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -97,7 +97,7 @@
 
 QString KNFolder::path()
 {
-  QString dir(KStandardDirs::locateLocal("data","knode/")+"folders/");
+  QString dir( KStandardDirs::locateLocal( "data", "knode/folders/" ) );
   /*if (dir.isNull())
     KNHelper::displayInternalFileError();*/
   return dir;
Index: knode/knjobdata.h
===================================================================
--- knode/knjobdata.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/knjobdata.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -29,6 +29,7 @@
 class Job;
 }
 
+class KNJobItem;
 class KNJobData;
 class KNServerInfo;
 
@@ -55,6 +56,10 @@
      */
     bool jobsPending() const { return !mJobs.isEmpty(); }
 
+    /** Find any job related to a job item and cancel it.
+     */
+    void cancelJobs( KNJobItem *item );
+
   protected:
     /** The actual work is done here */
     virtual void processJob(KNJobData *j);
Index: knode/knconvert.cpp
===================================================================
--- knode/knconvert.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/knconvert.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -184,7 +184,7 @@
       return;
     }
 
-    QString dataDir=KStandardDirs::locateLocal("data","knode/");
+    QString dataDir = KStandardDirs::locateLocal( "data", "knode/" );
     t_ar=new KProcess;
     *t_ar << "tar";
     *t_ar << "-cz" << dataDir
@@ -251,7 +251,7 @@
 
 bool KNConvert::Converter04::doConvert()
 {
-  QString dir=KStandardDirs::locateLocal("data","knode/")+"folders/";
+  QString dir = KStandardDirs::locateLocal( "data", "knode/folders/" );
   int num;
   bool error=false;
 
Index: knode/knaccountmanager.cpp
===================================================================
--- knode/knaccountmanager.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knode/knaccountmanager.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -60,7 +60,7 @@
 
 void KNAccountManager::loadAccounts()
 {
-  QString dir(KStandardDirs::locateLocal("data","knode/"));
+  QString dir( KStandardDirs::locateLocal( "data", "knode/" ) );
   if (dir.isNull()) {
     KNHelper::displayInternalFileError();
     return;
@@ -105,7 +105,7 @@
 bool KNAccountManager::newAccount(KNNntpAccount *a)
 {
   // find a unused id for the new account...
-  QString dir(KStandardDirs::locateLocal("data","knode/"));
+  QString dir( KStandardDirs::locateLocal( "data", "knode/" ) );
   if (dir.isNull()) {
     delete a;
     KNHelper::displayInternalFileError();
@@ -120,7 +120,7 @@
 
   a->setId(id);
 
-  dir = KStandardDirs::locateLocal("data",QString("knode/nntp.%1/").arg(a->id()));
+  dir = KStandardDirs::locateLocal( "data", QString( "knode/nntp.%1/" ).arg( a->id() ) );
   if (!dir.isNull()) {
     mAccounts.append(a);
     emit(accountAdded(a));
Index: doc/kalarm/mainwindow.png
===================================================================
Nie można wyświetlić: plik binarny.
svn:mime-type = image/png
Index: doc/kalarm/alarmmessage.png
===================================================================
Nie można wyświetlić: plik binarny.
svn:mime-type = image/png
Index: kalarm/kalarm.h
===================================================================
--- kalarm/kalarm.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/kalarm.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -23,7 +23,7 @@
 
 #undef QT3_SUPPORT
 
-#define KALARM_VERSION "2.1.6"
+#define KALARM_VERSION "2.1.7"
 #define KALARM_NAME "KAlarm"
 #define KALARM_DBUS_SERVICE  "org.kde.kalarm"  // D-Bus service name of KAlarm application
 
Index: kalarm/eventlistmodel.cpp
===================================================================
--- kalarm/eventlistmodel.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/eventlistmodel.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -95,7 +95,7 @@
 		mTextIcon    = new QPixmap(SmallIcon("dialog-information"));
 		mFileIcon    = new QPixmap(SmallIcon("document-open"));
 		mCommandIcon = new QPixmap(SmallIcon("system-run"));
-		mEmailIcon   = new QPixmap(SmallIcon("mail-message-new"));
+		mEmailIcon   = new QPixmap(SmallIcon("mail-message-unread"));
 		mIconSize = mTextIcon->size().expandedTo(mFileIcon->size()).expandedTo(mCommandIcon->size()).expandedTo(mEmailIcon->size());
 	}
 	MinuteTimer::connect(this, SLOT(slotUpdateTimeTo()));
@@ -106,6 +106,21 @@
 	                   SLOT(slotResourceLoaded(AlarmResource*, bool)));
 }
 
+/******************************************************************************
+* Clear all events from a model.
+*/
+void EventListModel::clear()
+{
+	kDebug();
+	int count = mEvents.count();
+	if (count)
+	{
+		beginRemoveRows(QModelIndex(), 0, count - 1);
+		mEvents.clear();
+		endRemoveRows();
+	}
+}
+
 int EventListModel::rowCount(const QModelIndex& parent) const
 {
 	if (parent.isValid())
Index: kalarm/Changelog
===================================================================
--- kalarm/Changelog	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/Changelog	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -1,8 +1,15 @@
 KAlarm Change Log
 
-=== Version 2.1.6 --- 4 March 2009 ===
-Fix crash when KAlarm quits.
+=== Version 2.1.7 --- 18 April 2009 ===
+- Fix recurring alarms being missed when deferred to earlier than next due alarm,
+  when next due alarm is earlier than the next recurrence.
+- Fix speech mode not working when alarm messages are displayed.
+- Fix crash when KAlarm quits.
 
+=== Version 2.1.6 (KDE 4.2.2) --- 18 March 2009 ===
+- Fix memory leaks.
+- Fix crash when KAlarm quits.
+
 === Version 2.1.5 (KDE 4.2.1) --- 7 February 2009 ===
 - Disable inapplicable alarm types in alarm edit dialogue Load Template list.
 - Prevent multiple identical error messages being displayed for the same alarm.
Index: kalarm/kalarmapp.cpp
===================================================================
--- kalarm/kalarmapp.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/kalarmapp.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -39,18 +39,6 @@
 #include "startdaytimer.h"
 #include "traywindow.h"
 
-#include <stdlib.h>
-#include <ctype.h>
-#include <iostream>
-#include <climits>
-
-#include <QObject>
-#include <QTimer>
-#include <QRegExp>
-#include <QFile>
-#include <QByteArray>
-#include <QTextStream>
-
 #include <kcmdlineargs.h>
 #include <klocale.h>
 #include <kstandarddirs.h>
@@ -61,10 +49,29 @@
 #include <kglobal.h>
 #include <kstandardguiitem.h>
 #include <kservicetypetrader.h>
+#include <kspeechinterface.h>
+#include <kspeech.h>
+#include <ktoolinvocation.h>
 #include <netwm.h>
 #include <kdebug.h>
 #include <kshell.h>
 
+#include <QObject>
+#include <QTimer>
+#include <QRegExp>
+#include <QFile>
+#include <QByteArray>
+#include <QTextStream>
+#include <QtDBus/QtDBus>
+
+#include <stdlib.h>
+#include <ctype.h>
+#include <iostream>
+#include <climits>
+
+static const char* KTTSD_DBUS_SERVICE = "org.kde.kttsd";
+static const char* KTTDS_DBUS_PATH    = "/KSpeech";
+
 static bool convInterval(const QByteArray& timeParam, KARecurrence::Type&, int& timeInterval, bool allowMonthYear = false);
 
 /******************************************************************************
@@ -99,6 +106,7 @@
 	  mAlarmTimer(new QTimer(this)),
 	  mArchivedPurgeDays(-1),      // default to not purging
 	  mPurgeDaysQueued(-1),
+	  mKSpeech(0),
 	  mPendingQuit(false),
 	  mProcessingQueue(false),
 	  mSessionClosingDown(false),
@@ -118,6 +126,8 @@
 	Preferences::connect(SIGNAL(showInSystemTrayChanged(bool)), this, SLOT(slotShowInSystemTrayChanged()));
 	Preferences::connect(SIGNAL(archivedKeepDaysChanged(int)), this, SLOT(setArchivePurgeDays()));
 	KARecurrence::setDefaultFeb29Type(Preferences::defaultFeb29Type());
+	connect(QDBusConnection::sessionBus().interface(), SIGNAL(serviceUnregistered(const QString&)),
+	        SLOT(slotDBusServiceUnregistered(const QString&)));
 
 	if (AlarmCalendar::initialiseCalendars())
 	{
@@ -360,7 +370,7 @@
 				// Display a message or file, execute a command, or send an email
 				KAEvent::Action action = KAEvent::MESSAGE;
 				QString          alMessage;
-				uint             alFromID;
+				uint             alFromID = 0;
 				EmailAddressList alAddresses;
 				QStringList      alAttachments;
 				QString          alSubject;
@@ -764,6 +774,7 @@
 	{
 		// Quit regardless, except for message windows
 		mQuitting = true;
+		EventListModel::alarms()->clear();  // prevent view updates during window destruction
 		MainWindow::closeAll();
 		displayTrayIcon(false);
 		if (MessageWin::instanceCount())
@@ -883,7 +894,9 @@
 	if (!nextEvent)
 		return;   // there are no alarms pending
 	KDateTime nextDt = nextEvent->nextTrigger(KAEvent::ALL_TRIGGER).effectiveKDateTime();
-	qint64 interval = KDateTime::currentDateTime(Preferences::timeZone()).secsTo_long(nextDt);
+	KDateTime now = KDateTime::currentDateTime(Preferences::timeZone());
+	qint64 interval = now.secsTo_long(nextDt);
+	kDebug() << "now:" << qPrintable(now.toString("%Y-%m-%d %H:%M %:Z")) << ", next:" << qPrintable(nextDt.toString("%Y-%m-%d %H:%M %:Z")) << ", due:" << interval;
 	if (interval <= 0)
 	{
 		// Queue the alarm
@@ -2003,6 +2016,49 @@
 }
 
 /******************************************************************************
+* Return a D-Bus interface object for KSpeech.
+* The KTTSD D-Bus service is started if necessary.
+* If the service cannot be started, 'error' is set to an error text.
+*/
+OrgKdeKSpeechInterface* KAlarmApp::kspeechInterface(QString& error) const
+{
+	error.clear();
+	QDBusConnection client = QDBusConnection::sessionBus();
+	if (!client.interface()->isServiceRegistered(KTTSD_DBUS_SERVICE))
+	{
+		// kttsd is not running, so start it
+		delete mKSpeech;
+		mKSpeech = 0;
+		if (KToolInvocation::startServiceByDesktopName(QLatin1String("kttsd"), QStringList(), &error))
+		{
+			kDebug() << "Failed to start kttsd:" << error;
+			return 0;
+		}
+	}
+	if (!mKSpeech)
+	{
+		mKSpeech = new OrgKdeKSpeechInterface(KTTSD_DBUS_SERVICE, KTTDS_DBUS_PATH, QDBusConnection::sessionBus());
+		mKSpeech->setParent(theApp());
+		mKSpeech->setApplicationName(KGlobal::mainComponent().aboutData()->programName());
+		mKSpeech->setDefaultPriority(KSpeech::jpMessage);
+	}
+	return mKSpeech;
+}
+
+/******************************************************************************
+* Called when a D-Bus service unregisters.
+* If it's the KTTSD service, delete the KSpeech interface object.
+*/
+void KAlarmApp::slotDBusServiceUnregistered(const QString& serviceName)
+{
+	if (serviceName == KTTSD_DBUS_SERVICE)
+	{
+		delete mKSpeech;
+		mKSpeech = 0;
+	}
+}
+
+/******************************************************************************
 * If this is the first time through, open the calendar file, and start
 * processing the execution queue.
 */
Index: kalarm/lib/autodeletelist.h
===================================================================
--- kalarm/lib/autodeletelist.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/lib/autodeletelist.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -1,7 +1,7 @@
 /*
  *  autodeletelist.h  -  pointer list with auto-delete on destruction
  *  Program:  kalarm
- *  Copyright © 2008 by David Jarvie <software@astrojar.org.uk>
+ *  Copyright © 2008,2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -36,8 +36,10 @@
 		AutoDeleteList() : QList<T*>() {}
 		~AutoDeleteList()
 		{
-			for (int i = 0, end = QList<T*>::count();  i < end;  ++i)
-				delete QList<T*>::operator[](i);
+			// Remove from list first before deleting the pointer, in
+			// case the pointer's destructor removes it from the list.
+			while (!this->isEmpty())
+				delete this->takeFirst();
 		}
 	private:
 		// Prevent copying since that would create two owners of the pointers
Index: kalarm/eventlistmodel.h
===================================================================
--- kalarm/eventlistmodel.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/eventlistmodel.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -64,6 +64,7 @@
 		static EventListModel* alarms();
 		static EventListModel* templates();
 		~EventListModel();
+		void                  clear();
 		virtual int           rowCount(const QModelIndex& parent = QModelIndex()) const;
 		virtual int           columnCount(const QModelIndex& parent = QModelIndex()) const;
 		virtual QModelIndex   index(int row, int column = 0, const QModelIndex& parent = QModelIndex()) const;
Index: kalarm/alarmcalendar.cpp
===================================================================
--- kalarm/alarmcalendar.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/alarmcalendar.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -944,12 +944,7 @@
 			evnt->clearUpdated();
 			if (kaevnt != evnt)
 				*kaevnt = *evnt;   // update the event instance in our lists, keeping the same pointer
-			for (EarliestMap::Iterator eit = mEarliestAlarm.begin();  eit != mEarliestAlarm.end();  ++eit)
-				if (eit.value() == kaevnt)
-				{
-					findEarliestAlarm(eit.key());
-					break;
-				}
+			findEarliestAlarm(AlarmResources::instance()->resource(kcalEvent));
 			return kaevnt;
 		}
 	}
Index: kalarm/resources/localdir.desktop
===================================================================
--- kalarm/resources/localdir.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/resources/localdir.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -14,6 +14,7 @@
 Name[fr]=Alarmes dans un dossier local
 Name[ga]=Aláraim i gComhadlann Logánta
 Name[gl]=Alarmas nun Directorio Local
+Name[hu]=Helyi mappában tárolt emlékeztetők
 Name[it]=Promemoria in una cartella locale
 Name[ja]=ローカルディレクトリのアラーム
 Name[kk]=Жергілікті каталогтағы ескертулер
@@ -48,6 +49,7 @@
 Comment[et]=Võimaldab kasutada kohalikku kataloogi salvestatud häirete kalendrit, kus iga kalender on salvestatud eraldi faili
 Comment[fr]=Fourni l'accès aux alarmes de calendrier stockées dans un dossier ; chaque entrée du calendrier étant stockée dans un fichier distinct
 Comment[gl]=Permite acceder a un calendario de alarmas almacenado nun directorio local no que cada elemento do calendario se almacena nun ficheiro diferente
+Comment[hu]=Helyi mappában tárolt emlékeztetőkhöz biztosít hozzáférést (minden bejegyzés külön fájlban található)
 Comment[it]=Consente l'accesso a dei promemoria memorizzati in una cartella locale, in cui ogni voce di calendario è memorizzato in un file separato
 Comment[ja]=カレンダーアイテムがそれぞれ個別のファイルに保存されているローカルディレクトリのアラームカレンダーへのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ប្រតិទិន​ជូន​ដំណឹង​ដែល​បាន​រក្សាទុក​នៅ​ក្នុង​ថត​មូលដ្ឋាន ដែល​ធាតុ​ប្រតិទិន​នីមួយៗ​គឺ​ត្រូវបាន​រក្សាទុក​ជា​ឯកសារ​ដាច់ដោយឡែក​ពី​គ្នា
Index: kalarm/resources/local.desktop
===================================================================
--- kalarm/resources/local.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/resources/local.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -13,6 +13,7 @@
 Name[fr]=Alarmes dans un fichier local
 Name[ga]=Aláraim i gComhad Logánta
 Name[gl]=Alarmas en Ficheiro Local
+Name[hu]=Helyi fájlban tárolt emlékeztetők
 Name[it]=Promemoria in file locale
 Name[ja]=ローカルファイルのアラーム
 Name[kk]=Жергілікті файлдағы ескертулер
@@ -47,6 +48,7 @@
 Comment[et]=Võimaldab kasutada kohalikku faili salvestatud häirete kalendrit
 Comment[fr]=Fourni l'accès aux alarmes de calendrier stockées dans un unique fichier
 Comment[gl]=Dá aceso a un calendario de alarmas gardado nun ficheiro local
+Comment[hu]=Helyi fájlban tárolt emlékeztetőkhöz biztosít hozzáférést
 Comment[it]=Consente l'accesso a dei promemoria memorizzati in un file locale
 Comment[ja]=単一のローカルファイルに保存されているアラームカレンダーへのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅ​ប្រតិទិន​ជូន​ដំណឹង ដែល​បាន​ទុក​នៅ​ក្នុង​ឯកសារ​មូលដ្ឋាន​ទោល
Index: kalarm/resources/remote.desktop
===================================================================
--- kalarm/resources/remote.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/resources/remote.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -14,6 +14,7 @@
 Name[fr]=Alarmes dans un fichier distant
 Name[ga]=Aláraim i gCianchomhad
 Name[gl]=Alarmas nun Ficheiro Remoto
+Name[hu]=Távoli fájlban tárolt emlékeztetők
 Name[it]=Promemoria in file remoto
 Name[ja]=リモートファイルのアラーム
 Name[kk]=Қашықтағы файлдағы ескертулер
@@ -48,6 +49,7 @@
 Comment[et]=Võimaldab kasutada võrgufailis leiduvat häirete kalendrit KDE võrguraamistiku KIO vahendusel
 Comment[fr]=Fourni l'accès aux alarmes de calendrier stockées dans un fichier distant en utilisant les composants réseaux KIO de KDE
 Comment[gl]=Permite acceder a un calendario de alarmas dun ficheiro remoto empregando a infraestrutura de rede KIO do KDE
+Comment[hu]=Távoli fájlban tárolt emlékeztetőkhöz biztosít hozzáférést a KIO keretrendszer segítségével
 Comment[it]=Consente l'accesso a dei promemoria memorizzati su un file remoto tramite l'infrastruttura di rete KIO di KDE
 Comment[ja]=KDE のネットワークフレームワーク KIO を使って、リモートファイルに保存されているアラームカレンダーへのアクセスを提供します
 Comment[km]=ផ្ដល់​សិទ្ធិ​ចូល​ដំណើរការ​ទៅកាន់​ប្រតិទិន​ជូន​ដំណឹង​នៅ​ក្នុង​ឯកសារ​ពី​ចម្ងាយ​ដោយប្រើ​គ្រោងការណ៍​បណ្ដាញ KIO ​របស់ KDE
Index: kalarm/resources/kalarm_manager.desktop
===================================================================
--- kalarm/resources/kalarm_manager.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/resources/kalarm_manager.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -13,6 +13,7 @@
 Name[fr]=Alarmes
 Name[ga]=Aláraim
 Name[gl]=Alarmas
+Name[hu]=Emlékeztetők
 Name[it]=Promemoria
 Name[ja]=アラーム
 Name[kk]=Ескертулер
Index: kalarm/alarmevent.cpp
===================================================================
--- kalarm/alarmevent.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/alarmevent.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -1389,7 +1389,8 @@
 		 * recurrences. (But exception dates/times need to be taken into account.)
 		 */
 		KDateTime kdtRecur;
-		int repeatFreq, repeatNum;
+		int repeatFreq = 0;
+		int repeatNum = 0;
 		if (mRepeatCount)
 		{
 			// It's a repetition inside a recurrence, each of which occurs
Index: kalarm/messagewin.cpp
===================================================================
--- kalarm/messagewin.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/messagewin.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -72,6 +72,7 @@
 #include <kio/netaccess.h>
 #include <knotification.h>
 #include <kpushbutton.h>
+#include <kspeechinterface.h>
 #include <phonon/mediaobject.h>
 #include <phonon/path.h>
 #include <phonon/audiooutput.h>
@@ -81,10 +82,6 @@
 
 using namespace KCal;
 
-static const char* KTTSD_DBUS_SERVICE  = "org.kde.kttsd";
-static const char* KTTDS_DBUS_PATH      = "/KSpeech";
-static const char* KTTSD_DBUS_INTERFACE = "org.kde.KSpeech";
-
 #ifdef KMAIL_SUPPORTED
 #include "kmailinterface.h"
 static const char* KMAIL_DBUS_SERVICE   = "org.kde.kmail";
@@ -1104,31 +1101,23 @@
 
 void MessageWin::slotSpeak()
 {
-	QDBusConnection client = QDBusConnection::sessionBus();
-	if (!client.interface()->isServiceRegistered(KTTSD_DBUS_SERVICE))
+	QString error;
+	OrgKdeKSpeechInterface* kspeech = theApp()->kspeechInterface(error);
+	if (!kspeech)
 	{
-		// kttsd is not running, so start it
-		QString error;
-		if (KToolInvocation::startServiceByDesktopName(QLatin1String("kttsd"), QStringList(), &error))
+		if (!haveErrorMessage(ErrMsg_Speak))
 		{
-			kDebug() << "Failed to start kttsd:" << error;
-			if (!haveErrorMessage(ErrMsg_Speak))
-			{
-				KMessageBox::detailedError(0, i18nc("@info", "Unable to speak message"), error);
-				clearErrorMessage(ErrMsg_Speak);
-			}
-			return;
+			KMessageBox::detailedError(0, i18nc("@info", "Unable to speak message"), error);
+			clearErrorMessage(ErrMsg_Speak);
 		}
+		return;
 	}
-	// FIXME: this would be a lot cleaner just using kttsd's dbus stub.
-	QDBusInterface kttsdDBus(KTTSD_DBUS_SERVICE, KTTDS_DBUS_PATH, KTTSD_DBUS_INTERFACE );
-	QDBusMessage reply = kttsdDBus.call(QLatin1String("sayMessage"), mMessage, QString());
-	if (reply.type() == QDBusMessage::ErrorMessage)
+	if (!kspeech->say(mMessage, 0))
 	{
 		kDebug() << "SayMessage() D-Bus error";
 		if (!haveErrorMessage(ErrMsg_Speak))
 		{
-			KMessageBox::detailedError(0, i18nc("@info", "Unable to speak message"), i18nc("@info", "D-Bus call sayMessage failed"));
+			KMessageBox::detailedError(0, i18nc("@info", "Unable to speak message"), i18nc("@info", "D-Bus call say() failed"));
 			clearErrorMessage(ErrMsg_Speak);
 		}
 	}
Index: kalarm/CMakeLists.txt
===================================================================
--- kalarm/CMakeLists.txt	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/CMakeLists.txt	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -94,10 +94,11 @@
    resourcemodelview.cpp
    resourceselector.cpp
 )
-qt4_add_dbus_adaptor( kalarm_bin_SRCS org.kde.kalarm.kalarm.xml dbushandler.h DBusHandler )
+qt4_add_dbus_adaptor(kalarm_bin_SRCS org.kde.kalarm.kalarm.xml dbushandler.h DBusHandler)
 if (KMAIL_SUPPORTED)
-   qt4_add_dbus_interfaces(kalarm_bin_SRCS ${CMAKE_BINARY_DIR}/kmail/org.kde.kmail.kmail.xml )
+   qt4_add_dbus_interfaces(kalarm_bin_SRCS ${CMAKE_BINARY_DIR}/kmail/org.kde.kmail.kmail.xml)
 endif (KMAIL_SUPPORTED)
+qt4_add_dbus_interfaces(kalarm_bin_SRCS ${KDE4_DBUS_INTERFACES_DIR}/org.kde.KSpeech.xml)
 
 kde4_add_kcfg_files(kalarm_bin_SRCS GENERATE_MOC kalarmconfig.kcfgc)
 
Index: kalarm/kalarmapp.h
===================================================================
--- kalarm/kalarmapp.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/kalarmapp.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -1,7 +1,7 @@
 /*
  *  kalarmapp.h  -  the KAlarm application object
  *  Program:  kalarm
- *  Copyright © 2001-2008 by David Jarvie <djarvie@kde.org>
+ *  Copyright © 2001-2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -38,6 +38,7 @@
 class MainWindow;
 class TrayWindow;
 class ShellProcess;
+class OrgKdeKSpeechInterface;
 
 
 class KAlarmApp : public KUniqueApplication
@@ -51,6 +52,7 @@
 		bool               wantShowInSystemTray() const;
 		bool               alarmsEnabled() const           { return mAlarmsEnabled; }
 		bool               speechEnabled() const           { return mSpeechEnabled; }
+		OrgKdeKSpeechInterface* kspeechInterface(QString& error) const;
 		bool               korganizerEnabled() const       { return mKOrganizerEnabled; }
 		bool               restoreSession();
 		bool               sessionClosingDown() const      { return mSessionClosingDown; }
@@ -105,6 +107,8 @@
 		void               setArchivePurgeDays();
 		void               slotPurge()                     { purge(mArchivedPurgeDays); }
 		void               slotCommandExited(ShellProcess*);
+		void               slotDBusServiceUnregistered(const QString& serviceName);
+
 	private:
 		enum EventFunc
 		{
@@ -172,6 +176,7 @@
 		int                mPurgeDaysQueued;     // >= 0 to purge the archive calendar from KAlarmApp::processLoop()
 		QList<ProcData*>   mCommandProcesses;    // currently active command alarm processes
 		QQueue<DcopQEntry> mDcopQueue;           // DCOP command queue
+		mutable OrgKdeKSpeechInterface* mKSpeech;// KSpeech D-Bus interface object
 		int                mPendingQuitCode;     // exit code for a pending quit
 		bool               mPendingQuit;         // quit once the DCOP command and shell command queues have been processed
 		bool               mProcessingQueue;     // a mDcopQueue entry is currently being processed
Index: kalarm/kalarm.autostart.desktop
===================================================================
--- kalarm/kalarm.autostart.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kalarm/kalarm.autostart.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -28,6 +28,7 @@
 Comment[fr]=Démarrage à la connexion de KAlarm
 Comment[ga]=Tosaigh KAlarm go huathoibríoch ag am logála isteach
 Comment[gl]=Inicio automático do KAlarm
+Comment[hu]=A KAlarm emlékeztető szolgáltatás automatikus elindítása
 Comment[it]=Avvio automatico di KAlarm all'accesso
 Comment[ja]=ログイン時に KAlarm を自動起動
 Comment[km]=ចាប់ផ្ដើម KAlarm ដោយ​ស្វ័យប្រវត្តិ​នៅពេល​ចូល
Index: kmailcvt/main.cpp
===================================================================
--- kmailcvt/main.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kmailcvt/main.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -43,5 +43,7 @@
   a.setMainWidget(kmailcvt);
   kmailcvt->show();
 
-  return a.exec();
+  int ret = a.exec();
+  delete kmailcvt;
+  return ret;
 }
Index: kaddressbook/kaddressbookview.h
===================================================================
--- kaddressbook/kaddressbookview.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/kaddressbookview.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -99,8 +99,12 @@
     /**
       Returns a QString with all the selected email addresses concatenated
       together with a ',' separator.
+      @param askForEMail if an addressee has more than one mail address
+                         and this parameter is true, a dialog will pop
+                         up and ask the user for the mail address to take.
+                         Otherwise, the preffered mail address will be taken
      */
-    virtual QString selectedEmails();
+    virtual QString selectedEmails( bool askForEMail = true );
 
     /**
       Return the type of the view: Icon, Table, etc. Please make sure that
Index: kaddressbook/undocmds.cpp
===================================================================
--- kaddressbook/undocmds.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/undocmds.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -26,6 +26,7 @@
 
 #include <QtGui/QApplication>
 #include <QtGui/QClipboard>
+#include <QMimeData>
 
 #include <kabc/resource.h>
 #include <kapplication.h>
@@ -323,11 +324,12 @@
     lock()->unlock( addr.resource() );
   }
 
-  // Convert to clipboard
-  mClipText = AddresseeUtil::addresseesToClipboard( mAddresseeList );
-
   QClipboard *cb = QApplication::clipboard();
   mOldText = cb->text();
   kapp->processEvents();
-  cb->setText( mClipText );
+  // Convert to clipboard
+  mClipText = AddresseeUtil::addresseesToClipboard( mAddresseeList );
+  QMimeData *data = new QMimeData();
+  data->setData( "text/directory", mClipText );
+  cb->setMimeData( data );
 }
Index: kaddressbook/dbusaddressbook.desktop
===================================================================
--- kaddressbook/dbusaddressbook.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/dbusaddressbook.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -16,6 +16,7 @@
 Comment[fr]=Carnet d'adresses avec une interface D-Bus
 Comment[ga]=Leabhar Seoltaí le comhéadan D-Bus
 Comment[gl]=Caderno de enderezos cunha interface D-Bus
+Comment[hu]=Címjegyzék D-Bus-felülettel
 Comment[it]=Rubrica indirizzi con un'interfaccia D-Bus
 Comment[ja]=D-Bus インターフェースを持つアドレス帳
 Comment[kk]=D-Bus интерфейсті адрестік кітапшасы
Index: kaddressbook/views/cardview.cpp
===================================================================
--- kaddressbook/views/cardview.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/views/cardview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -57,6 +57,7 @@
       setFrameStyle( Panel | Plain );
       setMidLineWidth( 0 );
       setIndent( 1 );
+      setAutoFillBackground( true );
     }
 
     ~CardViewTip() {}
Index: kaddressbook/undocmds.h
===================================================================
--- kaddressbook/undocmds.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/undocmds.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -110,7 +110,7 @@
   private:
     KABC::Addressee::List mAddresseeList;
     QStringList mUIDList;
-    QString mClipText;
+    QByteArray mClipText;
     QString mOldText;
 };
 
Index: kaddressbook/xxport/kde2_xxport.desktop
===================================================================
--- kaddressbook/xxport/kde2_xxport.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/xxport/kde2_xxport.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -19,7 +19,7 @@
 Name[ga]=Breiseán Iompórtála/Easpórtála KDE2 le haghaidh KAB
 Name[gl]=Engadido XXPort de KDE2 para KAB
 Name[he]=תוסף ייבוא/ייצוא עבור KDE2 של KAB
-Name[hu]=KAB KDE2 XXPort bővítőmodul
+Name[hu]=KAB KDE2 XXPort bővítmény
 Name[is]=Íforrit fyrir KAB KDE2 XXPort
 Name[it]=Estensione XXPort di KAB per KDE2
 Name[ja]=KAB KDE2 インポート/プラグイン
@@ -67,7 +67,7 @@
 Comment[fy]=Plugin foar it importearjen fan it Ã¢lde KDE 2-adresboek
 Comment[ga]=Breiseán a iompórtálann an seanleabhar seoltaí KDE 2
 Comment[gl]=Engadido para importar o caderno de enderezos antigo do KDE 2
-Comment[hu]=Bővítőmodul KDE2-es címjegyzék importálásához
+Comment[hu]=Bővítmény KDE2-es címjegyzék importálásához
 Comment[is]=Íforrit til að færa inn gömlu KDE2 vistfangaskrána
 Comment[it]=Estensione per importare le vecchie voci della rubrica di KDE2
 Comment[ja]=古い KDE 2 アドレス帳をインポートするプラグイン
Index: kaddressbook/xxport/gmx_xxport.desktop
===================================================================
--- kaddressbook/xxport/gmx_xxport.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/xxport/gmx_xxport.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -13,6 +13,7 @@
 Name[fr]=Module d'import / export KAB GMX
 Name[ga]=Breiseán Iompórtála/Easpórtála GMX le haghaidh KAB
 Name[gl]=Engadido KAB GMX XXPort 
+Name[hu]=KAB GMX XXPort bővítmény
 Name[it]=Estensione XXPort di KAB per GMX
 Name[ja]=KAB GMX XXPort プラグイン
 Name[kk]=GMX-қа экспорт/импорт ету
@@ -42,6 +43,7 @@
 Comment[da]=Plugin til at importere og eksportere kontakter i GMX's adressebogsformat
 Comment[de]=Modul für Import/Export von Kontakten im GMX-Adressbuchformat
 Comment[el]=Πρόσθετο για εισαγωγή και εξαγωγή επαφών μορφής GMX
+Comment[en_GB]=Plugin to import and export contacts in GMX's address book format
 Comment[es]=Complemento para importar y exportar contactos en el formato de libreta de direcciones de GMX
 Comment[et]=Plugin kontaktide importimiseks ja eksportimiseks GMX aadressiraamatu vormingus
 Comment[fa]=وصله برای واردات و صادرات تماسها در قالب کتاب نشانی GMX
@@ -49,6 +51,7 @@
 Comment[fr]=Module d'import / export de contacts au format GMX
 Comment[ga]=Breiseán chun teagmhálacha i bhformáid leabhair seoltaí GMX a iompórtáil agus a easpórtáil
 Comment[gl]=Engadido para importar e exportar contactos en formato de caderno de enderezos GMX
+Comment[hu]=Bővítmény GMX formátumú címjegyzék importálásához/exportálásához
 Comment[it]=Estensione per importare ed esportare contatti in formato GMX
 Comment[ja]=GMX アドレス帳のフォーマットで連絡先をインポート/エクスポートするプラグイン
 Comment[kk]=GMX контакттарды экспорт/импорт ету модулі
Index: kaddressbook/xxport/csv_xxport.desktop
===================================================================
--- kaddressbook/xxport/csv_xxport.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/xxport/csv_xxport.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -18,7 +18,7 @@
 Name[ga]=Breiseán Iompórtála/Easpórtála CSV le haghaidh KAB
 Name[gl]=Engadido XXPort de CSV para KAB
 Name[he]=תוסף ייבוא/ייצוא של קבצי CSV של KAB
-Name[hu]=KAB XXPort bővítőmodul
+Name[hu]=KAB XXPort bővítmény
 Name[is]=Íforrit fyrir KAV CSV XXPort
 Name[it]=Estensione XXPort KAB per CSV
 Name[ja]=KAB CSV インポート/エクスポートプラグイン
Index: kaddressbook/xxport/gnokii_xxport.desktop
===================================================================
--- kaddressbook/xxport/gnokii_xxport.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/xxport/gnokii_xxport.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -17,7 +17,7 @@
 Name[fy]=KAB Mobile Tillefoan XXPort-plugin
 Name[gl]=Engadido XXPort de Teléfono Móbil para KAB
 Name[he]=תוסף ייבוא/ייצוא עבור טלפונים ניידים של KAB
-Name[hu]=KAB mobiltelefon XXPort bővítőmodul
+Name[hu]=KAB mobiltelefon XXPort bővítmény
 Name[is]=Íforrit fyrir KAB farsíma XXPort
 Name[it]=Estensione XXPort di KAB per telefono cellulare
 Name[ja]=KAB 携帯電話インポート/エクスポートプラグイン
@@ -65,7 +65,7 @@
 Comment[fr]=Module de téléphone portable pour importer et exporter des entrées du carnet d'adresses
 Comment[fy]=Comment=Mobile-tillefoan-plugin faor it importearjen en eksportearjen fan adresboekitems
 Comment[gl]=Engadido de Teléfono Móbil para importar e exportar entradas do caderno de enderezos
-Comment[hu]=Mobiltelefonos bővítőmodul címbejegyzések importálásához/exportálásához
+Comment[hu]=Mobiltelefonos bővítmény címbejegyzések importálásához/exportálásához
 Comment[is]=Íforrit til að færa tengilið milli póstfangaskrár og farsíma
 Comment[it]=Estensione per importare ed esportare voci della rubrica di un telefono cellulare
 Comment[ja]=アドレス帳のエントリをインポート/エクスポートする携帯電話用プラグイン
Index: kaddressbook/xxport/kde2_xxport.cpp
===================================================================
--- kaddressbook/xxport/kde2_xxport.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/xxport/kde2_xxport.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -66,9 +66,10 @@
     proc << "--override";
   } else if ( result == KMessageBox::No )
     proc << "kab2kabc";
-  else
+  else {
     kDebug(5720) <<"KAddressBook::importKDE2(): Unknow return value.";
-
+    return KABC::AddresseeList();
+  }
   proc.execute();
 
   addressBook()->load();
Index: kaddressbook/xxport/eudora_xxport.desktop
===================================================================
--- kaddressbook/xxport/eudora_xxport.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/xxport/eudora_xxport.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -18,7 +18,7 @@
 Name[ga]=Breiseán Iompórtála/Easpórtála Eudora le haghaidh KAB
 Name[gl]=Engadido XXPort de Eudora para KA
 Name[he]=תוסף ייבוא/ייצוא עבור Eurdora של KAB
-Name[hu]=KAB Eudora XXPort bővítőmodul
+Name[hu]=KAB Eudora XXPort bővítmény
 Name[is]=Íforrit fyrir KAB Eudora XXPort
 Name[it]=Estensione XXPort di KAB per Eudora
 Name[ja]=KAB Eudora インポート/エクスポートプラグイン
Index: kaddressbook/searchmanager.cpp
===================================================================
--- kaddressbook/searchmanager.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/searchmanager.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -25,6 +25,65 @@
 
 #include <kabc/addresseelist.h>
 
+static QStringList phoneNumberValues( const KABC::Addressee &addressee,
+                                      KABC::PhoneNumber::Type type )
+{
+  QStringList result;
+
+  const KABC::PhoneNumber::List list = addressee.phoneNumbers( type );
+  foreach ( const KABC::PhoneNumber &number, list ) {
+    result << number.number();
+  }
+
+  return result;
+}
+
+typedef QString (KABC::Address::*AddressQStringGetter)() const;
+
+static QStringList addressValues( const KABC::Addressee &addressee,
+                                  KABC::Address::Type type,
+                                  AddressQStringGetter getter )
+{
+  QStringList result;
+
+  const KABC::Address::List list = addressee.addresses( type );
+  foreach ( const KABC::Address &address, list ) {
+    result << (address.*getter)();
+  }
+
+  return result;
+}
+
+static QStringList addressStreetValues( const KABC::Addressee &addressee,
+                                        KABC::Address::Type type )
+{
+  return addressValues( addressee, type, &KABC::Address::street );
+}
+
+static QStringList addressLocalityValues( const KABC::Addressee &addressee,
+                                          KABC::Address::Type type )
+{
+  return addressValues( addressee, type, &KABC::Address::locality );
+}
+
+static QStringList addressRegionValues( const KABC::Addressee &addressee,
+                                        KABC::Address::Type type )
+{
+  return addressValues( addressee, type, &KABC::Address::region );
+}
+
+static QStringList addressCountryValues( const KABC::Addressee &addressee,
+                                         KABC::Address::Type type )
+{
+  return addressValues( addressee, type, &KABC::Address::country );
+}
+
+static QStringList addressPostalCodeValues( const KABC::Addressee &addressee,
+                                            KABC::Address::Type type )
+{
+  return addressValues( addressee, type, &KABC::Address::postalCode );
+}
+
 using namespace KAB;
 
 SearchManager::SearchManager( KABC::AddressBook *ab,
@@ -92,26 +151,73 @@
     KABC::Field::List::ConstIterator fieldIt( fieldList.begin() );
     const KABC::Field::List::ConstIterator fieldEndIt( fieldList.end() );
     for ( ; fieldIt != fieldEndIt; ++fieldIt ) {
-
-      if ( type == StartsWith && (*fieldIt)->value( *it ).startsWith( pattern, Qt::CaseInsensitive ) ) {
+      QStringList values;
+      if ( (*fieldIt)->label() == KABC::Addressee::homeAddressStreetLabel() ) {
+        values = addressStreetValues( *it, KABC::Address::Home );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::homeAddressLocalityLabel() ) {
+        values = addressLocalityValues( *it, KABC::Address::Home );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::homeAddressRegionLabel() ) {
+        values = addressRegionValues( *it, KABC::Address::Home );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::homeAddressCountryLabel() ) {
+        values = addressCountryValues( *it, KABC::Address::Home );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::homeAddressPostalCodeLabel() ) {
+        values = addressPostalCodeValues( *it, KABC::Address::Home );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::businessAddressStreetLabel() ) {
+        values = addressStreetValues( *it, KABC::Address::Work );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::businessAddressLocalityLabel() ) {
+        values = addressLocalityValues( *it, KABC::Address::Work );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::businessAddressRegionLabel() ) {
+        values = addressRegionValues( *it, KABC::Address::Work );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::businessAddressCountryLabel() ) {
+        values = addressCountryValues( *it, KABC::Address::Work );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::businessAddressPostalCodeLabel() ) {
+        values = addressPostalCodeValues( *it, KABC::Address::Work );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::homePhoneLabel() ) {
+        values = phoneNumberValues( *it, KABC::PhoneNumber::Home );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::businessPhoneLabel() ) {
+        values = phoneNumberValues( *it, KABC::PhoneNumber::Work );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::carPhoneLabel() ) {
+        values = phoneNumberValues( *it, KABC::PhoneNumber::Car );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::isdnLabel() ) {
+        values = phoneNumberValues( *it, KABC::PhoneNumber::Isdn );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::pagerLabel() ) {
+        values = phoneNumberValues( *it, KABC::PhoneNumber::Pager );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::mobilePhoneLabel() ) {
+        values = phoneNumberValues( *it, KABC::PhoneNumber::Cell );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::homeFaxLabel() ) {
+        values = phoneNumberValues( *it, KABC::PhoneNumber::Home | KABC::PhoneNumber::Fax );
+      } else if ( (*fieldIt)->label() == KABC::Addressee::businessFaxLabel() ) {
+        values = phoneNumberValues( *it, KABC::PhoneNumber::Work | KABC::PhoneNumber::Fax);
+      } else if ( (*fieldIt)->label() == KABC::Addressee::emailLabel() ) {
+        values = (*it).emails();
+      } else {
+        values << (*fieldIt)->value( *it );
+      }
+      foreach ( const QString &value, values ) {
+        if ( type == StartsWith && value.startsWith( pattern, Qt::CaseInsensitive ) ) {
         mContacts.append( *it );
         found = true;
         break;
-      } else if ( type == EndsWith && (*fieldIt)->value( *it ).endsWith( pattern, Qt::CaseInsensitive ) ) {
+        } else if ( type == EndsWith && value.endsWith( pattern, Qt::CaseInsensitive ) ) {
         mContacts.append( *it );
         found = true;
         break;
-      } else if ( type == Contains && (*fieldIt)->value( *it ).contains( pattern, Qt::CaseInsensitive ) ) {
+        } else if ( type == Contains && value.contains( pattern, Qt::CaseInsensitive ) ) {
         mContacts.append( *it );
         found = true;
         break;
-      } else if ( type == Equals && (*fieldIt)->value( *it ).localeAwareCompare( pattern ) == 0 ) {
+        } else if ( type == Equals && value.localeAwareCompare( pattern ) == 0 ) {
         mContacts.append( *it );
         found = true;
         break;
       }
     }
 
+      if ( found ) {
+        break;
+      }
+    }
+
     if ( !found ) {
       // search over custom fields
       const QStringList customs = (*it).customs();
Index: kaddressbook/kabcore.cpp
===================================================================
--- kaddressbook/kabcore.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/kabcore.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -397,7 +397,7 @@
   mActionEditAddressee->setEnabled( singleSelected );
   mActionCopyAddresseeTo->setEnabled( someSelected && moreThanOneResource );
   mActionMoveAddresseeTo->setEnabled( someSelected && moreThanOneResource && writable );
-  mActionMail->setEnabled( someSelected && !mViewManager->selectedEmails().isEmpty());
+  mActionMail->setEnabled( someSelected && !mViewManager->selectedEmails( false ).isEmpty());
   mActionMailVCard->setEnabled( someSelected );
   mActionChat->setEnabled( singleSelected && mKIMProxy && mKIMProxy->initialize() );
   mActionWhoAmI->setEnabled( singleSelected );
@@ -519,9 +519,9 @@
 
 void KABCore::cutContacts()
 {
-  QStringList uidList = mViewManager->selectedUids();
+  const QStringList uidList = mViewManager->selectedUids();
 
-  if ( uidList.size() > 0 ) {
+  if ( !uidList.isEmpty() ) {
     CutCommand *command = new CutCommand( mAddressBook, uidList );
     mCommandHistory->push( command );
 
Index: kaddressbook/addresseeeditorextension.h
===================================================================
--- kaddressbook/addresseeeditorextension.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/addresseeeditorextension.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -52,10 +52,12 @@
     virtual QString identifier() const;
 
     QSize minimumSizeHint() const;
-
+  private slots:
+    void emitModifiedAddresses();
   private:
     AddresseeEditorBase *mAddresseeEditor;
     bool mDirty;
+    KABC::Addressee::List addressees;
 };
 
 #endif
Index: kaddressbook/viewmanager.h
===================================================================
--- kaddressbook/viewmanager.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/viewmanager.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -65,7 +65,15 @@
     void unloadViews();
 
     QStringList selectedUids() const;
-    QStringList selectedEmails() const;
+
+    /**
+      @param askForEMail if an addressee has more than one mail address
+                         and this parameter is true, a dialog will pop
+                         up and ask the user for the mail address to take.
+                         Otherwise, the preffered mail address will be taken
+     */
+    QStringList selectedEmails( bool askForEMail = true ) const;
+
     KABC::Addressee::List selectedAddressees() const;
 
     void setFilterSelectionWidget( FilterSelectionWidget *wdg );
Index: kaddressbook/addresseeeditorextension.cpp
===================================================================
--- kaddressbook/addresseeeditorextension.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/addresseeeditorextension.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -24,6 +24,7 @@
 #include "addresseeeditorextension.h"
 
 #include <QtGui/QVBoxLayout>
+#include <QTimer>
 
 #include <klocale.h>
 
@@ -51,17 +52,22 @@
 void AddresseeEditorExtension::contactsSelectionChanged()
 {
   const KABC::Addressee::List selectedAddressees = selectedContacts();
-  KABC::Addressee::List addressees;
-
+  KABC::Addressee::List modifiedAddress;
   if ( mAddresseeEditor->dirty() ) {
     mAddresseeEditor->save();
     addressees.append( mAddresseeEditor->addressee() );
-    emit modified( addressees );
+    modifiedAddress = addressees;
+    QTimer::singleShot(0, this, SLOT(emitModifiedAddresses()));
   }
   if( !selectedAddressees.isEmpty())
       mAddresseeEditor->setAddressee( selectedAddressees[ 0 ] );
 }
 
+void AddresseeEditorExtension::emitModifiedAddresses()
+{
+  emit modified( addressees );
+}
+
 QString AddresseeEditorExtension::title() const
 {
   return i18n( "Contact Editor" );
Index: kaddressbook/viewmanager.cpp
===================================================================
--- kaddressbook/viewmanager.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/viewmanager.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -145,10 +145,10 @@
     return QStringList();
 }
 
-QStringList ViewManager::selectedEmails() const
+QStringList ViewManager::selectedEmails(  bool askForEMail ) const
 {
-  if ( mActiveView && !mActiveView->selectedEmails().isEmpty() )
-    return QStringList( mActiveView->selectedEmails() );
+  if ( mActiveView && !mActiveView->selectedEmails( askForEMail ).isEmpty() )
+    return QStringList( mActiveView->selectedEmails( askForEMail ) );
   else
     return QStringList();
 }
Index: kaddressbook/kaddressbookview.cpp
===================================================================
--- kaddressbook/kaddressbookview.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/kaddressbookview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -69,7 +69,7 @@
   // Most of writing the config is handled by the ConfigureViewDialog
 }
 
-QString KAddressBookView::selectedEmails()
+QString KAddressBookView::selectedEmails( bool askForEMail )
 {
   bool first = true;
   QString emailAddrs;
@@ -84,8 +84,12 @@
     if ( !addr.isEmpty() ) {
       QString mail;
 
-      if ( addr.emails().count() > 1 )
-        mail = KABC::EmailSelector::getEmail( addr.emails(), addr.preferredEmail(), this );
+      if ( addr.emails().count() > 1 ) {
+        if ( askForEMail )
+          mail = KABC::EmailSelector::getEmail( addr.emails(), addr.preferredEmail(), this );
+        else
+          mail = addr.preferredEmail();
+      }
 
       email = addr.fullEmail( mail );
 
Index: kaddressbook/kabcdistlistupdater/kabcdistlistupdater.desktop
===================================================================
--- kaddressbook/kabcdistlistupdater/kabcdistlistupdater.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/kabcdistlistupdater/kabcdistlistupdater.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -16,6 +16,7 @@
 Comment[et]=Tööriist vanade postiloendite uuendamiseks uude vormingusse.
 Comment[fr]=Outil de conversion des anciennes listes de diffusion au nouveau format.
 Comment[gl]=Ferramenta para actualizar as listas de distribucións antigas ás novas.
+Comment[hu]=Régi címlistákat frissít.
 Comment[it]=Strumento per aggiornare le vecchie liste di distribuzioni al nuovo formato.
 Comment[ja]=古い配布リストを新しいものに更新するツール
 Comment[km]=ឧបករណ៍​សម្រាប់​ធ្វើ​ឲ្យ​បញ្ជី​ចែកចាយ​ចាស់ៗ​ទាន់សម័យ ។
Index: kaddressbook/features/distributionlistng.desktop
===================================================================
--- kaddressbook/features/distributionlistng.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kaddressbook/features/distributionlistng.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[et]=KAB postiloendi uue põlvkonna plugin
 Name[fr]=Module de liste de diffusion nouvelle génération pour KAB
 Name[gl]=Engadido da Nova Xeración de Listas de Distribución KAB
+Name[hu]=KAB címlista bővítőmodul
 Name[it]=Estensione lista di distribuzione KAB di nuova generazione
 Name[ja]=KAB 配布リスト次世代プラグイン
 Name[km]=កម្មវិធី​ជំនួយ​ជំនាន់​ក្រោយ​របស់​បញ្ជី​ចែកចាយ KAB
Index: ksendemail/mailerservice.cpp
===================================================================
--- ksendemail/mailerservice.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ ksendemail/mailerservice.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -147,8 +147,20 @@
     {
         mailto = true;
         for ( QStringList::Iterator it = attachList.begin() ; it != attachList.end() ; ++it )
+        {
             if ( !(*it).isEmpty() )
+            {
+              KUrl url( *it );
+
+              if ( url.protocol().isEmpty() )
+              {
+                const QString newUrl =  QDir::currentPath () + QDir::separator () + url.fileName();
+                attachURLs.append( newUrl );
+              }
+              else
                 attachURLs.append( *it );
+            }
+        }
     }
 
     customHeaders = args->getOptionList("header");
Index: plugins/kmail/bodypartformatter/text_xdiff.desktop
===================================================================
--- plugins/kmail/bodypartformatter/text_xdiff.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ plugins/kmail/bodypartformatter/text_xdiff.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -45,6 +45,7 @@
 Comment[fa]=یک وصلۀ قالب‌دهندۀ جزء بدنه برای text/x-patch
 Comment[fr]=Module de mise en forme du corps du message pour text/x-patch
 Comment[gl]=Un engadido para formatar o corpo do texto/x-patch
+Comment[hu]=Formázómodul text/x-patch adatok kezeléséhez
 Comment[it]=Un'estensione per la formattazione di text/x-patch nei messaggi di posta
 Comment[ja]=text/x-patch 用のメッセージ本体フォーマッタ
 Comment[kk]=Text/x-diff бөлімін пішімдеу модулі
Index: ktimetracker/ktimetrackerpart.desktop
===================================================================
--- ktimetracker/ktimetrackerpart.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ ktimetracker/ktimetrackerpart.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Composant KTimeTracker
 Name[ga]=Comhpháirt KTimeTracker
 Name[gl]=Compoñente KTimeTracker
+Name[hu]=KTimeTracker objektum
 Name[it]=Componente KTimeTracker
 Name[ja]=KTimeTracker コンポーネント
 Name[km]=សមាសភាគ​កម្មវិធីតាមដាន​របស់ KTime
Index: ktimetracker/kcmconfigs/ktimetrackerconfig.desktop
===================================================================
--- ktimetracker/kcmconfigs/ktimetrackerconfig.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ ktimetracker/kcmconfigs/ktimetrackerconfig.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -24,11 +24,13 @@
 Comment[da]=Indstil KTimeTracker
 Comment[de]=KDE-Zeitplaner einrichten
 Comment[el]=Ρύθμιση του ktimetracker
+Comment[en_GB]=Configure KTimeTracker
 Comment[es]=Configurar ktimetracker
 Comment[et]=KTimeTrackeri seadistamine
 Comment[fr]=Configurer KTimeTracker
 Comment[ga]=Cumraigh ktimetracker
 Comment[gl]=Configurar ktimetracker
+Comment[hu]=A KTimeTracker beállításai
 Comment[it]=Configura ktimetracker
 Comment[ja]=KTimeTracker の設定
 Comment[km]=កំណត់​រចនាសម្ព័ន្ធ ktimetracker
Index: kjots/Kjots.desktop
===================================================================
--- kjots/Kjots.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kjots/Kjots.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -16,6 +16,7 @@
 GenericName[fr]=Prise de note
 GenericName[ga]=Eagarthóir Nótaí
 GenericName[gl]=Caderno de Notas
+GenericName[hu]=Feljegyzéskezelő
 GenericName[it]=Blocco appunti
 GenericName[ja]=メモ帳
 GenericName[km]=កម្មវិធី​ទទួល​ចំណាំ
Index: libkdepim/kaddrbookexternal.cpp
===================================================================
--- libkdepim/kaddrbookexternal.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ libkdepim/kaddrbookexternal.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -176,10 +176,10 @@
       }
     }
   }
-
   kabcResource =
     static_cast<KABC::Resource*>( KRES::SelectDialog::getResource( kresResources, 0 ) );
-
+  if( !kabcResource ) 
+    return false;
   KABC::Ticket *ticket = addressBook->requestSaveTicket( kabcResource );
   bool saved = false;
   if ( ticket ) {
Index: libkdepim/addresseelineedit.cpp
===================================================================
--- libkdepim/addresseelineedit.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ libkdepim/addresseelineedit.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -747,6 +747,12 @@
 
 void AddresseeLineEdit::slotStartLDAPLookup()
 {
+  KGlobalSettings::Completion  mode = completionMode();
+
+  if ( mode == KGlobalSettings::CompletionNone ) {
+    return;
+  }
+
   if ( !s_LDAPSearch->isAvailable() ) {
     return;
   }
Index: console/kabcclient/doc/examples/letters/work_address.desktop
===================================================================
--- console/kabcclient/doc/examples/letters/work_address.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ console/kabcclient/doc/examples/letters/work_address.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -13,6 +13,7 @@
 Name[fr]=Adresse postale professionnelle
 Name[ga]=Seoladh gnó/oibre
 Name[gl]=Enderezo postal do traballo
+Name[hu]=Üzleti levél/munkahelyi cím
 Name[it]=Indirizzo postale di lavoro/affari
 Name[ja]=ビジネス/仕事の手紙の宛先
 Name[km]=អាសយដ្ឋាន​សំបុត្រ​​កន្លែង​ធ្វើការ/ការងារ
Index: console/kabcclient/doc/examples/letters/home_address.desktop
===================================================================
--- console/kabcclient/doc/examples/letters/home_address.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ console/kabcclient/doc/examples/letters/home_address.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -13,6 +13,7 @@
 Name[fr]=Adresse postale personnelle
 Name[ga]=Seoladh baile/pearsanta
 Name[gl]=Enderezo postal persoal/do fogar
+Name[hu]=Privát levél/otthoni cím
 Name[it]=Indirizzo postale di casa/privato
 Name[ja]=プライベートの手紙の宛先
 Name[km]=អាសយដ្ឋាន​សំបុត្រ​ផ្ទះ/ឯកជន
Index: kpilot/conduits/keyringconduit/kpilot-conduit-keyring.desktop
===================================================================
--- kpilot/conduits/keyringconduit/kpilot-conduit-keyring.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kpilot/conduits/keyringconduit/kpilot-conduit-keyring.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -11,6 +11,7 @@
 Comment[et]=See kanal sünkroniseerib pihuarvuti võtmerõnga andmebaasi ja PC-s leiduva andmebaasi.
 Comment[fr]=Ce canal synchronise le trousseau de clés de l'ordinateur de poche avec une base de données sur votre ordinateur.
 Comment[gl]=Este conduto sincroniza o base de datos do chaveiro dun aparello portátil cunha base de datos almacenada no computador.
+Comment[hu]=Ezzel a csatolóval egy kéziszámítógép-kulcslista és valamilyen számítógépes adatbázis között lehet szinkronizálást végezni.
 Comment[it]=Questo condotto sincronizza il portachiavi del tuo palmare con un database archiviato sul PC.
 Comment[ja]=このコンジットはハンドヘルドのキーリングデータベースを PC のデータベースと同期させます。
 Comment[km]=conduit syncs នេះ​មូលដ្ឋាន​ទិន្នន័យ keyring របស់​ឧបករណ៍​យួរដៃ​ជា​មួយ​មូលដ្ឋាន​ទិន្នន័យ​ដែល​បាន​ផ្ទុក​នៅ​ក្នុង​កុំព្យូទ័រ ។
@@ -42,6 +43,7 @@
 Name[fr]=Trousseau de clés
 Name[ga]=Fáinne Eochracha
 Name[gl]=Chaveiro
+Name[hu]=Kulcslista
 Name[it]=Portachiavi
 Name[ja]=鍵リング
 Name[lt]=Raktų ratas
Index: kpilot/conduits/malconduit/mal_conduit.desktop
===================================================================
--- kpilot/conduits/malconduit/mal_conduit.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kpilot/conduits/malconduit/mal_conduit.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -56,6 +56,7 @@
 Comment[fr]=Synchronise AvantGo (ou plus généralement tout serveur MAL) avec votre périphérique. Ceci vous permet de consulter des pages Web hors ligne sur votre Palm, comme des programmes TV, Cinéma ou n'importe quelle page Web.
 Comment[ga]=Sioncrónaigh AvantGo (nó, níos ginearálta, an t-ábhar ar fhreastalaí MAL) leis an ríomhaire boise. Ceadaíonn sé seo duit leathanaigh Ghréasáin a léamh as líne ar do ríomhaire boise, mar shampla sceideal teilifíse nó scannáin, nó leathanach ar bith eile.
 Comment[gl]=Sincronizar AvantGo (ou xeralmente o contido dun servidor MAL) co dispositivo móbil. Isto permi­te ver páxinas web fóra de liña, como o horario da TV ou do cine, ou calquera outra páxina. 
+Comment[hu]=AvantGo (vagy MAL-kiszolgáló) adatainak szinkronizálása a kézi számítógéppel. Lehetővé teszi weboldalak megtekintését internetkapcsolat nélküli módban, például egy mozi vagy egy tévécsatorna műsorfüzetét.
 Comment[it]=Sincronizza AvantGo (o il contenuto di un generico server MAL) con il palmare. In questo modo potrai visualizzare le pagine web fuori linea sul palmare, come per esempio la programmazione di un cinema o una TV o qualsiasi altra pagina web.
 Comment[ja]=AvantGo (または一般に MAL サーバのコンテンツ) とハンドヘルドを同期させます。これにより、ハンドヘルドで映画やテレビ番組表、その他のウェブページをオフラインで閲覧できるようになります。
 Comment[km]=ធ្វើ​សមកាល​កម្ម AvantGo (ឬ​ជា​ទូទៅ​មាតិកា​របស់​ម៉ាស៊ីន​​បម្រើ MAL) ទៅ​កាន់​ឧបករណ៍​យួរដៃ ។វា​អនុញ្ញាត​ឲ្យ​អ្នក​​មើល​ទំព័រ​បណ្ដាញ​​ខាង​ក្រៅនៅ​លើ​ឧបករណ៍​យួរដៃ ដូច​ជា​ម៉ាស៊ីន​ថត ទូរទស្សន៍​របស់ ឬ​ទំព័រ​​បណ្ដាញ​ផ្សេងៗ​ទៀត ។
Index: kpilot/conduits/todo/kpilot-conduit-todo.desktop
===================================================================
--- kpilot/conduits/todo/kpilot-conduit-todo.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kpilot/conduits/todo/kpilot-conduit-todo.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Comment[et]=See kanal sünkroniseerib pihuarvuti ülesannete andmebaasi ja Akonadi ülesannete kogu.
 Comment[fr]=Ce canal synchronise la liste de tâches du périphérique avec une collection de liste de tâches Akonadi.
 Comment[gl]=Este conduto sincroniza o base de datos do chaveiro do aparello portátil coa colección da Tarefas do Akonadi.
+Comment[hu]=Ezzel a csatolóval egy kéziszámítógép feladatai és egy Akonadi-feladatgyűjtemény között lehet szinkronizálást végezni.
 Comment[it]=Questo condotto sincronizza l'elenco delle cose da fare del tuo palmare con una collezione di cose da fare di Akonadi.
 Comment[ja]=このコンジットはハンドヘルドの To-Do データベースを Akonadi の To-Do コレクションと同期させます。
 Comment[km]=conduit syncs នេះ​ជា​មូលដ្ឋាន​ទិន្នន័យ​ការងារ​ត្រូវ​ធ្វើ​ជា​មួយ​នឹង​ការ​ប្រមូលផ្ដុំ​ការងារ​ត្រូវ​ធ្វើ​របស់ Akonadi ។
@@ -40,6 +41,7 @@
 Name[fr]=Liste de tâches
 Name[ga]=Tascanna
 Name[gl]=Tarefas Pendentes 
+Name[hu]=Feladat
 Name[it]=Cose da fare
 Name[ja]=To-Do
 Name[km]=​ការងារ​ត្រូវ​ធ្វើ
Index: kpilot/conduits/calendar/kpilot-conduit-calendar.desktop
===================================================================
--- kpilot/conduits/calendar/kpilot-conduit-calendar.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kpilot/conduits/calendar/kpilot-conduit-calendar.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Comment[fr]=Ce canal synchronise l'agenda du périphérique avec une collection d'agenda Akonadi.
 Comment[ga]=Sioncrónaíonn an seoladán seo an bunachar sonraí féilire ar do ríomhaire boise le Bailiúchán féilirí Akonadi.
 Comment[gl]=Este conduto sincroniza a base de datos dun aparello móbil coa colección de calendarios do Akonadi
+Comment[hu]=Ezzel a csatolóval egy kéziszámítógépes naptár és valamilyen számítógépes adatbázis között lehet szinkronizálást végezni.
 Comment[it]=Questo condotto sincronizza il calendario del tuo palmare con una collezione calendario di Akonadi.
 Comment[ja]=このコンジットはハンドヘルドのカレンダーデータベースを Akonadi のカレンダーコレクションと同期させます。
 Comment[km]=មូលដ្ឋាន​ទិន្នន័យ conduit syncs នេះ​​ជា​មួយ​បណ្ដុំ​ប្រតិទិន​របស់ Akonadi ។
Index: kpilot/conduits/contacts/kpilot-conduit-contacts.desktop
===================================================================
--- kpilot/conduits/contacts/kpilot-conduit-contacts.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kpilot/conduits/contacts/kpilot-conduit-contacts.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -5,11 +5,13 @@
 Comment[da]=Denne kanal synkroniserer den håndholdtes adressebogs-database med en Akonadi-samling.
 Comment[de]=Abgleich der Adressbücher von Taschencomputer und Akonadi-Ressourcen.
 Comment[el]=Αυτό το κύκλωμα συγχρονίζει το βιβλίο διευθύνσεων του υπολογιστή παλάμης με μια συλλογή του Akonadi.
+Comment[en_GB]=This conduit syncs the handheld address book database with an Akonadi collection.
 Comment[es]=Este conducto sincroniza la base de datos de la libreta de direcciones de la agenda electrónica con una colección Akonadi.
 Comment[et]=See kanal sünkroniseerib pihuarvuti aadressiraamatu andmebaasi Akonadi koguga.
 Comment[fr]=Ce canal synchronise le carnet d'adresse du périphérique avec une collection Akonadi.
 Comment[ga]=Sioncrónaíonn an seoladán seo bunachar sonraí an leabhair seoltaí ar do ríomhaire boise le Bailiúchán Akonadi.
 Comment[gl]=Este conduto sincroniza o caderno de enderezos do aparello móbil coa colección de calendarios do Akonadi
+Comment[hu]=Ezzel a csatolóval egy kéziszámítógépes címjegyzék és egy Akonadi-alapú gyűjtemény között lehet szinkronizálást végezni.
 Comment[it]=Questo condotto sincronizza la rubrica del tuo palmare con una collezione di Akonadi.
 Comment[ja]=このコンジットはハンドヘルドのアドレス帳データベースを Akonadi のコレクションと同期させます。
 Comment[km]=conduit syncs នេះ​ជា​មូលដ្ឋាន​​សៀវភៅ​អាសយដ្ឋាន​ឧបករណ៍​​​យួរដៃ​ដែល​មាន​បណ្ដុំ Akonadi ។
Index: kpilot/Documentation/base-conduit-template/kpilot-conduit-contacts.desktop
===================================================================
--- kpilot/Documentation/base-conduit-template/kpilot-conduit-contacts.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kpilot/Documentation/base-conduit-template/kpilot-conduit-contacts.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -11,6 +11,7 @@
 Comment[et]=See kanal sünkroniseerib pihuarvuti võtmerõnga andmebaasi ja PC-s leiduva andmebaasi.
 Comment[fr]=Ce canal synchronise le trousseau de clés de l'ordinateur de poche avec une base de données sur votre ordinateur.
 Comment[gl]=Este conduto sincroniza o base de datos do chaveiro dun aparello portátil cunha base de datos almacenada no computador.
+Comment[hu]=Ezzel a csatolóval egy kéziszámítógép-kulcslista és valamilyen számítógépes adatbázis között lehet szinkronizálást végezni.
 Comment[it]=Questo condotto sincronizza il portachiavi del tuo palmare con un database archiviato sul PC.
 Comment[ja]=このコンジットはハンドヘルドのキーリングデータベースを PC のデータベースと同期させます。
 Comment[km]=conduit syncs នេះ​មូលដ្ឋាន​ទិន្នន័យ keyring របស់​ឧបករណ៍​យួរដៃ​ជា​មួយ​មូលដ្ឋាន​ទិន្នន័យ​ដែល​បាន​ផ្ទុក​នៅ​ក្នុង​កុំព្យូទ័រ ។
Index: kpilot/Documentation/base-conduit-template/contacts-conduit.desktop
===================================================================
--- kpilot/Documentation/base-conduit-template/contacts-conduit.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kpilot/Documentation/base-conduit-template/contacts-conduit.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -5,11 +5,13 @@
 Comment[da]=Denne kanal synkroniserer den håndholdtes adressebog med en database lagret på pc'en.
 Comment[de]=Abgleich des Addressbuchs von Taschencomputer und PC.
 Comment[el]=Αυτό το κύκλωμα συγχρονίζει το βιβλίο διευθύνσεων του υπολογιστή παλάμης με τη βάση δεδομένων του υπολογιστή.
+Comment[en_GB]=This conduit syncs the handheld address book with a database stored on the PC.
 Comment[es]=Este conducto sincroniza la libreta de direcciones de la agenda electrónica con la base de datos almacenada en el equipo.
 Comment[et]=See kanal sünkroniseerib pihuarvuti aadressiraamatu PC-s leiduva andmebaasiga.
 Comment[fr]=Ce canal synchronise le carnet d'adresse du périphérique avec une base de données sur votre ordinateur.
 Comment[ga]=Sioncrónaíonn an seoladán seo leabhar seoltaí an ríomhaire boise le bunachar sonraí ar an ríomhaire deisce.
 Comment[gl]=Este conduto sincroniza o caderno de enderezos dun aparello portátil cunha base de datos almacenada no computador.
+Comment[hu]=Ezzel a csatolóval egy kéziszámítógép-címjegyzék és valamilyen számítógépes adatbázis között lehet szinkronizálást végezni.
 Comment[it]=Questo condotto sincronizza la rubrica del tuo palmare con un database archiviato sul PC.
 Comment[ja]=このコンジットはハンドヘルドのアドレス帳を PC のデータベースと同期させます。
 Comment[km]=conduit syncs នេះ​ជា​សៀវភៅ​អាសយដ្ឋាន​ដែល​មាន​ទិន្នន័យ​បាន​ផ្ទុក​នៅ​ក្នុង​កុំព្យូទ័រ ។
Index: kontact/plugins/akregator/akregator.setdlg
===================================================================
--- kontact/plugins/akregator/akregator.setdlg	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/akregator/akregator.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -62,6 +62,7 @@
 Comment[fr]=Lecteur de flux
 Comment[ga]=Léitheoir Fothaí
 Comment[gl]=Lector de Novas
+Comment[hu]=Hírolvasó
 Comment[it]=Lettore di fonti
 Comment[ja]=フィードリーダー
 Comment[km]=កម្មវិធី​អាន​មតិព័ត៌មាន
Index: kontact/plugins/planner/planner.setdlg
===================================================================
--- kontact/plugins/planner/planner.setdlg	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/planner/planner.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -8,6 +8,7 @@
 Name[fr]=Agenda
 Name[ga]=Pleanálaí
 Name[gl]=Planificador
+Name[hu]=Tervező
 Name[it]=Agenda
 Name[ja]=スケジュール帳
 Name[km]=កម្មវិធីធ្វើ​គម្រោង
@@ -38,6 +39,7 @@
 Comment[fr]=Résumé de l'agenda
 Comment[ga]=Achoimre Pleanálaí
 Comment[gl]=Resumo do Planificador
+Comment[hu]=Terváttekintő
 Comment[it]=Vista Sommario agenda
 Comment[ja]=スケジュール帳の要約
 Comment[km]=សេចក្ដី​សង្ខេប​របស់​កម្មវិធីធ្វើ​គម្រោង
Index: kontact/plugins/planner/kcmplanner.desktop
===================================================================
--- kontact/plugins/planner/kcmplanner.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/planner/kcmplanner.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -20,6 +20,7 @@
 Name[fr]=Agenda
 Name[ga]=Pleanálaí
 Name[gl]=Planificador
+Name[hu]=Tervező
 Name[it]=Agenda
 Name[ja]=スケジュール帳
 Name[km]=កម្មវិធីធ្វើ​គម្រោង
@@ -50,6 +51,7 @@
 Comment[fr]=Configuration de l'agenda
 Comment[ga]=Socrú Pleanálaí
 Comment[gl]=Configuración do Planificador
+Comment[hu]=Tervező-beállítások
 Comment[it]=Impostazioni agenda
 Comment[ja]=スケジュール帳の設定
 Comment[km]=កា​ររៀបចំ​កម្មវិធី​ធ្វើ​គម្រោង
Index: kontact/plugins/planner/plannerplugin.desktop
===================================================================
--- kontact/plugins/planner/plannerplugin.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/planner/plannerplugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -22,6 +22,7 @@
 Name[fr]=Agenda
 Name[ga]=Pleanálaí
 Name[gl]=Planificador
+Name[hu]=Tervező
 Name[it]=Agenda
 Name[ja]=スケジュール帳
 Name[km]=កម្មវិធីធ្វើ​គម្រោង
@@ -52,6 +53,7 @@
 Comment[fr]=Module d'agenda
 Comment[ga]=Breiseán Pleanálaí
 Comment[gl]=Engadido do Planificador
+Comment[hu]=Tervező bővítmény
 Comment[it]=Estensione agenda
 Comment[ja]=スケジュール帳プラグイン
 Comment[km]=កម្មវិធី​ជំនួយ​​របស់​កម្មវិធី​ធ្វើ​គម្រោង
Index: kontact/plugins/knode/knode.setdlg
===================================================================
--- kontact/plugins/knode/knode.setdlg	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/knode/knode.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -19,6 +19,7 @@
 Comment[fr]=Composant de forums Usenet
 Comment[ga]=Comhpháirt Usenet
 Comment[gl]=Compoñente de Usenet
+Comment[hu]=Usenet-kezelő objektum
 Comment[it]=Componente Usenet
 Comment[ja]=Usenet コンポーネント
 Comment[kk]=Пошта компоненті
Index: kontact/plugins/specialdates/kcmsdsummary.desktop
===================================================================
--- kontact/plugins/specialdates/kcmsdsummary.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/specialdates/kcmsdsummary.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -25,6 +25,7 @@
 Name[fr]=Prochaines dates particulières
 Name[ga]=Dátaí Speisialta Le Teacht
 Name[gl]=Vindeiras Datas Especiais
+Name[hu]=Fontos dátumok a közeljövőben
 Name[it]=Date speciali future
 Name[ja]=近日中の特別な日
 Name[kk]=Болашақ ерекше күндер
@@ -65,6 +66,7 @@
 Comment[fr]=Configuration du résumé des dates particulières
 Comment[ga]=Socrú Achoimre ar Dhátaí Speisialta Le Teacht
 Comment[gl]=Configuración do Resumo das Vindeiras Datas Especiais
+Comment[hu]=A közeli fontos dátumok áttekintőjének beállításai
 Comment[it]=Impostazioni per il sommario delle date speciali future
 Comment[ja]=近日中の特別な日の要約設定
 Comment[kk]=Болашақ ерекше күндер тұжырымының баптау
Index: kontact/plugins/kmobiletools/kmobiletools.setdlg
===================================================================
--- kontact/plugins/kmobiletools/kmobiletools.setdlg	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/kmobiletools/kmobiletools.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -12,6 +12,7 @@
 Name[fr]=Téléphones portables
 Name[ga]=Fóin Phóca
 Name[gl]=Teléfonos Móbeis
+Name[hu]=Mobiltelefonok
 Name[it]=Telefoni cellulari
 Name[ja]=携帯電話
 Name[km]=ទូរស័ព្ទ​ចល័ត
@@ -48,6 +49,7 @@
 Comment[fr]=Composant de gestion de téléphone portable
 Comment[ga]=Comhpháirt Fón Póca
 Comment[gl]=Componente para Teléfonos Móbeis
+Comment[hu]=Mobiltelefon-kezelő objektum
 Comment[it]=Componente telefoni cellulari
 Comment[ja]=携帯電話コンポーネント
 Comment[km]=សមាសភាគ​ទូរស័ព្ទ​ចល័ត
Index: kontact/plugins/kmobiletools/kmobiletools.desktop
===================================================================
--- kontact/plugins/kmobiletools/kmobiletools.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/kmobiletools/kmobiletools.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -23,6 +23,7 @@
 Comment[fr]=Module externe KMobileTools
 Comment[ga]=Breiseán KMobileTools
 Comment[gl]=Engadido KMobileTools
+Comment[hu]=KMobileTools bővítmény
 Comment[it]=Estensione di KMobileTools
 Comment[ja]=KMobileTools プラグイン
 Comment[km]=កម្មវិធី​ជំនួយ​របស់ KMmobileTools
@@ -58,6 +59,7 @@
 Name[fr]=Téléphones portables
 Name[ga]=Fóin Phóca
 Name[gl]=Teléfonos Móbeis
+Name[hu]=Mobiltelefonok
 Name[it]=Telefoni cellulari
 Name[ja]=携帯電話
 Name[km]=ទូរស័ព្ទ​ចល័ត
Index: kontact/plugins/knotes/knotes.setdlg
===================================================================
--- kontact/plugins/knotes/knotes.setdlg	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/knotes/knotes.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Affichage de petites notes
 Name[ga]=Preabnótaí
 Name[gl]=Notas Emerxentes
+Name[hu]=Jegyzetlapok
 Name[it]=Note a comparsa
 Name[ja]=ポップアップメモ
 Name[km]=ចំណាំ​លេច​ឡើង
@@ -45,6 +46,7 @@
 Comment[fr]=Composant de petites de notes
 Comment[ga]=Comhpháirt Preabnótaí
 Comment[gl]=Compoñente de Notas Emerxentes
+Comment[hu]=Jegyzetlap objektum
 Comment[it]=Componente note a comparsa
 Comment[ja]=ポップアップメモコンポーネント
 Comment[km]=សមាសភាគ​ចំណាំលេចឡើង​
Index: kontact/plugins/knotes/knotesplugin.desktop
===================================================================
--- kontact/plugins/knotes/knotesplugin.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/knotes/knotesplugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -80,6 +80,7 @@
 Name[fr]=Affichage de petites notes
 Name[ga]=Preabnótaí
 Name[gl]=Notas Emerxentes
+Name[hu]=Jegyzetlapok
 Name[it]=Note a comparsa
 Name[ja]=ポップアップメモ
 Name[km]=ចំណាំ​លេច​ឡើង
Index: kontact/plugins/ktimetracker/ktimetracker_plugin.cpp
===================================================================
--- kontact/plugins/ktimetracker/ktimetracker_plugin.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/ktimetracker/ktimetracker_plugin.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -57,6 +57,7 @@
 
 ktimetrackerplugin::~ktimetrackerplugin()
 {
+  delete mInterface;
 }
 
 bool ktimetrackerplugin::isRunningStandalone()
Index: kontact/plugins/ktimetracker/ktimetracker.setdlg
===================================================================
--- kontact/plugins/ktimetracker/ktimetracker.setdlg	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/ktimetracker/ktimetracker.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Suivi du temps
 Name[ga]=TimeTracker
 Name[gl]=Xestor Temporal
+Name[hu]=Időfelhasználás-figyelő
 Name[it]=Conteggio tempo
 Name[ja]=タイムトラッカー
 Name[km]=កម្មវិធី​តាមដាន​ពេលវេលា
@@ -43,6 +44,7 @@
 Comment[fr]=Composant de suivi du temps
 Comment[ga]=Comhpháirt TimeTracker
 Comment[gl]=Compoñente de Xestor Temporal
+Comment[hu]=Időfelhasználás-figyelő objektum
 Comment[it]=Componente conteggio tempo
 Comment[ja]=タイムトラッカーコンポーネント
 Comment[km]=សមាសភាគ​កម្មវិធី​តាមដាន​ពេលវេលា
Index: kontact/plugins/ktimetracker/ktimetracker_plugin.desktop
===================================================================
--- kontact/plugins/ktimetracker/ktimetracker_plugin.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/ktimetracker/ktimetracker_plugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -25,6 +25,7 @@
 Comment[fr]=Module de suivi du temps
 Comment[ga]=Breiseán TimeTracker
 Comment[gl]=Engadido TimeTracker
+Comment[hu]=Időfelhasználás-figyelő bővítmény
 Comment[it]=Estensione barra orologio
 Comment[ja]=タイムトラッカープラグイン
 Comment[km]=កម្មវិធី​ជំនួយ TimeTracker
@@ -59,6 +60,7 @@
 Name[fr]=Suivi du temps
 Name[ga]=TimeTracker
 Name[gl]=Xestor Temporal
+Name[hu]=Időfelhasználás-figyelő
 Name[it]=Conteggio tempo
 Name[ja]=タイムトラッカー
 Name[km]=កម្មវិធី​តាមដាន​ពេលវេលា
Index: kontact/plugins/kjots/kjots_plugin.desktop
===================================================================
--- kontact/plugins/kjots/kjots_plugin.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/kjots/kjots_plugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -27,6 +27,7 @@
 Comment[fr]=Module KJots pour Kontact
 Comment[ga]=Breiseán KJots le haghaidh Kontact
 Comment[gl]=Engadido de KJots para Kontact
+Comment[hu]=Kontact KJots-bővítmény
 Comment[it]=Estensione per Kontact di KJots
 Comment[ja]=Kontact KJots プラグイン
 Comment[km]=កម្មវិធី​ជំនួយ​ទំនាក់ទំនង KJots
@@ -59,6 +60,7 @@
 Name[fr]=Carnets de notes
 Name[ga]=Leabhair Nótaí
 Name[gl]=Cadernos
+Name[hu]=Jegyzetfüzetek
 Name[it]=Blocco appunti
 Name[ja]=メモ帳
 Name[km]=សៀវភៅ​ចំណាំ
Index: kontact/plugins/kjots/kjots.setdlg
===================================================================
--- kontact/plugins/kjots/kjots.setdlg	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/kjots/kjots.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[fr]=Carnets de notes
 Name[ga]=Leabhair Nótaí
 Name[gl]=Cadernos
+Name[hu]=Jegyzetfüzetek
 Name[it]=Blocco appunti
 Name[ja]=メモ帳
 Name[km]=សៀវភៅ​ចំណាំ
@@ -43,6 +44,7 @@
 Comment[fr]=Composant de carnet de notes
 Comment[ga]=Comhpháirt Leabhair Nótaí
 Comment[gl]=Compoñente de Notebooks
+Comment[hu]=Jegyzetfüzet-komponens
 Comment[it]=Componente blocco appunti
 Comment[ja]=メモ帳コンポーネント
 Comment[km]=សមាសភាគ​សៀវភៅ​
Index: kontact/plugins/korganizer/kcmapptsummary.desktop
===================================================================
--- kontact/plugins/korganizer/kcmapptsummary.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/korganizer/kcmapptsummary.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -23,6 +23,7 @@
 Name[fr]=Prochains évènements
 Name[ga]=Imeachtaí atá ag teacht
 Name[gl]=Eventos Vindeiros
+Name[hu]=Események a közeljövőben
 Name[it]=Eventi futuri
 Name[ja]=近日中のイベント
 Name[kk]=Болашақ оқиғалар
@@ -62,6 +63,7 @@
 Comment[fr]=Configuration du résumé des prochains évènements
 Comment[ga]=Socrú Achoimre ar Imeachtaí atá ag teacht
 Comment[gl]=Configuración do Resumo de Eventos Vindeiros
+Comment[hu]=A közelgő események áttekintőjének beállításai
 Comment[it]=Impostazioni sommario degli eventi futuri
 Comment[ja]=近日中のイベントの要約設定
 Comment[kk]=Болашақ оқигалар тұжырымының баптау
Index: kontact/plugins/korganizer/kcmtodosummary.desktop
===================================================================
--- kontact/plugins/korganizer/kcmtodosummary.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/korganizer/kcmtodosummary.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -23,6 +23,7 @@
 Name[fr]=Tâches en cours
 Name[ga]=Tascanna Le Déanamh
 Name[gl]=Tarefas Pendentes
+Name[hu]=Feladatok a közeljövőben
 Name[it]=Cose da fare in attesa
 Name[ja]=未決 To-Do
 Name[kk]=Кейінге қалдырылған жоспарлар
@@ -62,6 +63,7 @@
 Comment[fr]=Configuration du résumé des tâches en cours
 Comment[ga]=Socrú Achoimre ar Thascanna Le Déanamh
 Comment[gl]=Configuración do resumo de tarefas pendentes
+Comment[hu]=A közelgő feladatok áttekintőjének beállítása
 Comment[it]=Impostazioni sommario cose da fare
 Comment[ja]=未決 To-Do の要約設定
 Comment[kk]=Кейінге қалдырылған жоспарлар тұжырымының баптау
Index: kontact/plugins/kmail/kcmkmailsummary.desktop
===================================================================
--- kontact/plugins/kmail/kcmkmailsummary.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/kmail/kcmkmailsummary.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -26,6 +26,7 @@
 Name[fr]=Nouveaux messages
 Name[ga]=Teachtaireachtaí Nua
 Name[gl]=Mensaxes Novas
+Name[hu]=Új üzenetek
 Name[it]=Nuovi messaggi
 Name[ja]=未読メッセージ
 Name[kk]=Жаңа хабарламалар
Index: kontact/plugins/summary/kcmkontactsummary.desktop
===================================================================
--- kontact/plugins/summary/kcmkontactsummary.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/summary/kcmkontactsummary.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -22,6 +22,7 @@
 Name[fr]=Résumés
 Name[ga]=Achoimrí
 Name[gl]=Resumos
+Name[hu]=Áttekintők
 Name[it]=Sommari
 Name[ja]=要約
 Name[km]=សេចក្ដីសង្ខេប
@@ -57,6 +58,7 @@
 Comment[fr]=Sélection des résumés
 Comment[ga]=Roghnú Achoimrí
 Comment[gl]=Selección de Resumos
+Comment[hu]=Áttekintőválasztó
 Comment[it]=Selezione sommario
 Comment[ja]=表示する要約を選択
 Comment[km]=ជម្រើស​សេចក្ដី​សង្ខេប
Index: kontact/plugins/newsticker/newsticker.setdlg
===================================================================
--- kontact/plugins/newsticker/newsticker.setdlg	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/newsticker/newsticker.setdlg	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -19,7 +19,7 @@
 Name[gl]=Colector de Novas
 Name[he]=חדשות רצות
 Name[hr]=Ticker sa novostima
-Name[hu]=RSS hírmegjelenítő
+Name[hu]=RSS-hírmegjelenítő
 Name[is]=Fréttastrimill
 Name[it]=Ticker notizie
 Name[ja]=ニュースティッカー
Index: kontact/plugins/newsticker/kcmkontactknt.desktop
===================================================================
--- kontact/plugins/newsticker/kcmkontactknt.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/plugins/newsticker/kcmkontactknt.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -25,6 +25,7 @@
 Name[fr]=Flux de nouvelles
 Name[ga]=Fothaí Nuachta
 Name[gl]=Fontes de Novas
+Name[hu]=Hírcsatornák
 Name[it]=Fonti notizie
 Name[ja]=ニュースフィード
 Name[kk]=Ақпарлар
Index: kontact/src/mainwindow.cpp
===================================================================
--- kontact/src/mainwindow.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ kontact/src/mainwindow.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -579,7 +579,6 @@
 bool MainWindow::removePlugin( const KPluginInfo &info )
 {
   PluginList::Iterator end = mPlugins.end();
-  ActionPluginList::Iterator it2 = mActionPlugins.begin();
   for ( PluginList::Iterator it = mPlugins.begin(); it != end; ++it ) {
     Plugin *plugin = *it;
     if ( ( *it )->identifier() == info.pluginName() ) {
@@ -608,8 +607,10 @@
       plugin->deleteLater(); // removes the part automatically
       mPlugins.erase( it );
       if ( plugin->showInSideBar() ) {
-        delete *it2; // remove the KAction, so we free the shortcut for later us
-        mActionPlugins.erase( it2 );
+        QAction *q = mPluginAction[plugin]; // remove the KAction, so we free the shortcut for later us
+        mActionPlugins.remove( q );
+        mPluginAction.remove(plugin);
+        delete q;
       }
 
       if ( mCurrentPlugin == 0 ) {
@@ -624,9 +625,6 @@
       return true;
     }
 
-    if ( plugin->showInSideBar() ) {
-      it2++;
-    }
   }
 
   return false;
Index: knotes/knote.cpp
===================================================================
--- knotes/knote.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knotes/knote.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -84,7 +84,7 @@
 KNote::KNote( const QDomDocument& buildDoc, Journal *j, QWidget *parent )
   : QFrame( parent, Qt::FramelessWindowHint ), m_label( 0 ), m_grip( 0 ),
     m_button( 0 ), m_tool( 0 ), m_editor( 0 ), m_config( 0 ), m_journal( j ),
-    m_find( 0 ), m_kwinConf( KSharedConfig::openConfig( "kwinrc" ) ), m_blockEmitDataChanged( false )
+    m_find( 0 ), m_kwinConf( KSharedConfig::openConfig( "kwinrc" ) ), m_blockEmitDataChanged( false ),mBlockWriteConfigDuringCommitData( false )
 {
   setAcceptDrops( true );
   setAttribute( Qt::WA_DeleteOnClose );
@@ -332,6 +332,12 @@
   updateFocus();
 }
 
+
+void KNote::commitData()
+{
+  mBlockWriteConfigDuringCommitData = true;
+}
+
 void KNote::slotClose()
 {
 #ifdef Q_WS_X11
@@ -344,9 +350,12 @@
 #endif
 
   m_editor->clearFocus();
-  m_config->setHideNote( true );
-  m_config->setPosition( pos() );
-  m_config->writeConfig();
+  if( !mBlockWriteConfigDuringCommitData )
+  {
+    m_config->setHideNote( true );
+    m_config->setPosition( pos() );
+    m_config->writeConfig();
+  }
   // just hide the note so it's still available from the dock window
   hide();
 }
@@ -1039,25 +1048,36 @@
 
 void KNote::updateFocus()
 {
-  if ( hasFocus() ) {
+  if ( hasFocus() )
+  {
     m_button->show();
 
-    if ( !m_editor->isReadOnly() ) {
-      if ( m_tool && m_tool->isHidden() && m_editor->acceptRichText() ) {
-        m_tool->show();
-	m_grip->show();
-        setGeometry( x(), y(), width(), height() + m_tool->height() );
-      }
-    } else if ( m_tool && !m_tool->isHidden() ) {
-      m_tool->hide();
-      setGeometry( x(), y(), width(), height() - m_tool->height() );
-      updateLayout();     // to update the minimum height
+    if ( !m_editor->isReadOnly() )
+    {
+        if ( m_tool && m_tool->isHidden() && m_editor->acceptRichText() )
+        {
+            m_tool->show();
+            setGeometry( x(), y(), width(), height() + m_tool->height() );
+        }
+        m_grip->show();
     }
-  } else {
+    else
+    {
+        if ( m_tool && !m_tool->isHidden() ) {
+            m_tool->hide();
+            setGeometry( x(), y(), width(), height() - m_tool->height() );
+            updateLayout();     // to update the minimum height
+        }
+        m_grip->hide();
+    }
+  }
+  else
+  {
     m_button->hide();
     m_grip->hide();
 
-    if ( m_tool && !m_tool->isHidden() ) {
+    if ( m_tool && !m_tool->isHidden() )
+    {
       m_tool->hide();
       setGeometry( x(), y(), width(), height() - m_tool->height() );
       updateLayout();     // to update the minimum height
Index: knotes/knotesapp.cpp
===================================================================
--- knotes/knotesapp.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knotes/knotesapp.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -250,6 +250,9 @@
 
 bool KNotesApp::commitData( QSessionManager & )
 {
+  foreach ( KNote *note, m_notes ) {
+    note->commitData();
+  }
   saveConfigs();
   return true;
 }
Index: knotes/knote.h
===================================================================
--- knotes/knote.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ knotes/knote.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -70,6 +70,7 @@
 
     bool isModified() const;
     void blockEmitDataChanged( bool _b ) { m_blockEmitDataChanged = _b;}
+    void commitData();
 
   public slots:
     void slotKill( bool force = false );
@@ -162,6 +163,7 @@
 
     KSharedConfig::Ptr m_kwinConf;
     bool m_blockEmitDataChanged;
+    bool mBlockWriteConfigDuringCommitData;
 };
 
 #endif
Index: akonadi/tray/akonaditray.desktop
===================================================================
--- akonadi/tray/akonaditray.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/tray/akonaditray.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -23,6 +23,7 @@
 GenericName[fr]=Utilitaire miniature Akonadi
 GenericName[ga]=Uirlis Tráidire Akonadi
 GenericName[gl]=Utilidade de Bandexa de Akonadi
+GenericName[hu]=Akonadi-tálca
 GenericName[is]=Akonadi kerfisbakkatól
 GenericName[it]=Utilità del vassoio di sistema di Akonadi
 GenericName[ja]=Akonadi システムトレイユーティリティ
Index: akonadi/agents/nepomuk_email_feeder/nepomukemailfeeder.desktop
===================================================================
--- akonadi/agents/nepomuk_email_feeder/nepomukemailfeeder.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/agents/nepomuk_email_feeder/nepomukemailfeeder.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[fr]=Connecteur Nepomuk pour les courriels
 Name[ga]=Fothaire Ríomhphoist Nepomuk
 Name[gl]=Fornecedor de Correo de Nepomuk
+Name[hu]=Nepomuk e-mail-feltöltő
 Name[it]=Fornitore di indirizzi di posta per Nepomuk
 Name[ja]=Nepomuk メールフィーダー
 Name[km]=កម្មវិធី​មតិព័ត៌មាន​អ៊ីមែល Nepomuk
@@ -39,6 +40,7 @@
 Comment[et]=Laiendus e-kirjade edastamiseks Nepomukile
 Comment[fr]=Extension pour fournir les courriels à Nepomuk
 Comment[gl]=Engadido para lle pasar mensaxes de correo a Nepomuk
+Comment[hu]=Kiterjesztés levelek áttöltéséhez a Nepomuk szolgáltatás számára
 Comment[it]=Estensione per inserire indirizzi di posta elettronica in Nepomuk
 Comment[ja]=Nepomuk にメールを提供するエクステンション
 Comment[km]=ផ្នែក​បន្ថែម​ដែលត្រូវ​បញ្ជូន​អ៊ីមែល​ទៅកាន់ Nepomuk
Index: akonadi/agents/mailthreader/mailthreaderagent.desktop
===================================================================
--- akonadi/agents/mailthreader/mailthreaderagent.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/agents/mailthreader/mailthreaderagent.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[fr]=Agent de regroupement de messages
 Name[ga]=Gníomhaire Snáithithe Ríomhphoist
 Name[gl]=Axente de Fí­os de Correo
+Name[hu]=Levélszálkezelő
 Name[it]=Agente raggruppamento messaggi di posta
 Name[ja]=メールをスレッド化するエージェント
 Name[km]=ភ្នាក់ងារ​ខ្សែស្រឡាយ​សំបុត្រ
@@ -42,6 +43,7 @@
 Comment[fr]=Des messages regroupés par fil de discussion
 Comment[ga]=Gníomhaire a shnáithíonn ríomhphost i mbailiúchán
 Comment[gl]=Ligar o correo por fí­os nunha colección
+Comment[hu]=Szálakra bontja az üzeneteket egy gyűjteményben
 Comment[it]=Raggruppa per conversazione i messaggi di posta in una collezione
 Comment[ja]=メールをスレッド化します
 Comment[km]=ដាក់​សំបុត្រ​ជា​ខ្សែស្រឡាយ​នៅ​ក្នុង​សម្រាំង
Index: akonadi/agents/nepomuk_contact_feeder/nepomukcontactfeeder.desktop
===================================================================
--- akonadi/agents/nepomuk_contact_feeder/nepomukcontactfeeder.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/agents/nepomuk_contact_feeder/nepomukcontactfeeder.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[fr]=Connecteur Nepomuk pour les contacts
 Name[ga]=Fothaire Teagmhálacha Nepomuk
 Name[gl]=Fornecedor de Contactos do Nepomuk
+Name[hu]=Nepomuk névjegyfeltöltő
 Name[it]=Fornitore di contatti Nepomuk per Akonadi
 Name[ja]=Nepomuk 連絡先フィーダー
 Name[km]=មតិព័ត៌មាន​ទំនាក់ទំនង Nepomuk
@@ -39,6 +40,7 @@
 Comment[et]=Laiendus kontaktide edastamiseks Nepomukile
 Comment[fr]=Extension pour fournir les contacts à Nepomuk
 Comment[gl]=Engadido para lle pasar os contactos ao Nepomuk
+Comment[hu]=Kiterjesztés névjegyek áttöltéséhez a Nepomuk szolgáltatás számára
 Comment[it]=Estensione per inserire i contatti in Nepomuk
 Comment[ja]=Nepomuk に連絡先を提供するエクステンション
 Comment[km]=ផ្នែក​បន្ថែម​ដែលត្រូវ​បញ្ជូន​ទំនាក់ទំនង​ទៅ Nepomuk
Index: akonadi/agents/strigifeeder/strigifeeder.desktop
===================================================================
--- akonadi/agents/strigifeeder/strigifeeder.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/agents/strigifeeder/strigifeeder.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[fr]=Connecteur Strigi
 Name[ga]=Fothaire Strigi
 Name[gl]=Fornecedor de Strigi
+Name[hu]=Strigi feltöltő
 Name[it]=Fornitore per Strigi
 Name[ja]=Strigi フィーダー
 Name[km]=មតិព័ត៌មាន Strigi
@@ -41,6 +42,7 @@
 Comment[fr]=Recherche en texte intégral avec Strigi
 Comment[ga]=Cuardach lántéacs bunaithe ar Strigi
 Comment[gl]=Procura de texto completo baseada en Strigi
+Comment[hu]=Strigi-alapú teljes szöveges kereső
 Comment[it]=Ricerca su tutto il testo basata su Strigi
 Comment[ja]=Strigi ベースの全文検索
 Comment[km]=ការ​ស្វែងរក​អត្ថបទ​ពេញលេញ​ដែល​មាន​មូលដ្ឋាន​លើ Strigi
Index: akonadi/plugins/akonadi_serializer_addressee.desktop
===================================================================
--- akonadi/plugins/akonadi_serializer_addressee.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/plugins/akonadi_serializer_addressee.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Sérialiseur de destinataires
 Name[ga]=Srathóir Seolaithe
 Name[gl]=Serializador de Destinatarios
+Name[hu]=Címzettkezelő
 Name[it]=Serializzatore degli indirizzi
 Name[ja]=受信者用シリアライザ
 Name[km]=ម៉ាស៊ីន​បោះពុម្ព​អ្នក​ទទួលសំបុត្រ
@@ -43,6 +44,7 @@
 Comment[fr]=Un module externe Akonadi pour la sérialisation des destinataires
 Comment[ga]=Breiseán srathóra Akonadi le haghaidh seolaithe
 Comment[gl]=Engadido de serialización de Akonadi para obxectos destinatario
+Comment[hu]=Akonadi-modul a címzettek kezeléséhez
 Comment[it]=Un'estensione di Akonadi per la serializzazione degli indirizzi
 Comment[ja]=受信者オブジェクトのための Akonadi シリアライザプラグイン
 Comment[km]=កម្មវិធី​ជំនួយ​កម្មវិធី​បោះពុម្ព Akonadi សម្រាប់​វត្ថុ​អ្នក​ទទួល​សំបុត្រ
Index: akonadi/plugins/akonadi_serializer_bookmark.desktop
===================================================================
--- akonadi/plugins/akonadi_serializer_bookmark.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/plugins/akonadi_serializer_bookmark.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Sérialiseur de signets
 Name[ga]=Srathóir leabharmharcanna
 Name[gl]=Serializador de marcadores
+Name[hu]=Könyvjelzőkezelő
 Name[it]=Serializzatore dei segnalibri
 Name[ja]=ブックマーク用シリアライザ
 Name[km]=ម៉ាស៊ីន​បោះពុម្ព​ចំណាំ
@@ -42,6 +43,7 @@
 Comment[fr]=Un module externe Akonadi pour la sérialisation des signets
 Comment[ga]=Breiseán srathóra Akonadi le haghaidh leabharmharcanna
 Comment[gl]=Engadido de serialización de Akonadi para obxectos marcador
+Comment[hu]=Akonadi-modul könyvjelzők kezeléséhez
 Comment[it]=Un'estensione di Akonadi per la serializzazione dei segnalibri
 Comment[ja]=ブックマークオブジェクトのための Akonadi シリアライザプラグイン
 Comment[km]=កម្មវិធី​ជំនួយ​កម្មវិធី​បោះពុម្ព Akonadi សម្រាប់​វត្ថុ​ចំណាំ
Index: akonadi/plugins/akonadi_serializer_contactgroup.desktop
===================================================================
--- akonadi/plugins/akonadi_serializer_contactgroup.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/plugins/akonadi_serializer_contactgroup.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Sérialiseur de groupes de contacts
 Name[ga]=Srathóir Grúpa Teagmhálacha
 Name[gl]=Serializador de Grupo de Contacto
+Name[hu]=Névjegycsoport-kezelő
 Name[it]=Serializzatore gruppi di contatti
 Name[ja]=連絡先グループ用シリアライザ
 Name[km]=អ្នក​ដាក់​លេខ​សៀរៀល​ក្រុម​ទំនាក់ទំនង
@@ -42,6 +43,7 @@
 Comment[fr]=Un module externe Akonadi pour la sérialisation des groupes de contacts
 Comment[ga]=Breiseán srathóra Akonadi le haghaidh grúpaí teagmhálacha
 Comment[gl]=Engadido de serialización de Akonadi para obxectos de grupo de contacto
+Comment[hu]=Akonadi-modul névjegycsoportok kezeléséhez
 Comment[it]=Un'estensione di Akonadi per la serializzazione dei gruppi di contatti
 Comment[ja]=連絡先グループオブジェクトのための Akonadi シリアライザプラグイン
 Comment[km]=កម្មវិធីជំនួយ​អ្នក​ដាក់លេខសៀរៀល Akonadi សម្រាប់​វត្ថុ​ក្រុម​ទំនាក់ទំនង
Index: akonadi/plugins/akonadi_serializer_kcal.desktop
===================================================================
--- akonadi/plugins/akonadi_serializer_kcal.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/plugins/akonadi_serializer_kcal.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Sérialiseur d'évènements
 Name[ga]=Srathóir Imeachtaí
 Name[gl]=Serializador de Incidencias
+Name[hu]=Eseménykezelő
 Name[it]=Serializzatore occorrenze
 Name[ja]=イベント用シリアライザ
 Name[km]=ម៉ាស៊ីនបោះពុម្ព​ឧប្បត្តិហេតុ
@@ -43,6 +44,7 @@
 Comment[fr]=Un module externe Akonadi pour la sérialisation des évènements
 Comment[ga]=Breiseán srathóra Akonadi le haghaidh imeachtaí, tascanna, agus iontrálacha dialainne
 Comment[gl]=Un engadido de serialización de Akonadi para eventos, tarefas e entradas do diario
+Comment[hu]=Akonadi-modul események, feladatok és naplóbejegyzések kezeléséhez
 Comment[it]=Un'estensione di Akonadi per la serializzazione di eventi, compiti e diari
 Comment[ja]=イベント、タスク、日記のエントリのための Akonadi シリアライザプラグイン
 Comment[km]=កម្មវិធីជំនួយ​កម្មវិធី​បោះពុម្ព Akonadi សម្រាប់​ធាតុ​​ព្រឹត្តិការណ៍ ភារកិច្ច និងទិនានុប្បវត្តិ
Index: akonadi/plugins/akonadi_serializer_mail.desktop
===================================================================
--- akonadi/plugins/akonadi_serializer_mail.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/plugins/akonadi_serializer_mail.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Sérialiseur de courriels
 Name[ga]=Srathóir Ríomhphoist
 Name[gl]=Serializador de Correo
+Name[hu]=Levélkezelő
 Name[it]=Serializzatore posta elettronica
 Name[ja]=メール用シリアライザ
 Name[km]=ម៉ាស៊ីន​បោះពុម្ព​សំបុត្រ
@@ -43,6 +44,7 @@
 Comment[fr]=Un module externe Akonadi pour la sérialisation des courriels
 Comment[ga]=Breiseán srathóra Akonadi le haghaidh ríomhphoist
 Comment[gl]=Un engadido de serialización de Akonadi para obxectos correo
+Comment[hu]=Akonadi-modul levelek kezeléséhez
 Comment[it]=Un'estensione di Akonadi per la serializzazione di posta elettronica
 Comment[ja]=メールオブジェクトのための Akonadi シリアライザプラグイン
 Comment[km]=កម្មវិធី​ជំនួយ​កម្មវិធី​បោះពុម្ព Akonadi សម្រាប់​វត្ថុ​សំបុត្រ
Index: akonadi/kabc/kcontactmanager/kcontactmanager.desktop
===================================================================
--- akonadi/kabc/kcontactmanager/kcontactmanager.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/kabc/kcontactmanager/kcontactmanager.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -19,6 +19,7 @@
 GenericName[fr]=Gestionnaire de contacts
 GenericName[ga]=Bainisteoir na dTeagmhálacha
 GenericName[gl]=Xestor de Contactos
+GenericName[hu]=Névjegykezelő
 GenericName[it]=Gestione della rubrica
 GenericName[ja]=連絡先マネージャ
 GenericName[km]=កម្មវិធី​គ្រប់គ្រង​ទំនាក់ទំនង
Index: akonadi/clients/akonadiconsole/akonadiconsole.desktop
===================================================================
--- akonadi/clients/akonadiconsole/akonadiconsole.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/clients/akonadiconsole/akonadiconsole.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[fr]=Console Akonadi
 Name[ga]=Consól Akonadi
 Name[gl]=Consola de Akonadi
+Name[hu]=Akonadi-konzol
 Name[it]=Console Akonadi
 Name[ja]=Akonadi コンソール
 Name[km]=កុងសូល​របស់ Akonadi
@@ -46,6 +47,7 @@
 Comment[fr]=Console de gestion et de déboguage pour Akonadi
 Comment[ga]=Consól Bainisteoireachta agus Dífhabhtaithe Akonadi
 Comment[gl]=Consola de Xestión e Depuración de Akonadi
+Comment[hu]=Kezelőprogram és hibakereső az Akonadihoz
 Comment[it]=Console di gestione e debugging di Akonadi
 Comment[ja]=Akonadi の管理とデバッグのためのコンソール
 Comment[km]=ការ​គ្រប់គ្រង Akonadi និង​កុងសូល​បំបាត់​កំហុស
Index: akonadi/kcm/kcm_akonadi_server.desktop
===================================================================
--- akonadi/kcm/kcm_akonadi_server.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/kcm/kcm_akonadi_server.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -22,6 +22,7 @@
 Name[fr]=Configuration du serveur Akonadi
 Name[ga]=Cumraíocht Fhreastalaí Akonadi
 Name[gl]=Configuración do Servidor Akonadi 
+Name[hu]=Az Akonadi szolgáltatás beállításai
 Name[it]=Configurazione del server Akonadi
 Name[ja]=Akonadi サーバの設定
 Name[km]=ការ​កំណត់​រចនាសម្ព័ន្ធ​ម៉ាស៊ីនបម្រើ Akonadi
Index: akonadi/kcm/kcm_akonadi_resources.desktop
===================================================================
--- akonadi/kcm/kcm_akonadi_resources.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/kcm/kcm_akonadi_resources.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -22,6 +22,7 @@
 Name[fr]=Configuration des ressources Akonadi
 Name[ga]=Cumraíocht Acmhainní Akonadi
 Name[gl]=Configuración de Recursos de Akonadi
+Name[hu]=Akonadi-erőforrások
 Name[it]=Configurazione risorse di Akonadi
 Name[ja]=Akonadi リソースの設定
 Name[km]=ការ​កំណត់​រចនាសម្ព័ន្ធ​ធនធាន Akonadi
Index: akonadi/kcm/kcm_akonadi.desktop
===================================================================
--- akonadi/kcm/kcm_akonadi.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/kcm/kcm_akonadi.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -24,6 +24,7 @@
 Name[fr]=Configuration d'Akonadi
 Name[ga]=Cumraíocht Akonadi
 Name[gl]=Configuración do Akonadi 
+Name[hu]=Akonadi-beállítások
 Name[it]=Configurazione di Akonadi
 Name[ja]=Akonadi の設定
 Name[km]=ការ​កំណត់​រចនាសម្ព័ន្ធ​ម៉ាស៊ីនបម្រើ Akonadi
@@ -56,6 +57,7 @@
 Comment[et]=Akonadi personaalse teabe halduse (PIM) raamistiku seadistused
 Comment[fr]=Configuration du gestionnaire d'informations personnelles Akonadi
 Comment[gl]=Configuración da infraestrutura do Xestor de Información Persoal de Akonadi
+Comment[hu]=Az Akonadi keretrendszer beállításai
 Comment[it]=Configurazione dell'infrastruttura Akonadi per la gestione delle informazioni personali
 Comment[ja]=Akonadi PIM (個人情報管理) フレームワークの設定
 Comment[km]=ការ​កំណត់​រចនាសម្ព័ន្ធ​គម្រោងការ​ការ​គ្រប់គ្រង​ព័ត៌មាន​ផ្ទាល់ខ្លួន Akonadi
Index: akonadi/resources/distlist/distlistresource.desktop
===================================================================
--- akonadi/resources/distlist/distlistresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/distlist/distlistresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -4,11 +4,13 @@
 Name[da]=Distributionsliste-fil
 Name[de]=Verteilerlistendatei
 Name[el]=Αρχείο λίστας διανομής
+Name[en_GB]=Distribution List File
 Name[es]=Archivo de lista de distribución
 Name[et]=Postiloendi fail
 Name[fr]=Fichier de liste de distribution
 Name[ga]=Comhad Liosta Dáilte
 Name[gl]=Ficheiro Distributionlist
+Name[hu]=Címlistafájl
 Name[it]=File lista di distribuzione
 Name[ja]=配布リストファイル
 Name[km]=ឯកសារ​បញ្ជី​ចែកចាយ
@@ -37,11 +39,13 @@
 Comment[da]=Indlæser data fra en distributionsliste-fil
 Comment[de]=Daten werden aus einer Verteilerlistendatei geladen
 Comment[el]=Φόρτωση δεδομένων από ένα αρχείο λίστας διανομής
+Comment[en_GB]=Loads data from a distribution list file
 Comment[es]=Carga datos desde un archivo de lista de distribución.
 Comment[et]=Andmete laadimine postiloendi failist
 Comment[fr]=Charger les données depuis un fichier de liste de distribution
 Comment[ga]=Breiseán a luchtaíonn sonraí ó chomhad liosta dáilte
 Comment[gl]=Carrega datos desde un ficheiro de distribución
+Comment[hu]=Adatbetöltés címlistafájlból
 Comment[it]=Carica dati da un file contenente una lista di distribuzione
 Comment[ja]=配布リストファイルからデータを読み込みます
 Comment[km]=ផ្ទុក​ទិន្នន័យ​ពី​​ឯកសារ​បញ្ជី​ចែកចាយ
Index: akonadi/resources/nntp/nntpresource.desktop
===================================================================
--- akonadi/resources/nntp/nntpresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/nntp/nntpresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[et]=Useneti uudistegrupid (NNTP)
 Name[fr]=Forum de discussion usenet (NNTP)
 Name[gl]=Grupos de noticias da Usenet (NNTP)
+Name[hu]=Usenet-hírcsoportok (NNTP)
 Name[it]=Gruppi di discussione Usenet (NNTP)
 Name[ja]=Usenet ニュースグループ (NNTP)
 Name[ko]=유즈넷 뉴스그룹 (NNTP)
@@ -39,6 +40,7 @@
 Comment[et]=Võimaldab lugeda artikleid uudisteserverist
 Comment[fr]=Permet de lire des articles depuis un serveur de nouvelles
 Comment[gl]=Permite ler artigos desde un servidor de novas
+Comment[hu]=Híreket tud letölteni NNTP-hírkiszolgálókról
 Comment[it]=Permette la lettura di articoli da un server di gruppi di discussione
 Comment[ja]=ニュースサーバから記事を読めるようにします
 Comment[km]=ធ្វើ​ឲ្យ​អាច​អាន​ចំណងជើង​ពី​ម៉ាស៊ីន​បម្រើ​ព័ត៌មាន​បាន
Index: akonadi/resources/vcard/vcardresource.desktop
===================================================================
--- akonadi/resources/vcard/vcardresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/vcard/vcardresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Fichier VCard
 Name[ga]=Comhad v-Chárta
 Name[gl]=Ficheiro de VCard
+Name[hu]=vCard-fájl
 Name[is]=VCard spjaldskrá
 Name[it]=File vCard
 Name[ja]=VCard ファイル
@@ -45,6 +46,7 @@
 Comment[fr]=Charge des données depuis un fichier au format VCard
 Comment[ga]=Breiseán a luchtaíonn sonraí ó chomhad v-Chárta
 Comment[gl]=Carrega datos desde un ficheiro VCard
+Comment[hu]=Adatbetöltő vCard-fájlokhoz
 Comment[is]=Hleður inn gögnum úr VCard spjaldskrá
 Comment[it]=Caricare dati da un file vCard
 Comment[ja]=VCard ファイルからデータを読み込みます
Index: akonadi/resources/kabc/kabcresource.desktop
===================================================================
--- akonadi/resources/kabc/kabcresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/kabc/kabcresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -5,10 +5,12 @@
 Name[da]=KDE's adressebog (traditionel)
 Name[de]=KDE-Adressbuch (herkömmlich)
 Name[el]=Βιβλίο διευθύνσεων του KDE (παραδοσιακό)
+Name[en_GB]=KDE Address Book (traditional)
 Name[es]=KDE Addressbook (tradicional)
 Name[et]=KDE aadressiraamat (traditsiooniline)
 Name[fr]=Carnet d'adresse KDE (traditionnel)
 Name[gl]=Caderno de enderezos do KDE (tradicional)
+Name[hu]=KDE címjegyzék (hagyományos)
 Name[it]=Rubrica indirizzi di KDE (tradizionale)
 Name[ja]=KDE アドレス帳 (従来のタイプ)
 Name[km]=សៀវភៅ​អាសយដ្ឋាន KDE (បុរាណ)
@@ -38,11 +40,13 @@
 Comment[da]=Indlæser data fra en traditionel KDE adressebogsressource
 Comment[de]=Lädt Daten aus einer herkömmlichen KDE-Adressbuch-Ressource
 Comment[el]=Φόρτωση δεδομένων από έναν παραδοσιακό πόρο βιβλίου διευθύνσεων του KDE
+Comment[en_GB]=Loads data from a traditional KDE address book resource
 Comment[es]=Carga datos desde un recurso tradicional de Libreta de Direcciones de KDE
 Comment[et]=Andmete laadimine traditsioonilisest KDE aadressiraamatu ressursist
 Comment[fr]=Charge des données depuis un carnet d'adresses KDE traditionnel
 Comment[ga]=Breiseán a luchtaíonn sonraí ó acmhainn thraidisiúnta leabhair seoltaí KDE
 Comment[gl]=Carrega datos desde un recurso de caderno de enderezos do KDE
+Comment[hu]=Adatbetöltés egy hagyományos KDE címjegyzékből
 Comment[it]=Carica dati da una tradizionale risorsa rubrica di KDE
 Comment[ja]=従来の KDE アドレス帳リソースからデータを読み込みます
 Comment[km]=ផ្ទុក​ទិន្នន័យ​ពី​ធនធាន​សៀវភៅ​អាសយដ្ឋាន KDE បុរាណ
Index: akonadi/resources/knut/knutresource.desktop
===================================================================
--- akonadi/resources/knut/knutresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/knut/knutresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -12,6 +12,7 @@
 Comment[fr]=Un agent à des fins de déboguage
 Comment[ga]=Gníomhaire dífhabhtaithe
 Comment[gl]=Un axente de depuración
+Comment[hu]=Nyomkövető
 Comment[it]=Un agente per scopi di debug
 Comment[ja]=デバッグのためのエージェント
 Comment[km]=ភ្នាក់ងារ​សម្រាប់​បំបាត់​កំហុស
Index: akonadi/resources/maildir/maildirresource.desktop
===================================================================
--- akonadi/resources/maildir/maildirresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/maildir/maildirresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -15,6 +15,7 @@
 Comment[fr]=Charge des données d'un dossier au format maildir
 Comment[ga]=Breiseán a luchtaíonn sonraí ó fhillteán logánta maildir
 Comment[gl]=Carrega datos desde un cartafol de correo local
+Comment[hu]=Adatbetöltő helyi maildir típusú mappákhoz
 Comment[it]=Carica dati da una cartella locale maildir
 Comment[ja]=ローカルの maildir フォルダからデータを読み込みます
 Comment[km]=ផ្ទុក​ទិន្នន័យ​ពី​ថត maildir មូលដ្ឋាន
Index: akonadi/resources/localbookmarks/localbookmarksresource.desktop
===================================================================
--- akonadi/resources/localbookmarks/localbookmarksresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/localbookmarks/localbookmarksresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[et]=Kohalikud järjehoidjad
 Name[fr]=Ressource de signets locaux
 Name[ga]=Leabharmharcanna Logánta
+Name[hu]=Helyi könyvjelzők
 Name[it]=Segnalibri locali
 Name[ja]=ローカルブックマーク
 Name[km]=ចំណាំ​មូលដ្ឋាន
@@ -43,6 +44,7 @@
 Comment[fr]=Charge des données depuis un fichier local de signets
 Comment[ga]=Breiseán a luchtaíonn sonraí ó chomhad logánta leabharmharcanna
 Comment[gl]=Carrega datos desde un ficheiro local de marcadores
+Comment[hu]=Adatbetöltő helyi könyvjelzőfájlokhoz
 Comment[it]=Carica dati da un file locale di segnalibri
 Comment[ja]=ローカルのブックマークファイルからデータを読み込みます
 Comment[km]=ផ្ទុក​ទិន្នន័យ​ពី​ឯកសារ​ចំណាំ​មូលដ្ឋាន
Index: akonadi/resources/imap/imaplibresource.desktop
===================================================================
--- akonadi/resources/imap/imaplibresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/imap/imaplibresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -3,6 +3,7 @@
 Name[fr]=Imap Mailody
 Name[ga]=IMAP Mailody
 Name[gl]=Imap de Mailody
+Name[hu]=Mailody IMAP
 Name[ja]=Mailody IMAP
 Name[ko]=Mailody IMAP
 Name[lt]=Mailody IMAP
@@ -26,6 +27,7 @@
 Comment[fr]=Connexion à un serveur IMAP en utilisant la librairie IMAP de Mailody.
 Comment[ga]=Breiseán a bhunaíonn ceangal le freastalaí IMAP.  Bunaithe ar leabharlann IMAP ó Mailody.
 Comment[gl]=Conecta cun servidor de IMAP. Baseado na biblioteca de IMAP do Mailody.
+Comment[hu]=IMAP-kiszolgálók kezelését végzi, a Mailody IMAP-programramkönyvtáron alapul.
 Comment[it]=Si connette ad un server IMAP. Basato sulla libreria IMAP di Mailody.
 Comment[ja]=IMAP サーバに接続します。Mailody の IMAP ライブラリに基づいています。
 Comment[km]=តភ្ជាប់​ទៅ​ម៉ាស៊ីន​បម្រើ IMAP ។ មាន​មូលដ្ឋាន​លើ​បណ្ណាល័យ IMAP ពី Mailody ។
Index: akonadi/resources/openchange/ocresource.desktop
===================================================================
--- akonadi/resources/openchange/ocresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/openchange/ocresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -12,6 +12,7 @@
 Comment[fr]=Permet de collaborer avec un serveur OpenChange ou Exchange
 Comment[ga]=Breiseán lenar féidir oibriú le freastalaí OpenChange / Exchange
 Comment[gl]=Permite traballar cun servidor OpenChange / Exchange
+Comment[hu]=OpenChange- és Exchange-kiszolgálók elérésére képes
 Comment[it]=Permette di lavorare con un server OpenChange / Exchange
 Comment[ja]=OpenChange/Exchange サーバとやりとりできるようにします
 Comment[km]=ធ្វើ​ឲ្យ​វា​អាច​ធ្វើការ​ជាមួយ​ម៉ាស៊ីន​បម្រើ OpenChange / Exchange
Index: akonadi/resources/ical/icalresource.desktop
===================================================================
--- akonadi/resources/ical/icalresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/ical/icalresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Fichier de calendrier au format ICal
 Name[ga]=Comhad Féilire ICal
 Name[gl]=Ficheiro de Calendario de ICal
+Name[hu]=iCal-naptárfájl
 Name[it]=Calendario iCal
 Name[ja]=iCal カレンダーファイル
 Name[km]=ឯកសារ​ប្រតិទិន ICal
@@ -44,6 +45,7 @@
 Comment[fr]=Charge des données depuis un fichier au format iCal
 Comment[ga]=Breiseán a luchtaíonn sonraí ó chomhad iCal
 Comment[gl]=Carrega datos desde un ficheiro iCal
+Comment[hu]=Adatbetöltés iCal formátumú naptárból
 Comment[it]=Carica dati da un file iCal
 Comment[ja]=iCal ファイルからデータを読み込みます
 Comment[km]=ផ្ទុក​ទិន្នន័យ​ពី​ឯកសារ iCal
Index: akonadi/resources/kcal/kcalresource.desktop
===================================================================
--- akonadi/resources/kcal/kcalresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/kcal/kcalresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Calendrier KDE (traditionnel)
 Name[ga]=Féilire KDE (traidisiúnta)
 Name[gl]=Calendario do KDE (tradicional)
+Name[hu]=KDE naptár (hagyományos)
 Name[it]=Calendario di KDE (tradizionale)
 Name[ja]=KDE カレンダー (従来のタイプ)
 Name[km]=ប្រតិទិន KDE (បុរាណ)
@@ -44,6 +45,7 @@
 Comment[fr]=Charge des données depuis un calendrier KDE traditionnel
 Comment[ga]=Breiseán a luchtaíonn sonraí ó acmhainn thraidisiúnta fhéilire KDE
 Comment[gl]=Carrega datos desde un recurso de calendario tradicional do KDE
+Comment[hu]=Adatbetöltés egy hagyományos KDE naptárerőforrásból
 Comment[it]=Carica dati da una tradizionale risorsa calendario di KDE
 Comment[ja]=従来の KDE カレンダーリソースからデータを読み込みます
 Comment[km]=ផ្ទុក​ទិន្នន័យ​ពី​ធនធាន​ប្រតិទិន KDE បុរាណ
Index: akonadi/resources/nepomuktag/nepomuktagresource.desktop
===================================================================
--- akonadi/resources/nepomuktag/nepomuktagresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/nepomuktag/nepomuktagresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -9,6 +9,7 @@
 Name[et]=Nepomuki sildid (virtuaalkaustad)
 Name[fr]=Étiquettes Nepomuk (dossiers virtuels)
 Name[gl]=Etiquetas Nepomuk (Cartafoles Virtuais)
+Name[hu]=Nepomuk-címkék (virtuális mappák)
 Name[it]=Etichette Nepomuk (cartelle virtuali)
 Name[ja]=Nepomuk タグ (仮想フォルダ)
 Name[km]=ស្លាក Nepomuk (ថត​និម្មិត)
@@ -41,6 +42,7 @@
 Comment[et]=Virtuaalkaustad Nepomuki siltidega kirjade valimiseks.
 Comment[fr]=Des dossiers virtuels qui permettent de sélectionner les messages avec des étiquettes Nepomuk.
 Comment[gl]=Cartafoles virtuais para escoller mensaxes que teñan Etiquetas de Nepomuk.
+Comment[hu]=Virtuális mappák adott Nepomuk-címkéket tartalmazó üzenetek megjelenítéséhez.
 Comment[it]=Cartelle virtuali per la selezione di messaggi con etichette Nepomuk.
 Comment[ja]=Nepomuk タグの付いたメッセージを選択するための仮想フォルダ
 Comment[km]=ថត​និម្មិត​សម្រាប់​ជ្រើស​សារ​ដែល​មាន​ស្លាក Nepomuk ។
Index: akonadi/resources/vcarddir/vcarddirresource.desktop
===================================================================
--- akonadi/resources/vcarddir/vcarddirresource.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ akonadi/resources/vcarddir/vcarddirresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Dossier VCard
 Name[ga]=Comhadlann v-Chárta
 Name[gl]=Directorio de VCard
+Name[hu]=vCard-mappa
 Name[is]=Mappa fyrir VCard spjaldskrár
 Name[it]=Cartella vCard
 Name[ja]=VCard ディレクトリ
@@ -45,6 +46,7 @@
 Comment[fr]=Charge des données depuis un dossier contenant des fichiers VCard
 Comment[ga]=Gníomhaire a luchtaíonn sonraí ó chomhadlann ina bhfuil v-Chártaí
 Comment[gl]=Carregar datos desde un cartafol con VCards 
+Comment[hu]=Adatbetöltő vCard-fájlokat tartalmazó fájlrendszerbeli mappákhoz
 Comment[is]=Hleður inn gögnum úr möppu með VCard spjaldskrám
 Comment[it]=Caricare dati da una cartella con file vCard
 Comment[ja]=VCard のディレクトリからデータを読み込みます
Index: korganizer/kogroupware.cpp
===================================================================
--- korganizer/kogroupware.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/kogroupware.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -180,6 +180,10 @@
   KCal::iTIPMethod method = static_cast<KCal::iTIPMethod>( message->method() );
   KCal::ScheduleMessage::Status status = message->status();
   KCal::Incidence *incidence = dynamic_cast<KCal::Incidence*>( message->event() );
+  if(!incidence) {
+    delete message;
+    return;
+  }
   KCal::MailScheduler scheduler( mCalendar );
   if ( action.startsWith( "accepted" ) || action.startsWith( "tentative" ) ||
        action.startsWith( "delegated" ) || action.startsWith( "counter" ) ) {
Index: korganizer/publishdialog.cpp
===================================================================
--- korganizer/publishdialog.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/publishdialog.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -87,9 +87,11 @@
   for ( i=0; i<count; i++ ) {
     item = mUI.mAddressListView->firstChild();
     mUI.mAddressListView->takeItem( item );
-    to += item->text( 1 );
-    if ( i < count-1 ) {
-      to += ", ";
+    if( !item->text( 1 ).isEmpty() ) {
+      to += item->text( 1 );
+      if ( i < count-1 ) {
+        to += ", ";
+      }
     }
   }
   return to;
Index: korganizer/koattendeeeditor.cpp
===================================================================
--- korganizer/koattendeeeditor.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/koattendeeeditor.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -410,6 +410,9 @@
       mDelegateLabel->setText( i18n( "Not delegated" ) );
     }
   }
+  if( myself )
+    mRsvpButton->setEnabled( false );
+
 }
 
 void KOAttendeeEditor::updateAttendeeInput()
Index: korganizer/koeditorfreebusy.cpp
===================================================================
--- korganizer/koeditorfreebusy.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/koeditorfreebusy.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -342,8 +342,6 @@
 
   connect( mGanttView, SIGNAL(lvSelectionChanged(KDGanttViewItem*)),
           this, SLOT(updateAttendeeInput()) );
-  connect( mGanttView, SIGNAL(lvItemLeftClicked(KDGanttViewItem*)),
-           this, SLOT(showAttendeeStatusMenu()) );
   connect( mGanttView, SIGNAL(lvItemRightClicked(KDGanttViewItem*)),
            this, SLOT(showAttendeeStatusMenu()) );
   connect( mGanttView, SIGNAL(lvMouseButtonClicked(int, KDGanttViewItem*, const QPoint&, int)),
Index: korganizer/dbuscalendar.desktop
===================================================================
--- korganizer/dbuscalendar.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/dbuscalendar.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -5,6 +5,7 @@
 Name[es]=Calendario DBUS
 Name[ga]=Féilire DBUS
 Name[gl]=Calendario DBUS
+Name[hu]=D-Bus-naptár
 Name[ja]=D-Bus カレンダー
 Name[lt]=DBUSkalendorius
 Name[nb]=DBUSKalender
@@ -31,6 +32,7 @@
 Comment[fr]=Agenda avec une interface D-Bus
 Comment[ga]=Eagraí le comhéadan D-BUS
 Comment[gl]=Organizador con interface D-BUS
+Comment[hu]=Határidőnapló D-Bus-felülettel
 Comment[it]=Agenda con un'interfaccia D-Bus
 Comment[ja]=D-Bus インターフェースを持つカレンダー
 Comment[kk]=D-BUS интерфейсті Ұйымдастырғыш
Index: korganizer/koglobals.h
===================================================================
--- korganizer/koglobals.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/koglobals.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -63,6 +63,11 @@
       COMPLETION_MODIFIED_WITH_RECURRENCE,
       UNKNOWN_MODIFIED
     };
+    enum
+    {
+      // This value is passed to QColor's lighter(int factor) for selected events
+      BRIGHTNESS_FACTOR = 125
+    };
 
     static void fitDialogToScreen( QWidget *widget, bool force=false );
     KConfig *config() const;
Index: korganizer/interfaces/calendar/calendarplugin.desktop
===================================================================
--- korganizer/interfaces/calendar/calendarplugin.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/interfaces/calendar/calendarplugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Interface de module d'agenda
 Name[ga]=Comhéadan Breiseáin Féilire
 Name[gl]=Interface do Engadido do Calendario
+Name[hu]=Naptárbővítmény-felület
 Name[it]=Interfaccia dell'estensione calendario
 Name[ja]=カレンダープラグインインターフェース
 Name[km]=ប្រតិទិន​កម្មវិធី​ជំនួយ​ប្រតិទិន
@@ -57,7 +58,7 @@
 Comment[gl]=Engadido de Calendario
 Comment[he]=תוסף לוח שנה
 Comment[hr]=Kalendar dodatak
-Comment[hu]=Naptárkezelő bővítőmodul
+Comment[hu]=Naptárkezelő bővítmény
 Comment[is]=Dagatals íforrit
 Comment[it]=Estensione calendario
 Comment[ja]=カレンダープラグイン
Index: korganizer/interfaces/calendar/calendardecoration.desktop
===================================================================
--- korganizer/interfaces/calendar/calendardecoration.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/interfaces/calendar/calendardecoration.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Interface de décoration d'agenda
 Name[ga]=Comhéadan Maisíochta Féilire
 Name[gl]=Interface de Decoración de Calendarios
+Name[hu]=Naptármegjelenési bővítmény
 Name[it]=Interfaccia di decorazione del calendario
 Name[ja]=カレンダー装飾インターフェース
 Name[km]=ចំណុច​ប្រទាក់​តុបតែង​ប្រតិទិន
@@ -57,7 +58,7 @@
 Comment[gl]=Engadido para a Decoración do Calendario
 Comment[he]=תוסף קישוטי לוח שנה
 Comment[hr]=Dodatak za dekoraciju kalendara
-Comment[hu]=Naptármegjelenési bővítőmodul
+Comment[hu]=Naptármegjelenési bővítmény
 Comment[is]=Íforrit til að skreyta texta dagatals
 Comment[it]=Estensione di decorazione del calendario
 Comment[ja]=カレンダー装飾プラグイン
Index: korganizer/interfaces/korganizer/baseview.cpp
===================================================================
--- korganizer/interfaces/korganizer/baseview.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/interfaces/korganizer/baseview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -78,6 +78,11 @@
   return false;
 }
 
+bool BaseView::usesFullWindow()
+{
+  return false;
+}
+
 } //namespace KOrg
 
 #include "baseview.moc"
Index: korganizer/interfaces/korganizer/korgprintplugin.desktop
===================================================================
--- korganizer/interfaces/korganizer/korgprintplugin.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/interfaces/korganizer/korgprintplugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Interface de module d'impression d'agenda
 Name[ga]=Comhéadan Breiseáin Priontála KOrganizer
 Name[gl]=Interface do Engadido de Impresión de KOrganizer
+Name[hu]=A KOrganizer nyomtatási bővítmény felülete
 Name[it]=Interfaccia dell'estensione di stampa di KOrganizer
 Name[ja]=KOrganizer 印刷プラグインインターフェース
 Name[km]=ចំណុច​ប្រទាក់​កម្មវិធី​ជំនួយ​​បោះពុម្ព KOrganizer
Index: korganizer/interfaces/korganizer/korganizerpart.desktop
===================================================================
--- korganizer/interfaces/korganizer/korganizerpart.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/interfaces/korganizer/korganizerpart.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -10,6 +10,7 @@
 Name[fr]=Interface de composant KOrganizer
 Name[ga]=Comhéadan Comhpháirte KOrganizer
 Name[gl]=Interface da Parte KOrganizer
+Name[hu]=KOrganizer objektumfelület
 Name[it]=Interfaccia del componente di KOrganizer
 Name[ja]=KOrganizer コンポーネントのインターフェース
 Name[km]=ចំណុច​ប្រទាក់​ផ្នែក​របស់ KOrganizer
Index: korganizer/interfaces/korganizer/baseview.h
===================================================================
--- korganizer/interfaces/korganizer/baseview.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/interfaces/korganizer/baseview.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -102,6 +102,12 @@
     */
     virtual bool isEventView();
 
+    /**
+     * returns whether this view should be displayed full window.
+     * Base implementation returns false.
+     */
+    virtual bool usesFullWindow();
+
   public Q_SLOTS:
     /**
       Show incidences for the given date range. The date range actually shown
Index: korganizer/koeditorgeneraljournal.cpp
===================================================================
--- korganizer/koeditorgeneraljournal.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/koeditorgeneraljournal.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -48,6 +48,7 @@
 #include <QCheckBox>
 #include <QLabel>
 #include <QLayout>
+#include <QTimer>
 #include <QHBoxLayout>
 #include <QBoxLayout>
 #include <QPushButton>
@@ -75,6 +76,9 @@
   hbox->addWidget( summaryLabel );
 
   mSummaryEdit = new FocusLineEdit( parent );
+  connect( mSummaryEdit, SIGNAL(focusReceivedSignal()),
+           SIGNAL(focusReceivedSignal()) );
+  QTimer::singleShot( 0, mSummaryEdit, SLOT(setFocus()) );
   mSummaryEdit->setWhatsThis( whatsThis );
   summaryLabel->setBuddy( mSummaryEdit );
   hbox->addWidget( mSummaryEdit );
Index: korganizer/plugins/picoftheday/picoftheday.desktop
===================================================================
--- korganizer/plugins/picoftheday/picoftheday.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/plugins/picoftheday/picoftheday.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -13,6 +13,7 @@
 Name[fi]=Wikipedian päivän kuva -liitännäinen
 Name[fr]=Module externe « Image du jour » de Wikipédia
 Name[gl]=Engadido para a Imaxe do Dí­a da Wikipedia nos Calendarios
+Name[hu]=Naptárbővítmény a Wikipedia "A nap képe" funkciójához
 Name[it]=Estensione "foto del giorno" di Wikipedia per i calendari
 Name[ja]=Wikipedia 今日の写真プラグイン
 Name[km]=រូបភាព​របស់ Wikipedia នៃ​​កម្មវិធី​ជំនួយ​ថ្ងៃ​សម្រាប់​ប្រតិទិន
@@ -46,6 +47,7 @@
 Comment[et]=See plugin näitab Wikipedia päevapilti
 Comment[fr]=Ce module externe fourni l'image du jour de Wikipédia
 Comment[gl]=Este engadido fornece a Imaxe do Dí­a da Wikipedia
+Comment[hu]=Ez a bővítmény kezelni tudja a Wikipedia "A nap képe" szolgáltatását
 Comment[it]=Questa estensione fornisce la "foto del giorno" di Wikipedia
 Comment[ja]=Wikipedia の「今日の写真」を提供します。
 Comment[km]=កម្មវិធី​ជំនួយ​នេះ ផ្ដល់​នូវ​រូបភាព​ថ្ងៃនេះ​របស់ Wikipedia
Index: korganizer/plugins/hebrew/hebrew.desktop
===================================================================
--- korganizer/plugins/hebrew/hebrew.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/plugins/hebrew/hebrew.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -64,6 +64,7 @@
 Comment[fi]=Näyttää kaikki päivät KOrganizerissa myös juutalaisen kalenterin mukaan.
 Comment[fr]=Affiche toutes les dates de KOrganizer selon le calendrier Juif.
 Comment[gl]=Amosa todas as datas en KOrganizer tamén no sistema de calendario xudeu.
+Comment[hu]=A KOrganizer dátumait kiírja a hagyományos zsidó naptár szerint is.
 Comment[it]=Mostra tutte le date in KOrganizer anche secondo il calendario ebraico.
 Comment[ja]=KOrganizer のすべての日付をユダヤ暦でも表示します。
 Comment[km]=បង្ហាញ​កាលបរិច្ឆេទ​ទាំងអស់​នៅ​ក្នុង KOrganizer នៅ​ក្នុង​ប្រព័ន្ធ​ប្រតិទិន Jewish ផងដែរ ​​។
Index: korganizer/plugins/thisdayinhistory/thisdayinhistory.desktop
===================================================================
--- korganizer/plugins/thisdayinhistory/thisdayinhistory.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/plugins/thisdayinhistory/thisdayinhistory.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -11,6 +11,7 @@
 Name[fi]=Wikipedian "Tämä päivä historiassa" -liitännäinen
 Name[fr]=Module externe « Ce jour dans l'histoire » d'après Wikipédia
 Name[gl]=Engadido "Este Dí­a na Historia" da Wikipedia
+Name[hu]=Wikipedia-bővítmény - "Történelmi események ezen a napon"
 Name[it]=Estensione "Questo giorno nella storia" di Wikipedia
 Name[ja]=Wikipedia 今日は何の日プラグイン
 Name[km]=កម្មវិធី 'ថ្ងៃនេះ​ក្នុង​ប្រវត្តិ' របស់វីគីភីឌៀ
@@ -43,6 +44,7 @@
 Comment[et]=See plugin näitab Wikipedia 'täna ajaloos' lehekülgi
 Comment[fr]=Ce module externe fourni un lien vers la page « Ce jour dans l'histoire » de Wikipédia
 Comment[gl]=Este engadido fornece ligazóns ás páxinas "Este Dí­a na Historia" da Wikipedia
+Comment[hu]=Ez a bővítmény hozzáférést biztosít a Wikipedia "Történelmi események ezen a napon" oldalához
 Comment[it]=Questa estensione fornisce la pagina "Questo giorno nella storia" di Wikipedia
 Comment[ja]=Wikipedia の「今日は何の日」へのリンクを提供します。
 Comment[km]=កម្មវិធី​នេះ ផ្ដល់​នូវ​តំណ​ទៅ​កាន់​ទំព័រ​នៃ​ប្រវត្តិ​ថ្ងៃ​នេះ​របស់ Wikipedia
Index: korganizer/views/monthview/monthview.cpp
===================================================================
--- korganizer/views/monthview/monthview.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/views/monthview/monthview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -399,3 +399,8 @@
 {
   return startDate().addDays( startDate().daysTo( endDate() ) / 2 );
 }
+
+bool MonthView::usesFullWindow()
+{
+  return KOPrefs::instance()->mFullViewMonth;
+}
Index: korganizer/views/monthview/monthview.h
===================================================================
--- korganizer/views/monthview/monthview.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/views/monthview/monthview.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -63,6 +63,8 @@
      */
     QDate averageDate() const;
 
+    bool usesFullWindow();
+
   public slots:
     virtual void updateView();
     virtual void showDates( const QDate &start, const QDate &end );
Index: korganizer/views/monthview/monthgraphicsitems.cpp
===================================================================
--- korganizer/views/monthview/monthgraphicsitems.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/views/monthview/monthgraphicsitems.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -27,6 +27,7 @@
 #include "monthitem.h"
 #include "monthscene.h"
 
+#include "koglobals.h"
 #include "koprefs.h"
 #include "kohelper.h"
 
@@ -235,10 +236,9 @@
   int textMargin = 10;
 
   QColor bgColor = mMonthItem->bgColor();
-  // keep this (110) in sync with agendaview
-  bgColor = mMonthItem->selected() ? bgColor.lighter( 110 ) : bgColor;
+  bgColor = mMonthItem->selected() ? bgColor.lighter( KOGlobals::BRIGHTNESS_FACTOR ) : bgColor;
   QColor frameColor = mMonthItem->frameColor( bgColor );
-  frameColor = mMonthItem->selected() ? frameColor.lighter( 110 ) : frameColor;
+  frameColor = mMonthItem->selected() ? frameColor.lighter( KOGlobals::BRIGHTNESS_FACTOR ) : frameColor;
   QColor textColor = getTextColor(bgColor);
 
   // make moving or resizing items translucent
Index: korganizer/views/todoview/kotodoview.h
===================================================================
--- korganizer/views/todoview/kotodoview.h	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/views/todoview/kotodoview.h	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -75,6 +75,8 @@
     void saveLayout( KConfig *config, const QString &group ) const;
     void restoreLayout( KConfig *config, const QString &group );
 
+    bool usesFullWindow();
+
   public Q_SLOTS:
     virtual void setIncidenceChanger( IncidenceChangerBase *changer );
     virtual void showDates( const QDate &start, const QDate &end );
Index: korganizer/views/todoview/kotodomodel.cpp
===================================================================
--- korganizer/views/todoview/kotodomodel.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/views/todoview/kotodomodel.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -57,7 +57,7 @@
 #endif
 
 /** This class represents a node in the todo-tree. */
-struct KOTodoModel::TodoTreeNode
+struct KOTodoModel::TodoTreeNode : QObject
 {
   TodoTreeNode( Todo *todo, TodoTreeNode *parent, KOTodoModel *model )
     : mTodo( todo ), mParent( parent ), mParentListPos( 0 ),
@@ -110,7 +110,7 @@
       toCheck << mChildren;
       while ( !toCheck.isEmpty() ) {
         TodoTreeNode *node = toCheck.takeFirst();
-        Q_ASSERT ( node->mToDelete );
+        Q_ASSERT ( node->mToDelete || !node->mTodo->relatedTo() );
         toCheck << node->mChildren;
       }
 #endif
@@ -121,7 +121,7 @@
       mParent->removeChild( tmp.row() );
       mModel->endRemoveRows();
 
-      delete this;
+      deleteLater();
     } else {
       Q_FOREACH ( TodoTreeNode *node, mChildren ) {
         node->deleteMarked();
Index: korganizer/views/todoview/kotodoview.cpp
===================================================================
--- korganizer/views/todoview/kotodoview.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/views/todoview/kotodoview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -702,4 +702,9 @@
   mModel->setFlatView( flatView );
 }
 
+bool KOTodoView::usesFullWindow()
+{
+  return KOPrefs::instance()->mFullViewTodo;
+}
+
 #include "kotodoview.moc"
Index: korganizer/views/multiagendaview/multiagendaview.cpp
===================================================================
--- korganizer/views/multiagendaview/multiagendaview.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/views/multiagendaview/multiagendaview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -193,11 +193,8 @@
              SIGNAL(pasteIncidenceSignal()) );
     connect( agenda, SIGNAL(toggleAlarmSignal(Incidence*)),
              SIGNAL(toggleAlarmSignal(Incidence*)) );
-    connect( agenda, SIGNAL(dissociateOccurrenceSignal(Incidence*, const QDate&)),
-             SIGNAL(dissociateOccurrenceSignal(Incidence*, const QDate&)) );
-    connect( agenda, SIGNAL(dissociateFutureOccurrenceSignal(Incidence*, const QDate&)),
-             SIGNAL(dissociateFutureOccurrenceSignal(Incidence*, const QDate&)) );
-
+    connect( agenda, SIGNAL(dissociateOccurrencesSignal(Incidence*, const QDate&)),
+             SIGNAL(dissociateOccurrencesSignal(Incidence*, const QDate&)) );
     connect( agenda, SIGNAL(newEventSignal(const QDate&)),
              SIGNAL(newEventSignal(const QDate&)) );
     connect( agenda, SIGNAL(newEventSignal(const QDateTime&)),
Index: korganizer/views/agendaview/koagendaitem.cpp
===================================================================
--- korganizer/views/agendaview/koagendaitem.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/views/agendaview/koagendaitem.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -873,7 +873,7 @@
   }
 
   if ( mSelected ) {
-    bgColor = bgColor.light( 110 ); // keep this in sync with month view
+    bgColor = bgColor.light( KOGlobals::BRIGHTNESS_FACTOR );
   }
 
   QColor textColor = getTextColor( bgColor );
Index: korganizer/koviewmanager.cpp
===================================================================
--- korganizer/koviewmanager.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/koviewmanager.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -160,8 +160,7 @@
 
 void KOViewManager::raiseCurrentView()
 {
-  if ( ( mMonthView && KOPrefs::instance()->mFullViewMonth && mCurrentView == mMonthView ) ||
-       ( mTodoView && KOPrefs::instance()->mFullViewTodo && mCurrentView == mTodoView ) ) {
+  if ( mCurrentView && mCurrentView->usesFullWindow() ) {
     mMainView->showLeftFrame( false );
     if ( mCurrentView == mTodoView ) {
       mMainView->navigatorBar()->hide();
Index: korganizer/kcmconfigs/korganizer_configcolorsandfonts.desktop
===================================================================
--- korganizer/kcmconfigs/korganizer_configcolorsandfonts.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/kcmconfigs/korganizer_configcolorsandfonts.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -25,6 +25,7 @@
 Name[fr]=Couleurs et polices
 Name[ga]=Dathanna agus Clónna
 Name[gl]=Cores e Tipos de letra
+Name[hu]=Színek és betűtípusok
 Name[it]=Colori e caratteri
 Name[ja]=色とフォント
 Name[km]=ពណ៌ និង​ពុម្ពអក្សរ
@@ -63,6 +64,7 @@
 Comment[fr]=Configuration des couleurs et des polices de KOrganizer
 Comment[ga]=Cumraíocht na nDathanna/gClónna le haghaidh KOrganizer
 Comment[gl]=Configuración das Cores e os Tipos de Letra do KOrganizer
+Comment[hu]=KOrganizer szín- és betűtípus-beállítások
 Comment[it]=Configurazione dei colori e dei caratteri di KOrganizer
 Comment[ja]=KOrganizer 色とフォントの設定
 Comment[km]=ការ​កំណត់​រចនាសម្ព័ន្ធ​ពុម្ពអក្សរ និង​ពណ៌ KOrganizer
Index: korganizer/kcmconfigs/korganizer_configtime.desktop
===================================================================
--- korganizer/kcmconfigs/korganizer_configtime.desktop	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/kcmconfigs/korganizer_configtime.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -25,6 +25,7 @@
 Name[fr]=Date et heure
 Name[ga]=Am agus Dáta
 Name[gl]=Hora e Data
+Name[hu]=Dátum és idő
 Name[it]=Data e ora
 Name[ja]=日付と時間
 Name[km]=កាលបរិច្ឆេទ និង​ពេលវេលា
@@ -63,6 +64,7 @@
 Comment[fr]=Configuration de la date et l'heure de KOrganizer
 Comment[ga]=Cumraíocht Ama agus Dáta le haghaidh KOrganizer
 Comment[gl]=Configuración da hora e a data do KOrganizer
+Comment[hu]=KOrganizer dátum- és időbeállítások
 Comment[it]=Configurazione data e ora di KOrganizer
 Comment[ja]=KOrganizer 日付と時間の設定
 Comment[km]=កា​រកំណត់​រចនាសម្ព័ន្ធ​កាលបរិច្ឆេទ និង​ពេលវេលា KOrganizer
Index: korganizer/incidencechanger.cpp
===================================================================
--- korganizer/incidencechanger.cpp	(.../tags/KDE/4.2.2/kdepim)	(wersja 956244)
+++ korganizer/incidencechanger.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 956244)
@@ -363,7 +363,7 @@
     // widgets sooner or later
     stdcal->setDialogParentWidget( tmpparent );
   }
-  if ( !success ) {
+  if ( !success && stdcal ) {
     // We can have a failure if the user pressed [cancel] in the resource
     // selectdialog, so check the exception.
     ErrorFormat *e = stdcal->exception();

Zmiany atrybutów dla: .
___________________________________________________________________
Dodane: svn:externals
   + 


