Index: akregator/plugins/onlinesync/akregator_onlinesync_plugin.desktop
===================================================================
--- akregator/plugins/onlinesync/akregator_onlinesync_plugin.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/plugins/onlinesync/akregator_onlinesync_plugin.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -24,6 +24,7 @@
 Name[pl]=Wsparcie dla czytnika kanałów RSS Akregator
 Name[pt]=Suporte de Leitura de Fontes de Notícias do Akregator
 Name[pt_BR]=Suporte para leitor de notícias on-line do Akregator
+Name[sl]=Akregatorjeva podpora za spletne bralnike
 Name[sv]=Stöd för Akregator kanalläsare
 Name[tr]=Akregator Çevrimiçi Kaynak Okuyucu Desteği
 Name[uk]=Підтримка читання мережевих розсилок у Akregator
Index: akregator/plugins/onlinesync/akregator_config_onlinesync.desktop
===================================================================
--- akregator/plugins/onlinesync/akregator_config_onlinesync.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/plugins/onlinesync/akregator_config_onlinesync.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -35,6 +35,7 @@
 Name[pt]=Leitores 'Online'
 Name[pt_BR]=Leitores on-line
 Name[ro]=Cititori online
+Name[sl]=Spletni bralniki
 Name[sv]=Kanalläsare
 Name[tr]=Çevrimiçi Okuyucular
 Name[uk]=Програми для читання розсилок
Index: akregator/src/articleviewer.cpp
===================================================================
--- akregator/src/articleviewer.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/src/articleviewer.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -457,7 +457,15 @@
 
     head += "</style></head><body>";
     m_part->view()->setContentsPos(0,0);
-    m_part->begin(m_link);
+
+    //pass link to the KHTMLPart to make relative links work
+    //add a bogus query item to distinguish from m_link
+    //fixes the Complete Story link if the url has an anchor (e.g. #reqRSS) in it
+    //See bug 177754
+
+    KUrl url(m_link);
+    url.addQueryItem("akregatorPreviewMode", "true");
+    m_part->begin(url);
     m_part->write(head);
 }
 
Index: akregator/src/selectioncontroller.cpp
===================================================================
--- akregator/src/selectioncontroller.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/src/selectioncontroller.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -181,12 +181,11 @@
 
 void Akregator::SelectionController::articleHeadersAvailable()
 {
-    if(m_articleModel)
-        delete m_articleModel;
+    ArticleModel* const newModel = new ArticleModel( m_selectedSubscription );
+    m_articleLister->setArticleModel( newModel );
+    delete m_articleModel;
+    m_articleModel = newModel;
 
-    m_articleModel = new Akregator::ArticleModel( m_selectedSubscription );
-    m_articleLister->setArticleModel( m_articleModel );
-
     m_articleLister->setIsAggregation( m_selectedSubscription->isAggregation() );
 
     connect( m_articleLister->articleSelectionModel(), SIGNAL( selectionChanged( QItemSelection, QItemSelection ) ),
Index: akregator/src/articlelistview.cpp
===================================================================
--- akregator/src/articlelistview.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/src/articlelistview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -144,9 +144,11 @@
 
 void ArticleListView::setArticleModel( ArticleModel* model )
 {
-    slotClear();
-    if ( !model )
+    if ( !model ) {
+        setModel( model );
         return;
+    }
+
     m_proxy = new SortColorizeProxyModel( model );
     m_proxy->setSourceModel( model );
     m_proxy->setSortRole( ArticleModel::SortRole );
@@ -164,12 +166,6 @@
     columnsProxy->setColumnEnabled( ArticleModel::AuthorColumn );
 
     setModel( columnsProxy );
-
-    if ( !m_headerSetUp )
-    {
-        loadHeaderSettings();
-        m_headerSetUp = true;
-    }
     header()->setContextMenuPolicy( Qt::CustomContextMenu );
 }
 
@@ -205,24 +201,16 @@
 
 void ArticleListView::saveHeaderSettings()
 {
-    //FIXME: HACK: Change back to saveState() when the Qt-bug is fixed
-    // is it qt-bug, really? at least saveState is working, but calling the next line causes app to hang.. -Teemu
-    //Settings::setArticlelistHeaderStates( header()->saveState().toBase64() );
-
-    QByteArray s = header()->saveState();
+    if ( model() )
+        m_headerState = header()->saveState();
     KConfigGroup conf( Settings::self()->config(), "General" );
-    conf.writeEntry( "ArticleListHeaders", s.toBase64() );
+    conf.writeEntry( "ArticleListHeaders", m_headerState.toBase64() );
 }
 
 void ArticleListView::loadHeaderSettings()
 {
-    //FIXME: HACK: change back to loadState+Settings class instead of using KConfigGroup directly..
-    //QByteArray s = QByteArray::fromBase64( Settings::feedlistHeaderStates().toAscii() ); // this fails currently, I think -Teemu
-
     KConfigGroup conf( Settings::self()->config(), "General" );
-    QByteArray s = QByteArray::fromBase64( conf.readEntry( "ArticleListHeaders" ).toAscii() );
-    if( !s.isNull() )
-        header()->restoreState( s );
+    m_headerState = QByteArray::fromBase64( conf.readEntry( "ArticleListHeaders" ).toAscii() );
 }
 
 QItemSelectionModel* ArticleListView::articleSelectionModel() const
@@ -287,8 +275,7 @@
 ArticleListView::ArticleListView( QWidget* parent )
     : QTreeView(parent),
     m_columnMode( Unspecified ),
-    m_isAggregation( false ),
-    m_headerSetUp( false )
+    m_isAggregation( false )
 {
     setSortingEnabled( true );
     setAlternatingRowColors( true );
@@ -296,7 +283,6 @@
     setUniformRowHeights( true );
     setRootIsDecorated( false );
     setAllColumnsShowFocus( true );
-
     setMinimumSize( 250, 150 );
     setWhatsThis( i18n("<h2>Article list</h2>"
         "Here you can browse articles from the currently selected feed. "
@@ -306,6 +292,7 @@
     //connect exactly once
     disconnect( header(), SIGNAL(customContextMenuRequested(QPoint)), this, SLOT(showHeaderMenu(QPoint)) );
     connect( header(), SIGNAL(customContextMenuRequested(QPoint)), this, SLOT(showHeaderMenu(QPoint)) );
+    loadHeaderSettings();
 }
 
 void ArticleListView::mousePressEvent( QMouseEvent *ev )
@@ -390,11 +377,18 @@
 }
 
 
+void ArticleListView::setModel( QAbstractItemModel* m ) {
+    QAbstractItemModel* const oldModel = model();
+    if ( oldModel )
+        m_headerState = header()->saveState();
+    QTreeView::setModel( m );
+    if ( m )
+        header()->restoreState( m_headerState );
+}
+
 void ArticleListView::slotClear()
 {
-    QAbstractItemModel* const oldModel = model();
     setModel( 0L );
-    delete oldModel;
 }
 
 void ArticleListView::slotPreviousArticle()
Index: akregator/src/subscriptionlistview.h
===================================================================
--- akregator/src/subscriptionlistview.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/src/subscriptionlistview.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -28,6 +28,7 @@
 #include <QTreeView>
 #include <QMap>
 #include <QAction>
+#include <QByteArray>
 
 class KMenu;
 
@@ -83,7 +84,7 @@
     void headerMenuItemTriggered( QAction* action );
 
 private:
-    bool m_headerSetup;
+    QByteArray m_headerState;
 };
 
 }
Index: akregator/src/akregator_part.cpp
===================================================================
--- akregator/src/akregator_part.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/src/akregator_part.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -103,6 +103,8 @@
     , m_dialog(0)
 
 {
+    initFonts();
+
     setPluginLoadingMode( LoadPluginsIfEnabled );
     setPluginInterfaceVersion( AKREGATOR_PLUGIN_INTERFACE_VERSION );
 
@@ -180,8 +182,6 @@
     connect(m_autosaveTimer, SIGNAL(timeout()), this, SLOT(slotSaveFeedList()));
     m_autosaveTimer->start(5*60*1000); // 5 minutes
 
-    initFonts();
-
     QString useragent = QString( "Akregator/%1; syndication" ).arg( AKREGATOR_VERSION );
 
     if( !Settings::customUserAgent().isEmpty() )
Index: akregator/src/subscriptionlistview.cpp
===================================================================
--- akregator/src/subscriptionlistview.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/src/subscriptionlistview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -55,7 +55,7 @@
             i = i.child( model->rowCount( i ) - 1, i.column() );
         return i;
     }
-    else 
+    else
         return idx.parent();
 }
 
@@ -104,7 +104,7 @@
         if ( i.row() + 1 < siblings )
             return i.sibling( i.row() + 1, i.column() );
         i = i.parent();
-    }   
+    }
 }
 
 QModelIndex nextFeedIndex( const QModelIndex& idx )
@@ -134,8 +134,9 @@
     setDragDropMode( QAbstractItemView::DragDrop );
     setDropIndicatorShown( true );
     setAcceptDrops( true );
-    m_headerSetup = false;
     connect( header(), SIGNAL( customContextMenuRequested( const QPoint & ) ), this, SLOT( showHeaderMenu( const QPoint& ) ) );
+
+    loadHeaderSettings();
 }
 
 Akregator::SubscriptionListView::~SubscriptionListView()
@@ -143,19 +144,25 @@
     saveHeaderSettings();
 }
 
-void Akregator::SubscriptionListView::setModel( QAbstractItemModel* model )
+void Akregator::SubscriptionListView::setModel( QAbstractItemModel* m )
 {
-    QTreeView::setModel( model );
-    
+    if ( model() )
+        m_headerState = header()->saveState();
+
+    QTreeView::setModel( m );
+
+    if ( m )
+        header()->restoreState( m_headerState );
+
     QStack<QModelIndex> stack;
     stack.push( rootIndex() );
     while ( !stack.isEmpty() )
     {
         const QModelIndex i = stack.pop();
-        const int childCount = model->rowCount( i );
+        const int childCount = m->rowCount( i );
         for ( int j = 0; j < childCount; ++j )
         {
-            const QModelIndex child = model->index( j, 0, i );
+            const QModelIndex child = m->index( j, 0, i );
             if ( child.isValid() )
                 stack.push( child );
         }
@@ -163,11 +170,6 @@
     }
 
     header()->setContextMenuPolicy( Qt::CustomContextMenu );
-
-    if( ! m_headerSetup ) {
-        loadHeaderSettings();
-        m_headerSetup = true;
-    }
 }
 
 void Akregator::SubscriptionListView::showHeaderMenu( const QPoint& pos )
@@ -179,7 +181,7 @@
     menu->addTitle( i18n( "Columns" ) );
     menu->setAttribute( Qt::WA_DeleteOnClose );
     connect(menu, SIGNAL( triggered( QAction* ) ), this, SLOT( headerMenuItemTriggered( QAction* ) ) );
-    
+
     for (int i = 0; i < model()->columnCount(); i++)
     {
         QString col = model()->headerData( i, Qt::Horizontal, Qt::DisplayRole ).toString();
@@ -188,7 +190,7 @@
         act->setChecked( !header()->isSectionHidden( i ) );
         act->setData( i );
     }
-    
+
     menu->popup( header()->mapToGlobal( pos ) );
 }
 
@@ -203,24 +205,17 @@
 }
 
 void Akregator::SubscriptionListView::saveHeaderSettings()
-{ 
-    QByteArray s = header()->saveState();
+{
+    if ( model() )
+        m_headerState = header()->saveState();
     KConfigGroup conf( Settings::self()->config(), "General" );
-    conf.writeEntry( "SubscriptionListHeaders", s.toBase64() );
-
-    //FIXME: HACK: Change back to Settings, when it starts to work again..
-    // Settings::setFeedlistHeaderStates( s.toBase64() );
+    conf.writeEntry( "SubscriptionListHeaders", m_headerState.toBase64() );
 }
 
 void Akregator::SubscriptionListView::loadHeaderSettings()
 {
-    // FIXME: HACK: Change back to Settings when it's working
-    //QByteArray s = QByteArray::fromBase64( Settings::feedlistHeaderStates().toAscii() );
-    
-    KConfigGroup conf( Settings::self()->config(), "General" );
-    QByteArray s = QByteArray::fromBase64( conf.readEntry( "SubscriptionListHeaders" ).toAscii() );
-    if( !s.isNull() )
-        header()->restoreState( s );
+    const KConfigGroup conf( Settings::self()->config(), "General" );
+    m_headerState = QByteArray::fromBase64( conf.readEntry( "SubscriptionListHeaders" ).toAscii() );
 }
 
 void Akregator::SubscriptionListView::slotPrevFeed()
@@ -235,7 +230,7 @@
     }
     if ( prev.isValid() )
         setCurrentIndex( prev );
-    
+
 }
 
 void Akregator::SubscriptionListView::slotNextFeed()
@@ -276,7 +271,7 @@
 
 void SubscriptionListView::slotItemBegin()
 {
-    
+
 }
 
 void SubscriptionListView::slotItemEnd()
@@ -285,22 +280,22 @@
 
 void SubscriptionListView::slotItemLeft()
 {
-    
+
 }
 
 void SubscriptionListView::slotItemRight()
 {
-    
+
 }
 
 void SubscriptionListView::slotItemUp()
 {
-    
+
 }
 
 void SubscriptionListView::slotItemDown()
 {
-    
+
 }
 
 
Index: akregator/src/articlelistview.h
===================================================================
--- akregator/src/articlelistview.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/src/articlelistview.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -119,6 +119,8 @@
 
     void setIsAggregation( bool isAggregation );
 
+    /* reimp */ void setModel( QAbstractItemModel* model );
+
 protected:
     void mousePressEvent( QMouseEvent *ev );
 
@@ -162,8 +164,8 @@
     ColumnMode m_columnMode;
     bool m_isAggregation;
     QPointer<SortColorizeProxyModel> m_proxy;
-    bool m_headerSetUp;
     std::vector<boost::shared_ptr<const Filters::AbstractMatcher> > m_matchers;
+    QByteArray m_headerState;
 };
 
 } // namespace Akregator
Index: akregator/configuration/akregator_config_browser.desktop
===================================================================
--- akregator/configuration/akregator_config_browser.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/configuration/akregator_config_browser.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -66,6 +66,7 @@
 Comment[pt]=Configurar a Componente de Navegação Interna
 Comment[pt_BR]=Configurar o componente de navegação interna
 Comment[ro]=Configurează componenta internă de navigare
+Comment[sl]=Nastavite vgrajeno komponento za brskanje
 Comment[sv]=Anpassa intern webbläsningskomponent
 Comment[tr]=İç Tarayıcı Bileşenini Yapılandır
 Comment[uk]=Налаштування вбудованого компонента переглядача
Index: akregator/configuration/akregator_config_appearance.desktop
===================================================================
--- akregator/configuration/akregator_config_appearance.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/configuration/akregator_config_appearance.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -93,6 +93,7 @@
 Comment[pt]=Configurar a Aparência do Leitor de Fontes
 Comment[pt_BR]=Configurar a aparência do leitor de fontes de notícias
 Comment[ro]=Configurează aspectul cititorului de fluxuri
+Comment[sl]=Nastavite videz bralnika virov
 Comment[sv]=Anpassa kanalläsarens utseende
 Comment[tr]=Haber Okuyucu Görünümünü Yapılandır
 Comment[uk]=Налаштування вигляду програми читання розсилок
Index: akregator/configuration/akregator_config_archive.desktop
===================================================================
--- akregator/configuration/akregator_config_archive.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akregator/configuration/akregator_config_archive.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -68,6 +68,7 @@
 Comment[pt_BR]=Configurar o arquivo de fontes de notícias
 Comment[ro]=Configurează arhiva de fluxuri
 Comment[ru]=Настройка архива лент
+Comment[sl]=Nastavite arhiv vira
 Comment[sv]=Anpassa kanalarkivet
 Comment[tr]=Haber Arşivini Yapılandır
 Comment[uk]=Налаштування архіву розсилок
Index: cmake/modules/FindAssuan.cmake
===================================================================
--- cmake/modules/FindAssuan.cmake	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ cmake/modules/FindAssuan.cmake	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -75,12 +75,6 @@
 
   else()
 
-    # is this needed, of just unreflected cut'n'paste?
-    # this isn't a KDE library, after all!
-    if( NOT KDEWIN_FOUND )
-      find_package( KDEWIN REQUIRED )
-    endif()
-
     set( ASSUAN_FOUND         false )
     set( ASSUAN_VANILLA_FOUND false )
     #set( ASSUAN_GLIB_FOUND    false )
Index: libkleo/libkleopatrarc.desktop
===================================================================
--- libkleo/libkleopatrarc.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ libkleo/libkleopatrarc.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -318,6 +318,7 @@
 Name[es]=Otras claves
 Name[et]=Muud võtmed
 Name[fr]=Autres clés
+Name[fy]=Oare kaaien
 Name[ga]=Eochracha Eile
 Name[gl]=Outras Chaves
 Name[it]=Altre chiavi
Index: kleopatra/kleopatra_import.desktop
===================================================================
--- kleopatra/kleopatra_import.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kleopatra/kleopatra_import.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -36,6 +36,7 @@
 Comment[pt]=Gestor de Certificados e GUI Unificada de Criptografia
 Comment[pt_BR]=Gerenciador de certificados e interface gráfica do usuário unificada
 Comment[ru]=Менеджер сертификата и унифицированный интерфейс пользователя для работы с криптографией.
+Comment[sl]=Upravljalnik potrdil in enoten šifrirni vmesnik
 Comment[sv]=Certifikathantering och gemensamt grafiskt användargränssnitt för kryptering
 Comment[tr]=Sertifika Yöneticisi ve Birleşik Şifreleme Arayüzü
 Comment[uk]=Засіб для керування сертифікатами і уніфікований графічний інтерфейс шифрування
Index: kleopatra/conf/kleopatra_config_smimevalidation.desktop
===================================================================
--- kleopatra/conf/kleopatra_config_smimevalidation.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kleopatra/conf/kleopatra_config_smimevalidation.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -64,6 +64,7 @@
 Comment[pl]=Konfiguracja opcji walidacji certyfikatu S/MIME
 Comment[pt]=Configuração das opções de validação do certificado de S/MIME
 Comment[pt_BR]=Configuração das opções de validação do certificado de S/MIME
+Comment[sl]=Nastavitev možnosti preverjanja potrdil S/MIME
 Comment[sv]=Anpassning av alternativ för S/MIME-certifikatvalidering
 Comment[th]=การปรับแต่งค่าตัวเลือกการตรวจความถูกต้องของ S/MIME
 Comment[tr]=S/MIME sertifika geçerlilik doğrulaması seçeneklerinin yapılandırması
Index: kleopatra/conf/kleopatra_config_dirserv.desktop
===================================================================
--- kleopatra/conf/kleopatra_config_dirserv.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kleopatra/conf/kleopatra_config_dirserv.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -88,6 +88,7 @@
 Comment[pl]=Konfiguracja usług katalogowych
 Comment[pt]=Configuração dos serviços de directório
 Comment[pt_BR]=Configuração dos serviços de diretório
+Comment[sl]=Nastavitev imeniških storitev
 Comment[sv]=Inställning av katalogtjänster
 Comment[th]=การปรับแต่งบริการไดเรกทอรี
 Comment[tr]=Dizin servisleri yapılandırması
Index: kleopatra/kleopatra_decryptverifyfolders.desktop
===================================================================
--- kleopatra/kleopatra_decryptverifyfolders.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kleopatra/kleopatra_decryptverifyfolders.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -25,6 +25,7 @@
 Name[pl]=Odszyfrowanie/weryfikacja wszystkich plików w katalogu w Kleopatrze
 Name[pt]=Descodificação/Verificação de Todos os Ficheiros da Pasta do Kleopatra
 Name[pt_BR]=Descriptografia/verificação do Kleopatra em todos os arquivos da pasta
+Name[sl]=Dešifriranje/preverjanje vseh datotek v mapi s Kleopatro
 Name[sv]=Avkoda och verifiera alla filer i katalogen med Kleopatra
 Name[tr]=Kleopatra Bu Dizindeki Tüm Dosyaların Şifrelemesini Aç/Doğrula
 Name[uk]=Розшифрування/Перевірка всіх файлів у теці у Kleopatra
@@ -57,6 +58,7 @@
 Name[pl]=Odszyfruj/weryfikuj wszystkie pliki w katalogu
 Name[pt]=Descodificar/Verificar Todos os Ficheiros na Pasta
 Name[pt_BR]=Descriptografia/verificação em todos os arquivos da pasta
+Name[sl]=Dešifriraj/preveri vse datoteke v mapi
 Name[sv]=Avkoda och verifiera alla filer i katalogen
 Name[tr]=Bu Dizindeki Tüm Dosyaların Şifrelemesini Aç/Doğrula
 Name[uk]=Розшифрувати/Перевірити всі файли у теці
Index: kleopatra/kleopatra_decryptverifyfiles.desktop
===================================================================
--- kleopatra/kleopatra_decryptverifyfiles.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kleopatra/kleopatra_decryptverifyfiles.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -26,6 +26,7 @@
 Name[pl]=Odszyfrowanie/weryfikacja plików w Kleopatrze
 Name[pt]=Descodificação/Verificação de Ficheiros do Kleopatra
 Name[pt_BR]=Descriptografia/verificação de arquivos do Kleopatra
+Name[sl]=Dešifriranje/preverjanje datotek s Kleopatro
 Name[sv]=Avkoda och verifiera filer med Kleopatra
 Name[tr]=Kleopatra Dosyaların Şifrelemesini Aç/Doğrula
 Name[uk]=Розшифрування/Перевірка файлів у Kleopatra
@@ -58,6 +59,7 @@
 Name[pl]=Odszyfruj/weryfikuj plik
 Name[pt]=Descodificar/Verificar o Ficheiro
 Name[pt_BR]=Descriptografia/verificação do arquivo
+Name[sl]=Dešifriraj/preveri datoteko
 Name[sv]=Avkoda och verifiera fil
 Name[tr]=Dosyaların Şifrelemesini Aç/Doğrula
 Name[uk]=Розшифрувати/Перевірити файл
Index: kleopatra/kleopatra_signencryptfolders.desktop
===================================================================
--- kleopatra/kleopatra_signencryptfolders.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kleopatra/kleopatra_signencryptfolders.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -26,6 +26,7 @@
 Name[pl]=Podpisywanie/szyfrowanie katalogów w Kleopatrze
 Name[pt]=Assinatura/Encriptação de Pastas do Kleopatra
 Name[pt_BR]=Assinatura/criptografia de pastas do Kleopatra
+Name[sl]=Podpisovanje/šifriranje map s Kleopatro
 Name[sv]=Signera och kryptera kataloger med Kleopatra
 Name[tr]=Kleopatra Dizinleri İmzala/Şifrele
 Name[uk]=Підписування/Шифрування тек у Kleopatra
@@ -58,6 +59,7 @@
 Name[pt]=Arquivar, Assinar e Encriptar a Pasta
 Name[pt_BR]=Arquivar, assinar e criptografar a pasta
 Name[ro]=Arhivează, semnează și criptează dosarul
+Name[sl]=Arhiviraj, podpiši in šifriraj mapo
 Name[sv]=Arkivera, signera och kryptera katalog
 Name[tr]=Dizini Arşivle, İmzala & Şifrele
 Name[uk]=Архівувати, підписати і зашифрувати теку
Index: kleopatra/kleopatra_signencryptfiles.desktop
===================================================================
--- kleopatra/kleopatra_signencryptfiles.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kleopatra/kleopatra_signencryptfiles.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -27,6 +27,7 @@
 Name[pl]=Podpisz/zaszyfruj pliki w Kleopatrze
 Name[pt]=Assinatura/Encriptação de Ficheiros do Kleopatra
 Name[pt_BR]=Assinatura/criptografia de arquivos do Kleopatra
+Name[sl]=Podpisovanje/šifriranje datotek s Kleopatro
 Name[sv]=Signera och kryptera filer med Kleopatra
 Name[tr]=Kleopatra Dosyaları İmzala/Şifrele
 Name[uk]=Підписування/Шифрування файлів у Kleopatra
@@ -60,6 +61,7 @@
 Name[pt]=Encriptar & Assinar o Ficheiro
 Name[pt_BR]=Criptografar e assinar arquivo
 Name[ro]=Criptează și semnează fișierul
+Name[sl]=Šifriraj in podpiši datoteko
 Name[sv]=Kryptera och signera fil
 Name[th]=เข้ารหัสและเซ็นกำกับแฟ้ม
 Name[tr]=Dosyayı Şifrele & İmzala
@@ -132,6 +134,7 @@
 Name[pt]=Assinar o Ficheiro com o OpenPGP
 Name[pt_BR]=Assinar arquivo com OpenPGP
 Name[ro]=Semnează fișierul cu OpenPGP
+Name[sl]=Podpiši datoteko z OpenPGP
 Name[sv]=Signera fil med OpenPGP
 Name[tr]=Dosyayı OpenPGP-İmzala
 Name[uk]=Підписати файл з OpenPGP
@@ -166,6 +169,7 @@
 Name[pt]=Assinar o Ficheiro com o S/MIME
 Name[pt_BR]=Assinar arquivo com S/MIME
 Name[ro]=Semnează fișierul cu S/MIME
+Name[sl]=Podpiši datoteko z S/MIME
 Name[sv]=Signera fil med S/MIME
 Name[tr]=Dosyayı S/MIME-İmzala
 Name[uk]=Підписати файл з S/MIME
Index: kresources/blog/blog.desktop
===================================================================
--- kresources/blog/blog.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/blog/blog.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -55,6 +55,7 @@
 Comment[pl]=Pozwala na wysyłanie wpisów dziennika jako wpisów na blogach
 Comment[pt]=Permite-lhe publicar itens do diário como publicações num 'blog'
 Comment[pt_BR]=Permite-lhe postar entradas de diário como entradas de blog
+Comment[sl]=Omogoča objavo dnevniških vnosov v koledarju kot sestavkov za blog
 Comment[sv]=Gör det möjligt att skriva ut journalanteckningar som webbjournalinlägg
 Comment[tr]=Takvim günlük girdilerini günlük (blog) girdileri olarak göndermeyi sağlar
 Comment[uk]=Надає можливість розміщувати записи журналу календаря як записи у блозі.
Index: kresources/scalix/kabc/scalix.desktop
===================================================================
--- kresources/scalix/kabc/scalix.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/scalix/kabc/scalix.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -51,6 +51,7 @@
 Comment[pl]=Zapewnia dostęp do wizytówek przechowywanych na serwerze Scalix przy użyciu IMAP w KMailu lub Kontakcie
 Comment[pt]=Oferece o acesso aos contactos guardados num servidor de Scalix por IMAP, através do KMail ou do Kontact
 Comment[pt_BR]=Fornece acesso aos contatos armazenados em um servidor Scalix usando IMAP, pelo KMail ou Kontact
+Comment[sl]=Prek IMAPa v KMail ali Kontact omogoča dostop do stikov, shranjenih na strežniku Scalix.
 Comment[sv]=Ger tillgång till kontakter lagrade på en Scalix-server med användning av IMAP via Kmail eller Kontact
 Comment[tr]=KMail ya da KOntact IMAP kullanarak Scalix sunucusu üzerindeki kişilere erişim sağlar
 Comment[uk]=Надає доступ до календаря, який зберігається на сервері Scalix, за допомогою IMAP за посередництва KMail або Kontact
Index: kresources/slox/kabc_ox.desktop
===================================================================
--- kresources/slox/kabc_ox.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/slox/kabc_ox.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -65,6 +65,7 @@
 Comment[pl]=Zapewnia dostęp do wizytówek przechowywanych na serwerze Open-Xchange
 Comment[pt]=Oferece o acesso aos contactos guardados num servidor de Open-Xchange
 Comment[pt_BR]=Fornece acesso aos contatos armazenados em um servidor Open-Xchange
+Comment[sl]=Omogoča dostop do stikov, shranjenih na strežniku Open-Xchange.
 Comment[sv]=Ger tillgång till kontakter lagrade på en Open-Xchange-server
 Comment[tr]=Open-Xchange sunucusu üzerindeki kişilere erişim sağlar
 Comment[uk]=Надає доступ до контактів, які зберігаються на сервері Open-Xchange.
Index: kresources/groupdav/kabc_groupdav.desktop
===================================================================
--- kresources/groupdav/kabc_groupdav.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/groupdav/kabc_groupdav.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -35,7 +35,7 @@
 Name[nn]=GroupDAV-tenar (som OpenGroupware)
 Name[pl]=Serwer GroupDAV (np. OpenGroupware)
 Name[pt]=Servidor GroupDAV (por exemplo OpenGroupware)
-Name[pt_BR]=Servidor GroupDav (p. ex. OpenGroupware)
+Name[pt_BR]=Servidor GroupDav (ex. OpenGroupware)
 Name[ru]=Сервер GroupDAV (например, OpenGroupware)
 Name[sk]=GroupDAV Server (napr. OpenGroupware)
 Name[sl]=Strežnik GroupDAV (npr. OpenGroupware)
@@ -66,6 +66,7 @@
 Comment[pl]=Zapewnia dostęp do wizytówek w książkach adresowych serwerów GroupDAV, np. OpenGroupware
 Comment[pt]=Oferece o acesso aos contactos guardados nos livros de endereços dos servidores baseados em GroupDAV, p.ex. o OpenGroupware
 Comment[pt_BR]=Fornece acesso aos contatos armazenados nos livros de endereços dos servidores habilitados GroupDAV, como o OpenGroupware
+Comment[sl]=Omogoča dostop do stikov, shranjenih v adresarjih na strežnikih, ki podpirajo GroupDAV, npr. OpenGroupware
 Comment[sv]=Ger tillgång till kontakter lagrade i adressböcker på servrar som kan hantera GroupDAV, t.ex. OpenGroupware
 Comment[tr]=GroupDAV etkinleştirilmiş olan sunucular üzerinde bulunan adres defterindeki kişilere erişimi sağlar, OpenGroupware gibi
 Comment[uk]=Надає доступ до контактів, які зберігаються у адресних книгах на серверах з увімкненим GroupDAV, наприклад, OpenGroupware.
Index: kresources/groupdav/kcal_groupdav.desktop
===================================================================
--- kresources/groupdav/kcal_groupdav.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/groupdav/kcal_groupdav.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -35,7 +35,7 @@
 Name[nn]=GroupDAV-tenar (som OpenGroupware)
 Name[pl]=Serwer GroupDAV (np. OpenGroupware)
 Name[pt]=Servidor GroupDAV (por exemplo OpenGroupware)
-Name[pt_BR]=Servidor GroupDav (p. ex. OpenGroupware)
+Name[pt_BR]=Servidor GroupDav (ex. OpenGroupware)
 Name[ru]=Сервер GroupDAV (например, OpenGroupware)
 Name[sk]=GroupDAV Server (napr. OpenGroupware)
 Name[sl]=Strežnik GroupDAV (npr. OpenGroupware)
Index: kresources/kolab/kabc/kolab.desktop
===================================================================
--- kresources/kolab/kabc/kolab.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/kolab/kabc/kolab.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -36,7 +36,7 @@
 Name[nn]=Adressebok på IMAP-tenar via KMail
 Name[pl]=Książka adresowa na serwerze IMAP za pośrednictwem KMail
 Name[pt]=Livro de Endereços em Servidor IMAP via KMail
-Name[pt_BR]=Livro de endereços em servidor IMAP via KMail
+Name[pt_BR]=Livro de endereços em servidor IMAP com o KMail
 Name[ru]=Адресная книга на сервере IMAP через KMail
 Name[sk]=Adresár na IMAP-serveri pomocou KMail
 Name[sl]=Adresar na strežniku IMAP preko KMaila
@@ -66,7 +66,8 @@
 Comment[nn]=Gjev tilgang til kontaktar lagra på ein Kolab-tenar med IMAP via KMail eller Kontakt
 Comment[pl]=Zapewnia dostęp do wizytówek przechowychanych na serwerze Kolab przy użyciu IMAP w KMailu lub Kontakcie
 Comment[pt]=Oferece o acesso aos contactos guardados num servidor de Kolab por IMAP, através do KMail ou do Kontact
-Comment[pt_BR]=Fornece acesso aos contatos armazenados em um servidor Kolab usando IMAP, pelo KMail ou Kontact
+Comment[pt_BR]=Fornece acesso aos contatos armazenados em um servidor Kolab usando IMAP com o KMail ou Kontact
+Comment[sl]=Prek IMAPa v KMail ali Kontact omogoča dostop do stikov, shranjenih na strežniku Kolab.
 Comment[sv]=Ger tillgång till kontakter lagrade på en Kolab-server med användning av IMAP via Kmail eller Kontact
 Comment[tr]=KMail ya da KOntact IMAP kullanarak Kolab sunucusu üzerindeki kişilere erişim sağlar
 Comment[uk]=Надає доступ до контактів, які зберігаються на сервері Kolab за допомогою IMAP за посередництва KMail або Kontact.
Index: kresources/kolab/kcal/kolab.desktop
===================================================================
--- kresources/kolab/kcal/kolab.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/kolab/kcal/kolab.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -66,8 +66,10 @@
 Comment[nn]=Gjev tilgang til kalendrar lagra på ein Kolab-tenar med IMAP via KMail eller Kontakt
 Comment[pl]=Zapewnia dostęp do kalendarza przechowywanego na serwerze Kolab przy użyciu IMAP w KMailu lub Kontakcie
 Comment[pt]=Oferece o acesso a um calendário guardado num servidor Kolab por IMAP, através do KMail ou do Kontact
-Comment[pt_BR]=Fornece acesso a um calendário armazenado em um servidor Kolab usando IMAP, pelo KMail ou Kontact
+Comment[pt_BR]=Fornece acesso a um calendário armazenado em um servidor Kolab usando IMAP com o KMail ou Kontact
+Comment[sl]=Prek IMAPa v KMail ali Kontact omogoča dostop do koledarja, shranjenega na strežniku Kolab.
 Comment[sv]=Ger tillgång till en kalender lagrad på en Kolab-server med användning av IMAP via Kmail eller Kontact
+Comment[tr]=KMail veya Kontact aracılığıyla IMAP kullanarak bir Kolab sunucusunda depolanan bir takvime erişim sağlar
 Comment[uk]=Надає доступ до календаря, який зберігається на сервері Kolab, за допомогою IMAP за посередництва KMail або Kontact
 Comment[x-test]=xxProvides access to a calendar stored on a Kolab server using IMAP via KMail or Kontactxx
 Comment[zh_CN]=通过 KMail 或 Kontact 的 IMAP 功能，提供对存储在 Kolab 服务器上的日历的访问支持
Index: kresources/birthdays/kabc.desktop
===================================================================
--- kresources/birthdays/kabc.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/birthdays/kabc.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -74,6 +74,7 @@
 Comment[pl]=Zapewnia dostęp do dat urodzin wizytówek w książce adresowej KDE jako zdarzeń kalendarza
 Comment[pt]=Oferece o acesso às datas de aniversário dos contactos no livro de endereços como eventos do calendário
 Comment[pt_BR]=Fornece acesso às datas de aniversário de contatos do livro de endereços do KDE como eventos de calendário
+Comment[sl]=Omogoča dostop do rojstnih dnevov stikov, shranjenih v KDE-jevem adresarju. Na voljo so kot koledarski dogodki.
 Comment[sv]=Ger tillgång till födelsedagsdatum för kontakter i KDE:s adressbok som kalenderhändelser
 Comment[tr]=KDE Adres defterindeki kişilerin doğumgünü günlerine takvim olayları olarak erişmeyi sağlar
 Comment[uk]=Надає доступ до дат днів народження, які зберігаються у адресній книзі KDE як події календаря
Index: kresources/remote/remote.desktop
===================================================================
--- kresources/remote/remote.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/remote/remote.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -71,7 +71,9 @@
 Comment[pl]=Zapewnia dostęp do kalendarza w zdalnym pliku przy użyciu systemu sieciowego KDE - KIO
 Comment[pt]=Oferece o acesso a um calendário num ficheiro remoto, usando um KIO da plataforma de rede do KDE
 Comment[pt_BR]=Fornece acesso a um calendário em um arquivo remoto usando o KIO framework da rede do KDE
+Comment[sl]=Z uporabo KDE-jevega omrežnega ogrodja KIO omogoča dostop do koledarja, ki je shranjen v oddaljeni datoteki
 Comment[sv]=Ger tillgång till en kalender i en fjärrfil med användning av KDE:s I/O-ramverk
+Comment[tr]=KDE'nin ağ çatısı KIO'yu kullanarak uzak bir dosyadaki bir takvime erişimi sağlar
 Comment[uk]=Надає доступ до календаря, який зберігається у віддаленому файлі, за допомогою засобів KIO KDE
 Comment[x-test]=xxProvides access to a calendar in a remote file using KDE's network framework KIOxx
 Comment[zh_CN]=通过 KDE 网络框架 KIO，提供对远程日历文件的访问支持
Index: kresources/akonadi/kabc/akonadi.desktop
===================================================================
--- kresources/akonadi/kabc/akonadi.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/akonadi/kabc/akonadi.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -50,6 +50,7 @@
 Comment[pl]=Zapewnia dostęp do wizytówek przechowywanych w katalogach książki adresowej Akonadi
 Comment[pt]=Oferece o acesso aos contactos guardados nas pastas do livro de endereços do Akonadi
 Comment[pt_BR]=Fornece acesso aos contatos armazenados nas pastas do livro de endereços do Akonadi
+Comment[sl]=Omogoča dostop do stikov, shranjenih v Akonadijevih mapah z adresarji
 Comment[sv]=Ger tillgång till kontakter lagrade i Akonadi adressbokskataloger
 Comment[tr]=Akonadi adres defteri dizinlerindeki kişilere erişimi sağlar
 Comment[uk]=Надає доступ до контактів, які зберігаються у теках адресної книги Akonadi
Index: kresources/akonadi/kcal/akonadi.desktop
===================================================================
--- kresources/akonadi/kcal/akonadi.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/akonadi/kcal/akonadi.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -24,6 +24,7 @@
 Comment[pl]=Zapewnia dostęp do kalendarzy przechowywanych w katalogach kalendarzy Akonadi
 Comment[pt]=Oferece o acesso aos calendários guardados nas pastas de calendários do Akonadi
 Comment[pt_BR]=Fornece acesso aos calendários armazenados nas pastas de calendários do Akonadi
+Comment[sl]=Omogoča dostop do koledarjev, shranjenih v Akonadijevih mapah s koledarji
 Comment[sv]=Ger tillgång till kalendrar lagrade i Akonadi-kalenderkataloger
 Comment[tr]=Akonadi takvim dizinlerindeki takvimlere erişim sağlar
 Comment[uk]=Надає доступ до календарів, які зберігаються у теках календарів Akonadi
Index: kresources/groupware/kabc_groupware.desktop
===================================================================
--- kresources/groupware/kabc_groupware.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kresources/groupware/kabc_groupware.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -67,6 +67,7 @@
 Comment[pl]=Zapewnia dostęp do wizytówek przechowywanych na serwerach pracy grupowej.
 Comment[pt]=Oferece o acesso aos contactos guardados num servidor de Groupware.
 Comment[pt_BR]=Fornece acesso aos contatos armazenados em um servidor de Groupware.
+Comment[sl]=Omogoča dostop do stikov, shranjenih na strežniku Groupware.
 Comment[sv]=Ger tillgång till kontakter lagrade på en grupprogramserver.
 Comment[tr]=Groupware sunucusu üzerindeki kişilere erişim sağlar.
 Comment[uk]=Надає доступ до контактів, які зберігаються на сервері Groupware.
Index: kmail/messagelistview/core/sortorder.cpp
===================================================================
--- kmail/messagelistview/core/sortorder.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmail/messagelistview/core/sortorder.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -140,7 +140,7 @@
   OptionList groupSortings = enumerateGroupSortingOptions( aggregation->grouping() );
   OptionList groupSortDirections = enumerateGroupSortDirectionOptions( aggregation->grouping(),
                                                                        mGroupSorting );
-  SortOrder defaultSortOrder = defaultForAggregation( aggregation );
+  SortOrder defaultSortOrder = defaultForAggregation( aggregation, SortOrder() );
   bool messageSortingOk = optionListHasOption( messageSortings,
                                                mMessageSorting, defaultSortOrder.messageSorting() );
   bool messageSortDirectionOk = optionListHasOption( messageSortDirections, mMessageSortDirection,
@@ -155,37 +155,65 @@
          groupSortingOk && groupSortDirectionOk;
 }
 
-SortOrder SortOrder::defaultForAggregation( const Aggregation *aggregation )
+SortOrder SortOrder::defaultForAggregation( const Aggregation *aggregation,
+                                            const SortOrder &oldSortOrder )
 {
+  SortOrder newSortOrder;
+
+  //
+  // First check if we can adopt the message sorting and the message sort direction from
+  // the old sort order. This is mostly true, except, for example, when the old message sorting
+  // was "by most recent in subtree", and the aggregation doesn't use threading.
+  //
+  OptionList messageSortings = enumerateMessageSortingOptions( aggregation->threading() );
+  bool messageSortingOk = optionListHasOption( messageSortings,
+                                               oldSortOrder.messageSorting(),
+                                               SortOrder().messageSorting() );
+  bool messageSortDirectionOk = false;
+  if ( messageSortingOk ) {
+    OptionList messageSortDirections = enumerateMessageSortDirectionOptions(
+                                              oldSortOrder.messageSorting() );
+    messageSortDirectionOk = optionListHasOption( messageSortDirections, oldSortOrder.messageSortDirection(),
+                                                  SortOrder().messageSortDirection() );
+  }
+
+  //
+  // Ok, if we can partly adopt the old sort order, set the values now.
+  //
+  if ( messageSortingOk )
+    newSortOrder.setMessageSorting( oldSortOrder.messageSorting() );
+  else
+    newSortOrder.setMessageSorting( SortMessagesByDateTime );
+  if ( messageSortDirectionOk )
+    newSortOrder.setMessageSortDirection( oldSortOrder.messageSortDirection() );
+  else
+    newSortOrder.setMessageSortDirection( Descending );
+
+  //
+  // Now set the group sorting and group sort direction, depending on the aggregation.
+  //
   Aggregation::Grouping grouping = aggregation->grouping();
   if ( grouping == Aggregation::GroupByDate ||
        grouping == Aggregation::GroupByDateRange ) {
-    SortOrder order;
-    order.setGroupSortDirection( Descending );
-    order.setGroupSorting( SortGroupsByDateTime );
-    order.setMessageSortDirection( Descending );
-    order.setMessageSorting( SortMessagesByDateTime );
-    return order;
+    newSortOrder.setGroupSortDirection( Descending );
+    newSortOrder.setGroupSorting( SortGroupsByDateTime );
+
   }
   else if ( grouping == Aggregation::GroupByReceiver || grouping == Aggregation::GroupBySender ||
             grouping == Aggregation::GroupBySenderOrReceiver ) {
-    SortOrder order;
-    order.setGroupSortDirection( Descending );
-    order.setMessageSortDirection( Descending );
-    order.setMessageSorting( SortMessagesByDateTime );
+    newSortOrder.setGroupSortDirection( Descending );
     switch ( grouping ) {
       case Aggregation::GroupByReceiver:
-        order.setGroupSorting( SortGroupsByReceiver ); break;
+        newSortOrder.setGroupSorting( SortGroupsByReceiver ); break;
       case Aggregation::GroupBySender:
-        order.setGroupSorting( SortGroupsBySender ); break;
+        newSortOrder.setGroupSorting( SortGroupsBySender ); break;
       case Aggregation::GroupBySenderOrReceiver:
-        order.setGroupSorting( SortGroupsBySenderOrReceiver ); break;
+        newSortOrder.setGroupSorting( SortGroupsBySenderOrReceiver ); break;
       default: break;
     }
-    return order;
   }
-  else
-    return SortOrder();
+
+  return newSortOrder;
 }
 
 bool SortOrder::readConfigHelper( KConfigGroup &conf, const QString &id )
Index: kmail/messagelistview/core/widgetbase.cpp
===================================================================
--- kmail/messagelistview/core/widgetbase.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmail/messagelistview/core/widgetbase.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -254,7 +254,7 @@
 {
   if ( storageModel && mAggregation && !mSortOrder.validForAggregation( mAggregation ) ) {
     kDebug() << "Could not restore sort order for folder" << storageModel->id();
-    mSortOrder = SortOrder::defaultForAggregation( mAggregation );
+    mSortOrder = SortOrder::defaultForAggregation( mAggregation, mSortOrder );
 
     // Change the global sort order if the sort order didn't fit the global aggregation.
     // Otherwise, if it is a per-folder aggregation, make the sort order per-folder too.
Index: kmail/messagelistview/core/sortorder.h
===================================================================
--- kmail/messagelistview/core/sortorder.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmail/messagelistview/core/sortorder.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -187,8 +187,12 @@
 
     /**
      * Returns the default sort order for the given aggregation.
+     * @param oldSortOrder the previously used sort order. If possible, the new sort order
+     *                     will be based on that old sort order, i.e. the message sorting and
+     *                     message sort direction is adopted.
      */
-    static SortOrder defaultForAggregation( const Aggregation *aggregation );
+    static SortOrder defaultForAggregation( const Aggregation *aggregation,
+                                            const SortOrder &oldSortOrder );
 
     /**
     * Returns true if the ms parameter specifies a valid MessageSorting option.
Index: kmail/kmail_config_composer.desktop
===================================================================
--- kmail/kmail_config_composer.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmail/kmail_config_composer.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -90,6 +90,7 @@
 Comment[pt]=Configuração do Compositor de Mensagens
 Comment[pt_BR]=Configurações do compositor de mensagens
 Comment[ro]=Configurări compunere mesaj
+Comment[sl]=Nastavitve sestavljalnika sporočil
 Comment[sv]=Inställningar av brevfönster
 Comment[tr]=İleti Oluşturucu Ayarları
 Comment[uk]=Параметри засобу створення повідомлень
Index: kmail/networkaccount.cpp
===================================================================
--- kmail/networkaccount.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmail/networkaccount.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -205,16 +205,16 @@
 
       //If the password should be written to the wallet, do that
       if ( !mStorePasswdInConfig ) {
-        Wallet *wallet = kmkernel->wallet();
 
         //If the password is dirty, try to store it in the wallet
         if ( mPasswdDirty ) {
+          Wallet *wallet = kmkernel->wallet();
           if ( wallet && wallet->writePassword( "account-" + QString::number(mId), passwd() ) == 0 )
             passwdStored = true;
         }
 
         //If the password isn't dirty, it is already stored in the wallet.
-        else if ( wallet )
+        else
           passwdStored = true;
 
         //If the password is stored in the wallet, it isn't dirty or stored in the config
Index: kmail/redirectdialog.cpp
===================================================================
--- kmail/redirectdialog.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmail/redirectdialog.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -83,7 +83,7 @@
   mEditTo->setFocus();
 
   setButtonGuiItem( User1, KGuiItem( i18n("&Send Now"), "mail-send" ) );
-  setButtonGuiItem( User2, KGuiItem( i18n("Send &Later"), "queue" ) );
+  setButtonGuiItem( User2, KGuiItem( i18n("Send &Later"), "mail-queue" ) );
   connect(this,SIGNAL(user1Clicked()),this, SLOT(slotUser1()));
   connect(this,SIGNAL(user2Clicked()),this, SLOT(slotUser2()));
 }
Index: kmail/kmcommands.cpp
===================================================================
--- kmail/kmcommands.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmail/kmcommands.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -2285,25 +2285,16 @@
     msg->initHeader(mIdentity);
     msg->setCharset("utf-8");
     msg->setTo( KMMessage::decodeMailtoUrl( mUrl.path() ) );
-    QString query=mUrl.query();
-    while (!query.isEmpty()) {
-      QString queryPart;
-      int secondQuery = query.indexOf('?',1);
-      if (secondQuery != -1)
-        queryPart = query.left(secondQuery);
-      else
-        queryPart = query;
-      query = query.mid(queryPart.length());
 
-      if (queryPart.left(9) == "?subject=")
-        msg->setSubject( KUrl::fromPercentEncoding(queryPart.mid(9).toLatin1()) );
-      else if (queryPart.left(6) == "?body=")
-        // It is correct to convert to toLatin1() as URL should not contain
-        // anything except ascii.
-        msg->setBody( KUrl::fromPercentEncoding(queryPart.mid(6).toLatin1()).toLatin1() );
-      else if (queryPart.left(4) == "?cc=")
-        msg->setCc( KUrl::fromPercentEncoding(queryPart.mid(4).toLatin1()) );
-    }
+    QString body = mUrl.queryItem( "body" );
+    QString subject = mUrl.queryItem( "subject" );
+    QString cc = mUrl.queryItem( "cc" );
+    if ( !subject.isEmpty() )
+      msg->setSubject( subject );
+    if ( !body.isEmpty() )
+      msg->setBodyFromUnicode( body );
+    if ( !cc.isEmpty() )
+      msg->setCc( cc );
 
     KMail::Composer * win = KMail::makeComposer( msg, mIdentity );
     win->setCharset("", true);
Index: kmail/kmmsgbase.cpp
===================================================================
--- kmail/kmmsgbase.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmail/kmmsgbase.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -655,7 +655,7 @@
 
   QByteArray result = cset + "''";
   for ( l = latin.data(); *l; ++l ) {
-    bool needsQuoting = ( *l & 0x80 );
+    bool needsQuoting = ( *l & 0x80 ) || ( *l == '%' );
     if( !needsQuoting ) {
       int len = especials.length();
       for ( int i = 0; i < len; i++ )
Index: kmail/kmail_view.desktop
===================================================================
--- kmail/kmail_view.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmail/kmail_view.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -21,6 +21,7 @@
 Name[pl]=Widok KMail
 Name[pt]=Janela do KMail
 Name[pt_BR]=Exibição do KMail
+Name[sl]=KMailov prikaz
 Name[sv]=Kmail-vy
 Name[tr]=KMail görünümü
 Name[uk]=Перегляд KMail
Index: knode/knode_config_privacy.desktop
===================================================================
--- knode/knode_config_privacy.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ knode/knode_config_privacy.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -49,7 +49,7 @@
 Name[nn]=Signering/stadfesting
 Name[pl]=Podpisywanie/Weryfikacja podpisów
 Name[pt]=Assinar/Verificar
-Name[pt_BR]=Assinando/verificando
+Name[pt_BR]=Assinatura/verificação
 Name[ro]=Semnare/verificare
 Name[ru]=Подпись и проверка
 Name[sk]=Podpis/overenie
Index: kalarm/templatedlg.cpp
===================================================================
--- kalarm/templatedlg.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/templatedlg.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1,7 +1,7 @@
 /*
  *  templatedlg.cpp  -  dialog to create, edit and delete alarm templates
  *  Program:  kalarm
- *  Copyright © 2004-2008 by David Jarvie <djarvie@kde.org>
+ *  Copyright © 2004-2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -73,7 +73,6 @@
 	layout->setMargin(0);
 	topLayout->addLayout(layout);
 	mListFilterModel = new TemplateListFilterModel(EventListModel::templates());
-	mListFilterModel->setTypeFilter(false);
 	mListView = new TemplateListView(topWidget);
 	mListView->setModel(mListFilterModel);
 	mListView->sortByColumn(TemplateListFilterModel::TemplateNameColumn, Qt::AscendingOrder);
Index: kalarm/kalarm.h
===================================================================
--- kalarm/kalarm.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/kalarm.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -23,7 +23,7 @@
 
 #undef QT3_SUPPORT
 
-#define KALARM_VERSION "2.1.4"
+#define KALARM_VERSION "2.1.5"
 #define KALARM_NAME "KAlarm"
 #define KALARM_DBUS_SERVICE  "org.kde.kalarm"  // D-Bus service name of KAlarm application
 
Index: kalarm/mainwindow.cpp
===================================================================
--- kalarm/mainwindow.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/mainwindow.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1184,12 +1184,6 @@
 		                   getMailHeader("Subject", content),
 				   body, sernum);
 	}
-	else if (!(files = KUrl::List::fromMimeData(data)).isEmpty())
-	{
-		kDebug() << "URL";
-		action = KAEvent::FILE;
-		alarmText.setText(files[0].prettyUrl());
-	}
 #ifdef KMAIL_SUPPORTED
 	else if (KPIM::MailList::canDecode(data))
 	{
@@ -1219,6 +1213,12 @@
 		}
 		return;
 	}
+	else if (!(files = KUrl::List::fromMimeData(data)).isEmpty())
+	{
+		kDebug() << "URL";
+		action = KAEvent::FILE;
+		alarmText.setText(files[0].prettyUrl());
+	}
 	else if (data->hasText())
 	{
 		QString text = data->text();
Index: kalarm/templatelistfiltermodel.cpp
===================================================================
--- kalarm/templatelistfiltermodel.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/templatelistfiltermodel.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1,7 +1,7 @@
 /*
  *  templatelistfiltermodel.cpp  -  proxy model class for lists of alarm templates
  *  Program:  kalarm
- *  Copyright © 2007 by David Jarvie <software@astrojar.org.uk>
+ *  Copyright © 2007,2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -30,11 +30,11 @@
 // TemplateListFilterModel provides sorting and filtering for the alarm list model.
 
 
-void TemplateListFilterModel::setTypeFilter(bool excludeCommandAlarms)
+void TemplateListFilterModel::setTypeFilter(EventListModel::Type type)
 {
-	if (excludeCommandAlarms != mCmdFilter)
+	if (type != mFilter)
 	{
-		mCmdFilter = excludeCommandAlarms;
+		mFilter = type;
 		filterChanged();
 	}
 }
@@ -44,9 +44,9 @@
 	QModelIndex sourceIndex = sourceModel()->index(sourceRow, 0);
 	if (sourceModel()->data(sourceIndex, EventListModel::StatusRole).toInt() != KCalEvent::TEMPLATE)
 		return false;
-	if (!mCmdFilter)
+	if (mFilter == EventListModel::ALL)
 		return true;
-	return sourceModel()->data(sourceIndex, EventListModel::ValueRole).toInt() != KAEvent::COMMAND;
+	return sourceModel()->data(sourceIndex, EventListModel::ValueRole).toInt() & mFilter;
 }
 
 bool TemplateListFilterModel::filterAcceptsColumn(int sourceCol, const QModelIndex&) const
Index: kalarm/Changelog
===================================================================
--- kalarm/Changelog	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/Changelog	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1,6 +1,10 @@
 KAlarm Change Log
 
-=== Version 2.1.4 --- 18 January 2009 ===
+=== Version 2.1.5 --- 25 January 2009 ===
+- Disable inapplicable alarm types in alarm edit dialogue Load Template list.
+- Prevent multiple identical error messages being displayed for the same alarm.
+
+=== Version 2.1.4 (KDE 4.2) --- 18 January 2009 ===
 - Prevent corrupt alarms if deferral reinstates from archived alarm instead of
   from the displaying calendar.
 - Ignore events in calendar without usable alarms (which prevents them getting
Index: kalarm/kalarmapp.cpp
===================================================================
--- kalarm/kalarmapp.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/kalarmapp.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1,7 +1,7 @@
 /*
  *  kalarmapp.cpp  -  the KAlarm application object
  *  Program:  kalarm
- *  Copyright © 2001-2008 by David Jarvie <djarvie@kde.org>
+ *  Copyright © 2001-2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -1038,6 +1038,9 @@
 				return false;
 			if (!MainWindow::count())
 			{
+				// We have to have at least one main window to act
+				// as parent to the system tray icon (even if the
+				// window is hidden).
 				creating = true;    // prevent main window constructor from creating an additional tray icon
 				parent = MainWindow::create();
 				creating = false;
@@ -1656,9 +1659,7 @@
 				}
 				// Display the message even though it failed
 			}
-			if (!event.enabled())
-				delete win;        // event is disabled - close its window
-			else if (!win
+			if (!win
 			     ||  (!win->hasDefer() && !alarm.repeatAtLogin())
 			     ||  replaceReminder)
 			{
Index: kalarm/eventlistmodel.h
===================================================================
--- kalarm/eventlistmodel.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/eventlistmodel.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1,7 +1,7 @@
 /*
  *  eventlistmodel.h  -  model class for lists of alarms or templates
  *  Program:  kalarm
- *  Copyright © 2007,2008 by David Jarvie <djarvie@kde.org>
+ *  Copyright © 2007-2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -42,6 +42,13 @@
 {
 		Q_OBJECT
 	public:
+		enum Type
+		{
+			DISPLAY = 0x01,
+			COMMAND = 0x02,
+			EMAIL   = 0x04,
+			ALL     = DISPLAY | COMMAND | EMAIL
+		};
 		enum {   // data columns
 			TimeColumn, TimeToColumn, RepeatColumn, ColourColumn, TypeColumn, TextColumn,
 			TemplateNameColumn,
Index: kalarm/templatelistfiltermodel.h
===================================================================
--- kalarm/templatelistfiltermodel.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/templatelistfiltermodel.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1,7 +1,7 @@
 /*
  *  templatelistfiltermodel.h  -  proxy model class for lists of alarm templates
  *  Program:  kalarm
- *  Copyright © 2007 by David Jarvie <software@astrojar.org.uk>
+ *  Copyright © 2007,2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -35,8 +35,8 @@
 		};
 
 		explicit TemplateListFilterModel(EventListModel* baseModel, QObject* parent = 0)
-		               : EventListFilterModel(baseModel, parent) {}
-		void setTypeFilter(bool excludeCommandAlarms);
+		               : EventListFilterModel(baseModel, parent), mFilter(EventListModel::ALL) {}
+		void setTypeFilter(EventListModel::Type);
 		virtual QModelIndex mapFromSource(const QModelIndex& sourceIndex) const;
 		virtual QModelIndex mapToSource(const QModelIndex& proxyIndex) const;
 
@@ -45,7 +45,7 @@
 		virtual bool filterAcceptsColumn(int sourceCol, const QModelIndex& sourceParent) const;
 
 	private:
-		bool mCmdFilter;
+		EventListModel::Type mFilter;
 };
 
 #endif // TEMPLATELISTFILTERMODEL_H
Index: kalarm/resources/localdir.desktop
===================================================================
--- kalarm/resources/localdir.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/resources/localdir.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -58,7 +58,9 @@
 Comment[pl]=Zapewnia dostęp do kalendarza alarmów przechowywanego w lokalnym katalogu, w którym każdy element kalendarza jest zapisany w osobnym pliku
 Comment[pt]=Oferece o acesso a um calendário de alarmes guardado numa pasta local; cada item do calendário é guardado num ficheiro em separado
 Comment[pt_BR]=Fornece acesso a um calendário de alarmes armazenado em um único arquivo local, onde cada item do calendário é armazenado em um arquivo separado
+Comment[sl]=Omogoča dostop do koledarja z alarmi, ki so shranjeni v krajevni mapi, kjer je vsak alarm shranjen v ločeni datoteki
 Comment[sv]=Ger tillgång till en alarmkalender lagrad i en lokal katalog, där varje kalenderobjekt är lagrat i en separat fil
+Comment[tr]=Her takvim öğesinin ayrı bir dosyada depolandığı yerel bir dizinde depolanmış bir alarm takvimine erişim sağlar
 Comment[uk]=Надає доступ до календаря нагадувань, який зберігається у локальному каталозі, де кожен запис календаря зберігається у окремому файлі
 Comment[x-test]=xxProvides access to an alarm calendar stored in a local directory, in which each calendar item is stored in a separate filexx
 Comment[zh_CN]=提供对存储在一个本地目录中的提醒日历的访问支持，每个日历项目都存储在各自独立的文件内
Index: kalarm/resources/local.desktop
===================================================================
--- kalarm/resources/local.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/resources/local.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -58,7 +58,9 @@
 Comment[pl]=Zapewnia dostęp do kalendarza alarmów przechowywanego w pojedyńczym pliku lokalnym
 Comment[pt]=Oferece o acesso a um calendário de alarmes guardado num único ficheiro local
 Comment[pt_BR]=Fornece acesso a um calendário de alarmes armazenado em um único arquivo local
+Comment[sl]=Omogoča dostop do koledarja z alarmi, ki je shranjen v eni krajevni datoteki
 Comment[sv]=Ger tillgång till en alarmkalender lagrad i en enda lokal fil
+Comment[tr]=Tek bir yerel dosyada depolanmış bir alarm takvimine erişim sağlar
 Comment[uk]=Надає доступ до календаря нагадувань, який зберігається у окремому локальному файлі
 Comment[x-test]=xxProvides access to an alarm calendar stored in a single local filexx
 Comment[zh_CN]=提供对存储在单个本地文件中的提醒日历的访问支持
Index: kalarm/resources/remote.desktop
===================================================================
--- kalarm/resources/remote.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/resources/remote.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -59,7 +59,9 @@
 Comment[pl]=Zapewnia dostęp do kalendarza alarmów w pliku zdalnymp przy pomocy systemu sieciowego KDE - KIO
 Comment[pt]=Oferece o acesso a um calendário de alarmes num ficheiro remoto, usando um KIO da plataforma de rede do KDE
 Comment[pt_BR]=Fornece acesso a um calendário de alarmes em um arquivo remoto usando o KIO framework da rede do KDE
+Comment[sl]=Z uporabo KDE-jevega omrežnega ogrodja KIO omogoča dostop do koledarja z alarmi, ki je shranjen v oddaljeni datoteki
 Comment[sv]=Ger tillgång till en alarmkalender i en fjärrfil med användning av KDE:s I/O-ramverk
+Comment[tr]=KDE'nin ağ çatısı KIO'yu kullanarak uzak bir dosyadaki bir alarm takvimine erişim sağlar
 Comment[uk]=Надає доступ до календаря нагадувань, який зберігається у віддаленому файлі, за допомогою мережевих засобів KIO KDE
 Comment[x-test]=xxProvides access to an alarm calendar in a remote file using KDE's network framework KIOxx
 Comment[zh_CN]=通过 KDE 网络框架 KIO，提供对存储在一个远程文件中的提醒日历的访问支持
Index: kalarm/messagewin.cpp
===================================================================
--- kalarm/messagewin.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/messagewin.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -228,9 +228,20 @@
 void MessageWin::showError(const KAEvent& event, const DateTime& alarmDateTime,
                            const QStringList& errmsgs, const QString& dontShowAgain)
 {
-	if (dontShowAgain.isEmpty()
-	||  !KAlarm::dontShowErrors(event.id(), dontShowAgain))
-		(new MessageWin(&event, alarmDateTime, errmsgs, dontShowAgain))->show();
+	if (!dontShowAgain.isEmpty()
+	&&  KAlarm::dontShowErrors(event.id(), dontShowAgain))
+		return;
+
+	// Don't pile up duplicate error messages for the same alarm
+	for (int i = 0, end = mWindowList.count();  i < end;  ++i)
+	{
+		MessageWin* w = mWindowList[i];
+		if (w->mErrorWindow  &&  w->mEventID == event.id()
+		&&  w->mErrorMsgs == errmsgs  &&  w->mDontShowAgain == dontShowAgain)
+			return;
+	}
+
+	(new MessageWin(&event, alarmDateTime, errmsgs, dontShowAgain))->show();
 }
 
 /******************************************************************************
Index: kalarm/templatepickdlg.cpp
===================================================================
--- kalarm/templatepickdlg.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/templatepickdlg.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1,7 +1,7 @@
 /*
  *  templatepickdlg.cpp  -  dialog to choose an alarm template
  *  Program:  kalarm
- *  Copyright © 2004,2006-2008 by David Jarvie <djarvie@kde.org>
+ *  Copyright © 2004,2006-2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -36,7 +36,7 @@
 static const char TMPL_PICK_DIALOG_NAME[] = "TemplatePickDialog";
 
 
-TemplatePickDlg::TemplatePickDlg(QWidget* parent)
+TemplatePickDlg::TemplatePickDlg(EventListModel::Type type, QWidget* parent)
 	: KDialog(parent)
 {
 	QWidget* topWidget = new QWidget(this);
@@ -49,9 +49,10 @@
 	topLayout->setSpacing(spacingHint());
 
 	// Display the list of templates, but exclude command alarms if in kiosk mode.
-	bool includeCmdAlarms = ShellProcess::authorised();
+	if (!ShellProcess::authorised())
+		type = static_cast<EventListModel::Type>(type & ~EventListModel::COMMAND);
 	mListFilterModel = new TemplateListFilterModel(EventListModel::templates());
-	mListFilterModel->setTypeFilter(!includeCmdAlarms);
+	mListFilterModel->setTypeFilter(type);
 	mListView = new TemplateListView(topWidget);
 	mListView->setModel(mListFilterModel);
 	mListView->sortByColumn(TemplateListFilterModel::TemplateNameColumn, Qt::AscendingOrder);
Index: kalarm/editdlg.cpp
===================================================================
--- kalarm/editdlg.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/editdlg.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1016,7 +1016,17 @@
 */
 void EditAlarmDlg::slotHelp()
 {
-	TemplatePickDlg dlg(this);
+	EventListModel::Type type;
+	switch (mAlarmType)
+	{
+		case KAEvent::FILE:
+		case KAEvent::MESSAGE:  type = EventListModel::DISPLAY;  break;
+		case KAEvent::COMMAND:  type = EventListModel::COMMAND;  break;
+		case KAEvent::EMAIL:    type = EventListModel::EMAIL;  break;
+		default:
+			return;
+	}
+	TemplatePickDlg dlg(type, this);
 	if (dlg.exec() == QDialog::Accepted)
 		initValues(dlg.selectedTemplate());
 }
Index: kalarm/kalarm-2.1.5-general.pl
===================================================================
--- kalarm/kalarm-2.1.5-general.pl	(.../tags/KDE/4.2.0/kdepim)	(wersja 0)
+++ kalarm/kalarm-2.1.5-general.pl	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -0,0 +1,13 @@
+#!/usr/bin/perl -w
+# Convert pre-2.1.5 General section settings.
+
+use strict;
+
+while (<>)
+{
+	if (/^CmdXTerm=konsole/) {
+		s/ -T / -p tabtitle=/;
+		print "[General]\n";
+		print $_;
+	}
+}
Index: kalarm/kalarm.upd
===================================================================
--- kalarm/kalarm.upd	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/kalarm.upd	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -62,3 +62,10 @@
 Group=General
 Options=overwrite
 Script=kalarm-2.0.2-general.pl
+
+# Convert KDE3 konsole -T command parameter
+Id=2.1.5
+File=kalarmrc
+Group=General
+Options=overwrite
+Script=kalarm-2.1.5-general.pl
Index: kalarm/CMakeLists.txt
===================================================================
--- kalarm/CMakeLists.txt	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/CMakeLists.txt	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -125,6 +125,6 @@
 install( FILES kalarmui.rc DESTINATION ${DATA_INSTALL_DIR}/kalarm )
 install( FILES org.kde.kalarm.kalarm.xml DESTINATION ${KDE4_DBUS_INTERFACES_DIR} )
 install( FILES kalarm.upd DESTINATION ${KCONF_UPDATE_INSTALL_DIR})
-install( PROGRAMS kalarm-version.pl kalarm-1.2.1-general.pl kalarm-1.9.5-defaults.pl kalarm-2.0.2-general.pl DESTINATION ${KCONF_UPDATE_INSTALL_DIR})
+install( PROGRAMS kalarm-version.pl kalarm-1.2.1-general.pl kalarm-1.9.5-defaults.pl kalarm-2.0.2-general.pl kalarm-2.1.5-general.pl DESTINATION ${KCONF_UPDATE_INSTALL_DIR})
 
 kde4_install_icons( ${ICON_INSTALL_DIR} )
Index: kalarm/templatepickdlg.h
===================================================================
--- kalarm/templatepickdlg.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kalarm/templatepickdlg.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -20,6 +20,7 @@
 #ifndef TEMPLATEPICKDLG_H
 #define TEMPLATEPICKDLG_H
 
+#include "eventlistmodel.h"
 #include <kdialog.h>
 
 class QResizeEvent;
@@ -32,7 +33,7 @@
 {
 		Q_OBJECT
 	public:
-		explicit TemplatePickDlg(QWidget* parent = 0);
+		explicit TemplatePickDlg(EventListModel::Type, QWidget* parent = 0);
 		const KAEvent* selectedTemplate() const;
 	protected:
 		virtual void   resizeEvent(QResizeEvent*);
Index: korn/KOrn.desktop
===================================================================
--- korn/KOrn.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korn/KOrn.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1,6 +1,7 @@
 [Desktop Entry]
 GenericName=Mail Alert
 GenericName[af]=Pos inkennis stel
+GenericName[ar]=SMS
 GenericName[bg]=Аларма за е-поща
 GenericName[ca]=Alerta per al correu
 GenericName[cs]=Upozornění na poštu
Index: kaddressbook/xxport/gmx_xxport.desktop
===================================================================
--- kaddressbook/xxport/gmx_xxport.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kaddressbook/xxport/gmx_xxport.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -61,6 +61,7 @@
 Comment[pl]=Wtyczka do importu i eksportu kontaktów w formacie książki adresowej GMX
 Comment[pt]=Um 'plugin' para importar e exportar os contactos no formato vCard
 Comment[pt_BR]=Plug-in para importar e exportar contatos no formato de livro de endereços do GMX
+Comment[sl]=Vstavek za uvoz in izvoz stikov v obliki adresarja GMX
 Comment[sv]=Insticksprogram för import och export av kontakter med GMX-adressboksformat
 Comment[tr]=GMX'in adres defteri biçimini içeriye ve dışarıya aktarma eklentisi
 Comment[uk]=Втулок для імпорту та експорту контактів у форматі адресних книг GMX
Index: kaddressbook/editors/kaddressbookimprotocol.desktop
===================================================================
--- kaddressbook/editors/kaddressbookimprotocol.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kaddressbook/editors/kaddressbookimprotocol.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -41,6 +41,7 @@
 Name[pl]=Protokół komunikacji internetowej KAddressbook
 Name[pt]=Protocolo de Mensagens Instantâneas do KAdressbook
 Name[pt_BR]=Protocolo de mensagens instantâneas do KAddressbook
+Name[ro]=Protocol de mesagerie instantanee Carte de adrese
 Name[ru]=Протокол обмена сообщениями адресной книги KDE
 Name[se]=Šleađgadieđáhusprotokolla KDE-čujuhusgirjji várás
 Name[sk]=Protokol pre KDE Adresár Instant Messaging
Index: kaddressbook/kabcore.cpp
===================================================================
--- kaddressbook/kabcore.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kaddressbook/kabcore.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1382,7 +1382,7 @@
   connect(mActionCategories, SIGNAL(triggered(bool) ), SLOT( setCategories() ));
   mActionCategories->setWhatsThis( i18n( "Set the categories for all selected contacts." ) );
 
-  QAction *clearLocation = coll->addAction( "clear_search" );
+  KAction *clearLocation = coll->addAction( "clear_search" );
   clearLocation->setIcon( KIcon(QApplication::isRightToLeft() ? "edit-clear-locationbar-rtl" : "edit-clear-locationbar-ltr") );
   clearLocation->setText( i18n( "Clear Search Bar" ) );
   connect(clearLocation, SIGNAL(triggered(bool) ), SLOT( slotClearSearchBar() ));
Index: kaddressbook/kabcdistlistupdater/kabcdistlistupdater.desktop
===================================================================
--- kaddressbook/kabcdistlistupdater/kabcdistlistupdater.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kaddressbook/kabcdistlistupdater/kabcdistlistupdater.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -28,6 +28,7 @@
 Comment[pl]=Narzędzie uaktualniania starych list dystrybucyjnych.
 Comment[pt]=Uma ferramenta de actualização das listas de distribuição antigas para as novas.
 Comment[pt_BR]=Ferramenta de atualização de listas de distribuição antigas para novas.
+Comment[sl]=Orodje za pretvarjanje starih seznamov za razpošiljanje v novo obliko.
 Comment[sv]=Verktyg för att uppdatera gamla fördelningslistor till nya.
 Comment[tr]=Eski dağıtım listelerini yeni hale güncellemek için bir araç.
 Comment[uk]=Інструмент для оновлення старих списків розповсюдження
Index: kaddressbook/features/distributionlistng.desktop
===================================================================
--- kaddressbook/features/distributionlistng.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kaddressbook/features/distributionlistng.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -21,6 +21,7 @@
 Name[pl]=Nowa wtyczka KAB do obsługi list wysyłkowych
 Name[pt]='Plugin' de Lista de Distribuição do KAB da Próxima Geração
 Name[pt_BR]=Plug-in da próxima geração de listas de distribuição do KAB
+Name[sl]=Novi vstavek za adresarjev seznam za razpošiljanje
 Name[sv]=Adressbokens nästa generation insticksprogram för distributionslistor
 Name[tr]=KAB Dağıtım Listesi Sonraki Kuşak Eklentisi
 Name[uk]=Новітній втулок списку розповсюдження KAB
Index: libkholidays/holidays/CMakeLists.txt
===================================================================
--- libkholidays/holidays/CMakeLists.txt	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ libkholidays/holidays/CMakeLists.txt	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -10,9 +10,9 @@
          holiday_br
          holiday_ca
          holiday_catalan
+         holiday_ch
          holiday_cl
          holiday_co
-         holiday_ch
          holiday_cz
          holiday_de
          holiday_dk
@@ -25,8 +25,9 @@
          holiday_gr
          holiday_gt
          holiday_hu
+         holiday_ie
+         holiday_il
          holiday_is
-         holiday_il
          holiday_it
          holiday_jm
          holiday_jp
@@ -43,13 +44,12 @@
          holiday_ru
          holiday_se
          holiday_si
+         holiday_sk
+         holiday_Suedtirol
          holiday_th
          holiday_ua
          holiday_us
          holiday_uy
-         holiday_ie
-         holiday_Suedtirol
          holiday_za
          DESTINATION ${DATA_INSTALL_DIR}/libkholidays)
 
-
Index: libkholidays/holidays/holiday_dk
===================================================================
--- libkholidays/holidays/holiday_dk	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ libkholidays/holidays/holiday_dk	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -4,6 +4,7 @@
 :
 : Helligdage
 "Hellig tre Konger" on 6.1
+"Kyndelmisse" on 2.2
 weekend "Fastelavn" weekend on easter minus 49 days
 weekend "Palme søndag" weekend on easter minus 7 days
 weekend "Skærtorsdag" weekend on easter minus 3 days
@@ -30,13 +31,15 @@
 :
 : Nationale mærkedage
 "Kampen ved Myslunde 1864" on 2.2
-"Stormen på København 1659" on second tuesday in february
-"Slaget på reden 1801" on 2.4
+"Stormen på København 1659" on 11.2
+"Slaget på Reden 1801" on 2.4
 "Danmarks Besættelse 1940" on 9.4
 "Slaget ved Dybbøl 1864" on 18.4
 "Danmarks befrielse 1945" on 5.5
 "Kampen ved Helgoland 1864" on 9.5
-"Valdemarsdag/Genforeningsdag" on 15.6
+"Europadagen" on 9.5
+"Valdemarsdag/Genforeningsdagen 1920" on 15.6
+"Slaget i Køge Bugt" on 1.6
 "Slaget ved Fredericia 1849" on 6.7
 "Slaget ved Isted 1850" on 25.7
 "Stormen på Frederiksstad 1850" on 4.10
@@ -44,16 +47,18 @@
 :
 : Royale fødselsdage
 "Kronprinsesse Mary" on 5.2
+"Prinsesse Marie" on 6.2
 "Dronning Margrete II" on 16.4
+"Prinsesse Isabella" on 21.4
 "Prinsesse Benedikte" on 29.4
 "Kronprins Frederik" on 26.5
 "Prins Joachim" on 7.6
 "Prins Henrik" on 11.6
-"Prinsesse Alexandra" on 30.6
 "Prins Felix" on 22.7
 "Prins Nikolai" on 28.8
+"Prins Christian" on 15.10
 :
 : Andet
-small blue "Sommertid" on last sunday in march
-small blue "Vintertid" on last sunday in october
+small blue "Sommertid begynder" on last sunday in march
+small blue "Sommertid ender" on last sunday in october
 "Mors dag" on second sunday in may
Index: kjots/Kjots.desktop
===================================================================
--- kjots/Kjots.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kjots/Kjots.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -30,6 +30,7 @@
 GenericName[pt_BR]=Tomador de notas
 GenericName[ro]=Carnețel de note
 GenericName[ru]=Записная книжка
+GenericName[sl]=Beležnica
 GenericName[sv]=Anteckningsblock
 GenericName[tr]=Not Alıcı
 GenericName[uk]=Записна книжка
Index: libkdepim/completionordereditor.cpp
===================================================================
--- libkdepim/completionordereditor.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ libkdepim/completionordereditor.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -104,11 +104,11 @@
 
 void LDAPCompletionItem::save( CompletionOrderEditor* )
 {
-  KConfig _config( "kabldaprc" );
-  KConfigGroup config(&_config, "LDAP" );
-  config.writeEntry( QString( "SelectedCompletionWeight%1" ).arg( mLdapClient->clientNumber() ),
-                     mWeight );
-  config.sync();
+  KConfig *config = LdapSearch::config();
+  KConfigGroup group( config, "LDAP" );
+  group.writeEntry( QString( "SelectedCompletionWeight%1" ).arg( mLdapClient->clientNumber() ),
+                    mWeight );
+  group.sync();
 }
 
 // A simple item saved into kpimcompletionorder (no subresources, just name/identifier/weight)
Index: kpilot/conduits/malconduit/mal_conduit.desktop
===================================================================
--- kpilot/conduits/malconduit/mal_conduit.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/malconduit/mal_conduit.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -65,6 +65,7 @@
 Comment[pl]=Synchronizuje AvantGo (lub ogólnie zawartość serwera MAL) z palmtopem. Pozwala to przeglądać, bez połączenia z siecią, strony WWW na palmtopie, np. repertuar kin lub program telewizyjny, lub dowolną stronę WWW.
 Comment[pt]=Sincroniza o AvantGo (ou, genericamente, o conteúdo de um servidor de MAL) para o dispositivo móvel. Isto permite-lhe ver as páginas Web no dispositivo móvel sem estar ligado, como o seu horário de cinema ou TV ou ainda qualquer outra página Web.
 Comment[pt_BR]=Sincroniza o AvantGo (ou geralmente o conteúdo de um servidor MAL) com o handheld. Isto permite que você visualize páginas web off-line no handheld, por exemplo, a programação do cinema ou TV, ou qualquer outra página.
+Comment[sl]=Uskladi AvantGo (oziroma v splošnem vsebino strežnika MAL) na ročnem računalniku. S tem si lahko na njem ogledujete spletne strani brez povezave, kot so razpored kino predstav ali pa TV spored ali pa katerokoli drugo spletno stran.
 Comment[sv]=Synkronisera AvantGo (eller mer allmänt innehållet på en MAL-server) med handdatorn. Det låter dig titta på webbsidor i nerkopplat läge på handdatorn, som bio eller tv-program, eller vilken annan webbsida som helst.
 Comment[tr]=AvantGo içeriğini (ya da genel olarak MAL sunucuları içeriğini) el bilgisayarı ile eşzamanlar. Bu, TV ya da sinema programı ve diğer  web sayfalarını el bilgisayarınızda çevirim dışı olarak görüntülemenizi sağlar.
 Comment[uk]=Синхронізація AvantGo (або вміст серверів MAL) на кишеньковий пристрій . Ця дія надає змогу переглядати веб-сторінки, наприклад, програму кінотеатра або телебачення, на кишеньковому пристрої без з'єднання з Інтернетом.
Index: kpilot/conduits/akonadibase/akonadidataproxy.cc
===================================================================
--- kpilot/conduits/akonadibase/akonadidataproxy.cc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/akonadibase/akonadidataproxy.cc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -136,6 +136,7 @@
 				// Well the record with id mPcId doesn't seem to be in the akonadi
 				// resource any more so it is deleted.
 				AkonadiRecord* ar = createDeletedAkonadiRecord( mPcId );
+				ar->setDummy();
 				Q_ASSERT( ar->isDeleted() );
 				Q_ASSERT( ar->isModified() );
 				Q_ASSERT( ar->id() == mPcId );
Index: kpilot/conduits/akonadibase/akonadirecord.cc
===================================================================
--- kpilot/conduits/akonadibase/akonadirecord.cc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/akonadibase/akonadirecord.cc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -47,8 +47,13 @@
 	d->fItem = item;
 	d->fLastSyncDateTime = lastSync.toUTC(); // Item times are saved in UTC time.
 	d->fDeleted = false;
+	d->fDummy = false;
 }
 
+/**
+ * This ctor is _only_ used for dummy records which are temporarily used to delete
+ * data.
+ */
 AkonadiRecord::AkonadiRecord( const QString& id ) : d( new AkonadiRecordPrivate )
 {
 	d->fTempId = id;
@@ -122,6 +127,11 @@
 	d->fItem = item;
 	// Make sure that we return the right id after updating the itemobject.
 	setId( QString::number( item.id() ) );
+	/**
+	 * Assuming we're being passed a valid item to use, make sure fDummy
+	 * is not still false after this.
+	 */
+	setDummy( false );
 }
 
 void AkonadiRecord::synced()
@@ -130,9 +140,17 @@
 	// Nothing to do here.
 }
 
+void AkonadiRecord::setDummy(bool dummy)
+{
+	FUNCTIONSETUPL(5);
+	DEBUGKPILOT << "dummy: " << dummy;
+	d->fDummy = dummy;
+}
+
 bool AkonadiRecord::isValid() const
 {
 	FUNCTIONSETUPL(5);
 	bool valid = ! d->fDummy;
+	DEBUGKPILOT << "valid: " << valid;
 	return valid;
 }
Index: kpilot/conduits/akonadibase/akonadirecord.h
===================================================================
--- kpilot/conduits/akonadibase/akonadirecord.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/akonadibase/akonadirecord.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -103,6 +103,12 @@
 	 */
 	/* virtual */ bool isValid() const;
 
+	/**
+	  * Explicit set of whether this is a dummy (intended only for delete)
+	  * record.
+	  */
+	void setDummy( bool dummy = true );
+
 private:
 	QSharedDataPointer<AkonadiRecordPrivate> d;
 };
Index: kpilot/conduits/todo/todoakonadirecord.cc
===================================================================
--- kpilot/conduits/todo/todoakonadirecord.cc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/todo/todoakonadirecord.cc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -36,6 +36,8 @@
 TodoAkonadiRecord::TodoAkonadiRecord( const Akonadi::Item& i, const QDateTime& dt )
 	: AkonadiRecord( i, dt )
 {
+	FUNCTIONSETUPL(5);
+	DEBUGKPILOT << toString();
 }
 
 TodoAkonadiRecord::TodoAkonadiRecord( const QString& id ) : AkonadiRecord( id )
@@ -104,5 +106,13 @@
 
 QString TodoAkonadiRecord::toString() const
 {
-	return QString();
+	boost::shared_ptr<KCal::Todo> todo
+		= boost::dynamic_pointer_cast<KCal::Todo, KCal::Incidence>(
+		item().payload<IncidencePtr>() );
+
+	QString desc =
+		QString("TodoAkonadiRecord. Summary: [%1]")
+		.arg(todo->summary());
+
+	return desc;
 }
Index: kpilot/conduits/todo/todoconduit.cc
===================================================================
--- kpilot/conduits/todo/todoconduit.cc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/todo/todoconduit.cc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -62,12 +62,62 @@
 	KPILOT_DELETE( d );
 }
 
+static int mapHHPriorityToPC( int hhPriority )
+{
+	FUNCTIONSETUPL(5);
+	
+	int pcPriority;
+
+	if( 1 <= hhPriority && hhPriority <= 5 )
+	{
+		pcPriority =  2 * hhPriority - 1;
+	}
+	else
+	{
+		// hhPriority out of range so set pcPriority to undefined value
+		WARNINGKPILOT << "HH Priority (" << hhPriority << ") not in range 1..5";
+		pcPriority = 0;
+	}
+
+	DEBUGKPILOT << "hhPriority=" << hhPriority << ", pcPriority=" << pcPriority;
+
+	return pcPriority;
+}
+
+static int mapPCPriorityToHH( int pcPriority )
+{
+	FUNCTIONSETUPL(5);
+	
+	int hhPriority;
+	
+	if( 1 <= pcPriority && pcPriority <= 9 )
+	{
+		hhPriority = (pcPriority + 1) / 2;
+	}
+	else if( pcPriority == 0 )
+        {
+		// force unspecified pc priority to lowest hh priority
+		hhPriority = 5;
+        }
+	else
+	{
+		// pcPriority out of range, so set hh priority to lowest valid valud
+		WARNINGKPILOT << "pcPriority (" << pcPriority << ") not in range 0..9";
+		hhPriority = 5;
+	}
+	
+	DEBUGKPILOT << "pcPriority=" << pcPriority << "hhPriority=" << hhPriority;
+	
+	return hhPriority;
+}
+
 void TodoConduit::loadSettings()
 {
 	FUNCTIONSETUP;
 	
 	TodoSettings::self()->readConfig();
 	d->fCollectionId = TodoSettings::akonadiCollection();
+	d->fPrevCollectionId = TodoSettings::prevAkonadiCollection();
 }
 
 bool TodoConduit::initDataProxies()
@@ -108,7 +158,7 @@
 	fHHDataProxy->loadAllRecords();
 	fBackupDataProxy = new TodoHHDataProxy( fLocalDatabase );
 	fBackupDataProxy->loadAllRecords();
-	fPCDataProxy->loadAllRecords();
+	//fPCDataProxy->loadAllRecords();
 	
 	return true;
 }
@@ -147,7 +197,7 @@
 	// due date is set.
 	else if( pcTodo->hasDueDate() != !hhTodo.getIndefinite() )
 	{
-		DEBUGKPILOT << "On has and other does not have due date. PC[" 
+		DEBUGKPILOT << "One has and other does not have due date. PC[" 
 			<< pcTodo->hasDueDate() << "], HH[" << !hhTodo.getIndefinite() << ']';
 		dueDateEqual = false;
 	}
@@ -157,8 +207,9 @@
 		dueDateEqual = true;
 	}
 	
-	
-	// TODO: Do some mapping for the priority.
+	// Priorities are equal if the pc priority maps correctly to the hh priority
+	bool priorityEqual = mapPCPriorityToHH( pcTodo->priority() ) == hhTodo.getPriority();
+
 	// TODO: Do some mapping for the completed percentage.
 	
 	DEBUGKPILOT << "descriptionEqual: " << descriptionEqual;
@@ -166,12 +217,14 @@
 	DEBUGKPILOT << "categoriesEqual: " << categoriesEqual;
 	DEBUGKPILOT << "dueDateEqual: " << dueDateEqual;
 	DEBUGKPILOT << "completeEqual: " << completeEqual;
+	DEBUGKPILOT << "priorityEqual: " << priorityEqual;
 	
 	return descriptionEqual
 		&& noteEqual
 		&& categoriesEqual
 		&& dueDateEqual
-		&& completeEqual;
+		&& completeEqual
+		&& priorityEqual;
 }
 
 Record* TodoConduit::createPCRecord( const HHRecord *hhRec )
@@ -221,9 +274,10 @@
 		hhTo.setIndefinite( 1 );
 	}
 
-	// TODO: Map priority of KCal::Todo to PilotTodoEntry
-	// hhTo.setPriority( todo->priority() );
+	// Map priority from PC to HH
+	hhTo.setPriority( mapPCPriorityToHH( pcFrom->priority() ) );
 
+	// Set Completed
 	hhTo.setComplete( pcFrom->isCompleted() );
 
 	// what we call summary pilot calls description.
@@ -251,7 +305,7 @@
 	
 	pcTo->setSecrecy( hhFrom.isSecret() ? KCal::Todo::SecrecyPrivate : KCal::Todo::SecrecyPublic );
 
-	if ( hhFrom.getIndefinite() )
+	if( hhFrom.getIndefinite() )
 	{
 		pcTo->setHasDueDate( false );
 	}
@@ -261,9 +315,10 @@
 		pcTo->setHasDueDate( true );
 	}
 
-	// PRIORITY //
-	// TODO: e->setPriority(de->getPriority());
-	
+	// Map priority from HH to PC
+	pcTo->setPriority( mapHHPriorityToPC( hhFrom.getPriority() ) );
+
+	// Properly set the completion state
 	if( hhFrom.getComplete() && !pcTo->hasCompletedDate() )
 	{
 		pcTo->setCompleted( KDateTime::currentLocalDateTime() );
Index: kpilot/conduits/todo/kpilot-conduit-todo.desktop
===================================================================
--- kpilot/conduits/todo/kpilot-conduit-todo.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/todo/kpilot-conduit-todo.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -20,6 +20,7 @@
 Comment[pl]=Ten łącznik synchronizuje zadania z palmtopa z zadaniami Akonadi.
 Comment[pt]=Esta conduta sincroniza a base de dados de itens por-fazer com uma Colecção de Itens Por-Fazer do Akonadi.
 Comment[pt_BR]=Esta conduta sincroniza a base de dados das pendências com uma coleção de pendências do Akonadi.
+Comment[sl]=Ta veznik usklajuje opravila na ročnem računalniku z Akonadijevo zbirko opravil.
 Comment[sv]=Den här kanalen synkroniserar handdatorns uppgiftsdatabas med en Akonadi uppgiftssamling.
 Comment[tr]=Bu kanal el bilgisayarınızdaki yapılacak ögeleri ile bilgisayarınızdaki Akonadi Yapılacak Ögeleri Koleksiyonunu eşzamanlar.
 Comment[uk]=Цей акведук синхронізує базу даних завдань кишенькового пристрою зі збіркою завдань Akonadi.
Index: kpilot/conduits/todo/todofactory.cc
===================================================================
--- kpilot/conduits/todo/todofactory.cc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/todo/todofactory.cc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1,6 +1,6 @@
 /* KPilot
 **
-** Copyright (C) 2008 by Dan Pilone <pilone@slac.com>
+** Copyright (C) 2008 - 2009 by Bertjan Broeksema <b.broeksema@home.nl>
 **
 ** This file defines the factory for the abbrowser-conduit plugin.
 */
Index: kpilot/conduits/todo/todohhrecord.cc
===================================================================
--- kpilot/conduits/todo/todohhrecord.cc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/todo/todohhrecord.cc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -80,3 +80,12 @@
 	
 	return PilotTodoEntry( fRecord );
 }
+
+QString TodoHHRecord::toString() const
+{
+	PilotTodoEntry tde = todoEntry();
+	QString desc =
+		QString("TodoHHRecord. Summary: [%1]")
+		.arg(tde.getDescription());
+	return desc;
+}
Index: kpilot/conduits/todo/todohhrecord.h
===================================================================
--- kpilot/conduits/todo/todohhrecord.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/todo/todohhrecord.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -45,6 +45,12 @@
 	void setTodoEntry( const PilotTodoEntry& entry, bool keepPrevCategory = true );
 	
 	PilotTodoEntry todoEntry() const;
+
+	/**
+	 * Returns a string presentation of this record.
+	 */
+	/* virtual */ QString toString() const;
+
 };
 
 #endif
Index: kpilot/conduits/calendar/calendarakonadirecord.cc
===================================================================
--- kpilot/conduits/calendar/calendarakonadirecord.cc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/calendar/calendarakonadirecord.cc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -141,14 +141,28 @@
 			(
 				item().payload<IncidencePtr>()
 			);
-	bool check = (!event->summary().isEmpty() &&
-		      event->dtStart().dateTime().isValid() &&
-		      event->dtEnd().dateTime().isValid());
+	unsigned int validChecks = 0;
+	bool myCheck = (!event->summary().isEmpty() &&
+			event->dtStart().dateTime().isValid() &&
+			event->dtEnd().dateTime().isValid());
 	DEBUGKPILOT << toString();
-	DEBUGKPILOT << "my checks: " << check;
+	DEBUGKPILOT << "my checks: " << myCheck;
+	if ( myCheck ) ++validChecks;
+
 	bool parentCheck = AkonadiRecord::isValid();
-	DEBUGKPILOT << "parent check: " << parentCheck;
-	DEBUGKPILOT << "returning: " << (check && parentCheck);
+	DEBUGKPILOT << "parent check: " << parentCheck << ", myCheck: " << myCheck;
+	if ( parentCheck ) ++validChecks;
 
-	return (check && parentCheck);
+	/*
+	 * For some inexplicable reason, myCheck == true, and parentCheck == true,
+	 * but (myCheck && parentCheck) == false earlier. We know that at this point
+	 * we should have 2 things that are true, so use an int to get around
+	 * this weirdness for the time being. At this point, something like this is
+	 * preferable to data loss, which we do hit if isValid() returns false when
+	 * it should be true.
+	 */
+	// TODO: Figure out how (true && true) can be false =:/
+	DEBUGKPILOT << "returning: " << ( validChecks == 2 );
+
+	return ( validChecks == 2 );
 }
Index: kpilot/conduits/calendar/kpilot-conduit-calendar.desktop
===================================================================
--- kpilot/conduits/calendar/kpilot-conduit-calendar.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/calendar/kpilot-conduit-calendar.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -21,6 +21,7 @@
 Comment[pl]=Ten łącznik synchronizuje kalendarz palmtopa z kalendarzem Akonadi.
 Comment[pt]=Esta conduta sincroniza a base de dados do calendário com uma Colecção de Calendário do Akonadi.
 Comment[pt_BR]=Esta conduta sincroniza a base de dados do calendário com uma coleção de calendário do Akonadi.
+Comment[sl]=Ta veznik usklajuje koledar na ročnem računalniku z Akonadijevo zbirko koledarjev.
 Comment[sv]=Den här kanalen synkroniserar handdatorns kalenderdatabas med en Akonadi kalendersamling.
 Comment[tr]=Bu kanal el bilgisayarınızdaki takvim ile bilgisayarınızdakini eşzamanlar.
 Comment[uk]=Цей акведук синхронізує базу даних календаря кишенькового пристрою зі збіркою календаря Akonadi.
Index: kpilot/conduits/base/recordconduit.cc
===================================================================
--- kpilot/conduits/base/recordconduit.cc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/base/recordconduit.cc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -865,18 +865,28 @@
 	}
 	else if( hhRecord )
 	{
-		// Case: 6.5.2 or 6.5.8
-		// Warning id is a temporary id. Only after commit we know what id is
-		// assigned to the record. So on commit the proxy should get the mapping
-		// so that it can change the mapping.
-		DEBUGKPILOT << "Case 6.5.2 and 6.5.8";
-		pcRecord = createPCRecord( hhRecord );
-		QString id = fPCDataProxy->create( pcRecord );
-		fMapping.map( hhRecord->id(), id );
-		copyCategory( hhRecord, pcRecord );
+		if( !hhRecord->isDeleted() )
+		{
+			// Case: 6.5.2 or 6.5.8
+			// Warning id is a temporary id. Only after commit we know what id is
+			// assigned to the record. So on commit the proxy should get the mapping
+			// so that it can change the mapping.
+
+			DEBUGKPILOT << "Case 6.5.2 and 6.5.8";
+			pcRecord = createPCRecord( hhRecord );
+			QString id = fPCDataProxy->create( pcRecord );
+			fMapping.map( hhRecord->id(), id );
+			copyCategory( hhRecord, pcRecord );
 		
-		pcRecord->synced();
-		hhRecord->synced();
+			pcRecord->synced();
+			hhRecord->synced();
+		}
+		else
+		{
+			// Case: 6.5.18
+			DEBUGKPILOT << "Case 6.5.18";
+			fHHDataProxy->remove( hhRecord->id() );
+                }
 	}
 	else if( pcRecord )
 	{
Index: kpilot/conduits/base/idmappingxmlsource.cc
===================================================================
--- kpilot/conduits/base/idmappingxmlsource.cc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/base/idmappingxmlsource.cc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -268,7 +268,7 @@
 	}
 	
 	QFile file( d->fPath );
-	if( file.open( QIODevice::ReadWrite ) )
+	if( file.open( QIODevice::WriteOnly | QIODevice::Truncate) )
 	{
 		QTextStream out( &file );
 		doc.save( out, 4 );
Index: kpilot/conduits/base/design/Use_Case_-_Conduit_Syncing.odt
===================================================================
Nie można wyświetlić: plik binarny.
svn:mime-type = application/octet-stream
Index: kpilot/conduits/contacts/kpilot-conduit-contacts.desktop
===================================================================
--- kpilot/conduits/contacts/kpilot-conduit-contacts.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/conduits/contacts/kpilot-conduit-contacts.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -21,6 +21,7 @@
 Comment[pl]=Ten łącznik synchronizuje książkę adresową palmtopa z książką adresową Akonadi.
 Comment[pt]=Esta conduta sincroniza a base de dados do livro de endereços do dispositivo com uma Colecção do Akonadi.
 Comment[pt_BR]=Esta conduta sincroniza o livro de endereços do handheld com uma coleção do Akonadi.
+Comment[sl]=Ta veznik usklajuje adresar na ročnem računalniku z Akonadijevo zbirko adresarjev.
 Comment[sv]=Den här kanalen synkroniserar handdatorns adressboksdatabas med en Akonadi samling.
 Comment[tr]=Bu kanal, el bilgisayarınızdaki adres defteri veritabanı ile bilgisayarınızdaki Akonadi koleksiyonunu eşzamanlar.
 Comment[uk]=Цей акведук синхронізує базу даних адресної книги кишенькового пристрою зі збіркою Akonadi.
Index: kpilot/kpilot/kpilotdaemon.desktop
===================================================================
--- kpilot/kpilot/kpilotdaemon.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/kpilot/kpilotdaemon.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -2,6 +2,7 @@
 [Desktop Entry]
 Name=KPilotDaemon
 Name[af]=Kpilotdaemon
+Name[ar]=KPilot
 Name[da]=KPilotDæmon
 Name[de]=KPilot-Dienst
 Name[el]=Δαίμονας KPilot
Index: kpilot/kpilot/hotSync.cc
===================================================================
--- kpilot/kpilot/hotSync.cc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/kpilot/hotSync.cc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -517,7 +517,9 @@
 {
 	if (e->type() == (QEvent::Type)Thread::TerminateOK)
 	{
-		fBackupThread->deleteLater();
+		// delete the thread when it's finished
+		// TODO: figure out why calling deleteLater directly doesn't work
+		QTimer::singleShot(0,fBackupThread,SLOT(deleteLater()));
 		fBackupThread = 0L;
 		// This was a successful termination.
 		addSyncLogEntry( i18n("... OK.\n"), false );
@@ -526,7 +528,9 @@
 	}
 	if (e->type() == (QEvent::Type)Thread::TerminateFailure)
 	{
-		fBackupThread->deleteLater();
+		// delete the thread when it's finished
+		// TODO: figure out why calling deleteLater directly doesn't work
+		QTimer::singleShot(0,fBackupThread,SLOT(deleteLater()));
 		fBackupThread = 0L;
 		// Unsuccessful termination.
 		addSyncLogEntry( i18n("Backup failed.") );
Index: kpilot/lib/pilotRecord.cc
===================================================================
--- kpilot/lib/pilotRecord.cc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kpilot/lib/pilotRecord.cc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -46,7 +46,10 @@
 
 /* virtual */ QString PilotRecordBase::textRepresentation() const
 {
-	return CSL1("[ %1,%2,%3 ]") . arg(attributes(),category(),id());
+	return CSL1("[ %1,%2,%3 ]")
+		.arg( attributes() )
+		.arg( category() )
+		.arg( id() );
 }
 
 /* virtual */ QString PilotRecord::textRepresentation() const
Index: knotes/knotes_manager.desktop
===================================================================
--- knotes/knotes_manager.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ knotes/knotes_manager.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -2,6 +2,7 @@
 [Desktop Entry]
 Name=Notes
 Name[af]=Notas
+Name[ar]=الملاحظات
 Name[be]=Заметкі
 Name[br]=Notennoù
 Name[cs]=Poznámky
Index: kmobiletools/kmobiletools/engines/at_engine/at_engine.desktop
===================================================================
--- kmobiletools/kmobiletools/engines/at_engine/at_engine.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmobiletools/kmobiletools/engines/at_engine/at_engine.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -26,6 +26,7 @@
 Name[pt]=Motor AT
 Name[pt_BR]=Mecanismo AT
 Name[ro]=Motor AT
+Name[sl]=Pogon AT
 Name[sv]=AT-gränssnitt
 Name[tr]=AT Motoru
 Name[uk]=Рушій AT
@@ -56,6 +57,7 @@
 Comment[pl]=Moduł KMobileTools używający standardowego zestawu poleceń AT
 Comment[pt]=Um motor do KMobileTools baseado no conjunto de comandos-padrão AT
 Comment[pt_BR]=Mecanismo do KMobileTools baseado no conjunto de comandos-padrão AT
+Comment[sl]=Pogon KMobileTools, ki temelji na standardnem naboru ukazov GSM AT
 Comment[sv]=Kmobiletools-gränssnitt baserat på standardiserade GSM AT-kommadon
 Comment[tr]=KMobileTools Motoru tabanlı standart GSM AT Komut Seti
 Comment[uk]=Рушій KMobileTools на основі стандартного набору команд GSM AT
@@ -86,6 +88,7 @@
 Description[pl]=Domyślny moduł KMobileTools, napisany przez członków zespołu KMobileTools.\nDobry wybór dla prawie wszystkich telefonów, ale w przypadku niektórych modeli brakuje bardziej zaawansowanych funkcji.\nNajlepszy wybór dla telefonów Motoroli, działa też dobrze z produktami Sony Ericsson i Siemensa.
 Description[pt]=O motor predefinido do KMobileTools, desenvolvido internamente pela equipa do KMobileTools.\nUma boa escolha para praticamente todos os telemóveis mas, em alguns modelos ,podem faltar algumas funcionalidades avançadas.\nSendo a melhor escolha para os telemóveis da Motorola, também funciona bem com os da Sony Ericsson e Siemens.
 Description[pt_BR]=Mecanismo padrão do KMobileTools, totalmente desenvolvido pela equipe do KMobileTools.\nUma boa escolha para praticamente todos os celulares mas, em alguns modelos podem faltar algumas funcionalidades avançadas.\nÉ a melhor escolha para os celulares da Motorola, também funciona com os da Sony Ericsson e Siemens.
+Description[sl]=Privzeti pogon za KMobileTools, ki ga je razvila ekipa KMobileTools.\nTo je dobra izbira za skoraj vse mobilne telefone, a na nekaterih manjka podpora za napredne zmožnosti.\nNajboljša izbira za mobile telefone Motorola, dobro deluje tudi s Sony Ericsson in Siemens.
 Description[sv]=Kmobiletools standardgränssnitt, utvecklat internt av Kmobiletools-gruppen.\nEtt bra val för nästan alla mobiltelefoner, men för vissa modeller saknar det avancerade funktioner.\nBästa valet för Motorola-telefoner, fungerar bra med Sony Ericsson och Siemens.
 Description[tr]=KMobileTools takımı tarafından geliştirilen KMobileTools öntanımlı motoru.\nTüm cep telefonları için iyi bir seçimdir ancak bazı modellerin gelişmiş özelliklerinde yetersiz kalabilir.\nMotorola telefonlar için en iyi seçimdir, Sony Ericsson ve Siemens telefonlar ile de iyi çalışır.
 Description[uk]=Типовий рушій KMobileTools, розроблений всередині команди з розробки KMobileTools.\nЧудовий вибір майже для всіх мобільних телефонів, але для деяких моделей у ньому відсутні додаткові можливості.\nНайкращий вибір для телефонів Motorola Phones, також добре працює з телефонами Sony Ericsson і Siemens.
Index: kmobiletools/kmobiletools/engines/fake_engine/fake_engine.desktop
===================================================================
--- kmobiletools/kmobiletools/engines/fake_engine/fake_engine.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmobiletools/kmobiletools/engines/fake_engine/fake_engine.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -25,6 +25,7 @@
 Name[pt]=Motor falso
 Name[pt_BR]=Mecanismo falso
 Name[ro]=Motor fals
+Name[sl]=Lažni pogon
 Name[sv]=Falskt gränssnitt
 Name[tr]=Yalancı motor
 Name[uk]=Фіктивний рушій
@@ -55,6 +56,7 @@
 Comment[pl]=Pusty moduł KMobileTools...
 Comment[pt]=Um motor falso do KMobileTools...
 Comment[pt_BR]=Um mecanismo falso do KMobileTools...
+Comment[sl]=Lažni pogon za KMobileTools ...
 Comment[sv]=Ett falskt gränssnitt för Kmobiletools...
 Comment[tr]=Bir KMobileTools yalancı motoru...
 Comment[uk]=Рушій-обманка для KMobileTools...
@@ -84,6 +86,7 @@
 Description[pl]=Moduł KMobileTools wykorzystywany jako przykład przy zmianach API.
 Description[pt]=Um motor falso do KMobileTools que é usado como prova do conceito de redefinição do desenho da API.
 Description[pt_BR]=Um mecanismo falso do KMobileTools que é usado como prova do conceito de redefinição da API.
+Description[sl]=Lažni pogon za KMobileTools, ki služi kot dokaz koncepta za na novo načrtovan programski vmesnik.
 Description[sv]=Ett falskt gränssnitt för Kmobiletools använt som bevis av konceptet för omkonstruktionen av programmeringsgränssnittet.
 Description[tr]=Api'yi yeniden tasarlama ve güçlendirme amacıyla kullanılan KMobileTools yalancı motoru.
 Description[uk]=Фіктивний рушій KMobileTools, який використовується як модель для демонстрації можливостей зміни дизайну api.
Index: kmobiletools/kmobiletools/engines/gammu_engine/gammu_engine.desktop
===================================================================
--- kmobiletools/kmobiletools/engines/gammu_engine/gammu_engine.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kmobiletools/kmobiletools/engines/gammu_engine/gammu_engine.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -56,6 +56,7 @@
 Comment[pl]=Moduł KMobileTools wykorzystujący Gammu
 Comment[pt]=Um Motor do KMobileTools baseado no Gammu
 Comment[pt_BR]=Mecanismo do KMobileTools baseado no Gammu
+Comment[sl]=Pogon za KMobileTools, temelječ na Gammu
 Comment[sv]=Gränssnitt för Kmobiletools baserat på Gammu
 Comment[tr]=KMobileTools Motoru tabanlı Gammu
 Comment[uk]=Рушій KMobileTools, заснований на Gammu
@@ -86,6 +87,7 @@
 Description[pl]=Moduł KMobileTools używający Gammu. Działa ze wszystkimi telefonami obsługującymi polecenia AT. Istnieją specjalne sterowniki dla telefonów Alcatela, Nokii, Sony Ericsson i wykorzystujących Symbiana.
 Description[pt]=Um motor do KMobileTools que usa o Gammu como infra-estrutura. É compatível com todos os comandos baseados em AT. Controladores especiais para os telefones da Alcatel, Nokia, Symbian e Sony Ericsson.
 Description[pt_BR]=Um mecanismo do KMobileTools que usa o Gammu como backend. É compatível com todos os telefones baseados em AT. Controladores especiais para os telefones da Alcatel, Nokia, Symbian e Sony Ericsson.
+Description[sl]=Pogon za KMobileTools, ki v ozadju uporablja Gammu. Je združljiv s telefoni temelječimi na AT. Na voljo so posebni gonilniki za telefone Alcatel, Nokia, Symbian in Sony Ericsson.
 Description[sv]=Ett Kmobiletools-gränssnitt som använder Gammu som gränssnitt. Fungerar med alla AT-baserade telefoner. Särskilda drivrutiner för  telefoner från Alcatel, Nokia, Symbian och Sony Ericsson.
 Description[tr]=Gammu arka ucunu kullanan bir KMobileTools motoru. AT-tabanlı telefonlar ile uyumludur. Alcatel, Nokia, Symbian ve Sony Ericsson telefonlar için özel sürücüler.
 Description[uk]=Рушій KMobileTools, який використовує Gammu у якості сервера. Сумісний з всіма заснованими на логіці AT телефонами. Окремі драйвери для телефонів Alcatel, Nokia, Symbian і Sony Ericsson.
Index: kontact/src/mainwindow.cpp
===================================================================
--- kontact/src/mainwindow.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ kontact/src/mainwindow.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1151,7 +1151,7 @@
   QString wizard_icon_path = iconloader->iconPath( "tools-wizard", KIconLoader::Desktop );
 
   QString info = ki18n( "<h2 style='text-align:center; margin-top: 0px;'>Welcome to Kontact %1</h2>"
-      "<p>%2</p>"
+      "<p align=\"center\">%2</p>"
       "<table align=\"center\">"
       "<tr><td><a href=\"%3\"><img width=\"%4\" height=\"%5\" src=\"%6\" /></a></td>"
       "<td><a href=\"%7\">%8</a><br /><span id=\"subtext\"><nobr>%9</nobr></span></td></tr>"
Index: akonadi/tray/akonaditray.desktop
===================================================================
--- akonadi/tray/akonaditray.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/tray/akonaditray.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -9,6 +9,7 @@
 Name[nl]=Akonadi-vak
 Name[pa]=ਅਕੌਂਡੀ-ਟਰੇ
 Name[ru]=Системный лоток для Akonadi
+Name[sl]=Akonadi v sistemski vrstici
 Name[sv]=Akonadi-bricka
 Name[x-test]=xxAkonaditrayxx
 Name[zh_CN]=Akonadi 托盘
@@ -37,6 +38,7 @@
 GenericName[pt_BR]=Utilitário de notificação do Akonadi
 GenericName[ro]=Utilitar Akonadi pentru tavă
 GenericName[ru]=Утилита системного лотка для Akonadi
+GenericName[sl]=Akonadijevo orodje v sistemski vrstici
 GenericName[sv]=Akonadi-brickverktyg
 GenericName[tr]=Akonadi Sistem Çekmecesi Aracı
 GenericName[uk]=Утиліта лотка Akonadi
Index: akonadi/agents/nepomuk_email_feeder/nepomukemailfeeder.desktop
===================================================================
--- akonadi/agents/nepomuk_email_feeder/nepomukemailfeeder.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/agents/nepomuk_email_feeder/nepomukemailfeeder.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -12,6 +12,7 @@
 Name[ja]=Nepomuk メールフィーダー
 Name[km]=កម្មវិធី​មតិព័ត៌មាន​អ៊ីមែល Nepomuk
 Name[ko]=Nepomuk 전자 우편 공급자
+Name[lt]=Nepomuk laiškų šaltinis
 Name[lv]=Nepomuk e-pasta barotājs
 Name[nb]=E-postsender til Nepomuk
 Name[nds]=Nepomuk-Nettpostingaav
@@ -21,6 +22,7 @@
 Name[pl]=Obsługa e-maili dla Nepomuka
 Name[pt]=Alimentação de E-Mail do Nepomuk
 Name[pt_BR]=Alimentador de e-mail do Nepomuk
+Name[sl]=Podajalnik epošte za Nepomuk
 Name[sv]=E-postinmatning till Nepomuk
 Name[tr]=Nepomuk E-posta Besleyici
 Name[uk]=Передавач пошти Nepomuk
@@ -39,6 +41,7 @@
 Comment[ja]=Nepomuk にメールを提供するエクステンション
 Comment[km]=ផ្នែក​បន្ថែម​ដែលត្រូវ​បញ្ជូន​អ៊ីមែល​ទៅកាន់ Nepomuk
 Comment[ko]=Nepomuk에 전자 우편을 추가하는 공급자
+Comment[lt]=Priedas el. laiškų perdavimui į Nepomuk
 Comment[lv]=Paplašinājums, kas iesūta e-pastus Nepomuk
 Comment[nb]=Utvidelse som sender e-poster inn til Nepomuk
 Comment[nds]=Verwiedern, mit de sik Nettpost na Nepomuk överdregen lett
@@ -47,6 +50,7 @@
 Comment[pl]=Rozszerzenie do wysyłania e-maili do Nepomuka
 Comment[pt]=Extensão para enviar mensagens de e-mail para o Nepomuk
 Comment[pt_BR]=Extensão para enviar e-mails para o Nepomuk
+Comment[sl]=Razširitev, ki posreduje e-pošto v Nepomuk
 Comment[sv]=Utökning för att skicka e-postadresser till Nepomuk
 Comment[tr]=E-postaları Nepomuk içerisine taşımak için bir eklenti
 Comment[uk]=Додаток для передачі електронних листів до Nepomuk
Index: akonadi/agents/mailthreader/mailthreaderagent.desktop
===================================================================
--- akonadi/agents/mailthreader/mailthreaderagent.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/agents/mailthreader/mailthreaderagent.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -12,6 +12,7 @@
 Name[ja]=メールをスレッド化するエージェント
 Name[km]=ភ្នាក់ងារ​ខ្សែស្រឡាយ​សំបុត្រ
 Name[ko]=메일 묶기 마법사
+Name[lt]=Laiškų išdėstymo gija agentas
 Name[lv]=Pasta pavedienu aģents
 Name[nb]=Agent for e-posttråding
 Name[nds]=Klöönsnackhölper
@@ -22,6 +23,7 @@
 Name[pt]=Agente de Tarefas de Correio
 Name[pt_BR]=Agente de tarefas de correio
 Name[ro]=Agent de grupare a mesajelor
+Name[sl]=Posrednik za nizanje pošte
 Name[sv]=E-posttrådningsmodul
 Name[tr]=E-posta Dizme Aracı
 Name[uk]=Агент розгалуження пошти
@@ -41,6 +43,7 @@
 Comment[ja]=メールをスレッド化します
 Comment[km]=ដាក់​សំបុត្រ​ជា​ខ្សែស្រឡាយ​នៅ​ក្នុង​សម្រាំង
 Comment[ko]=모음집의 메일 묶기
+Comment[lt]=Išdėstyti laiškus kolekcijoje gija
 Comment[lv]=Pavedienos ielādē pastu kolekcijā
 Comment[nb]=Lag e-posttråder i en samling
 Comment[nds]=Klöönsnacks binnen en Nettpostsammeln
@@ -51,6 +54,7 @@
 Comment[pt]=Agendar mensagens de e-mail numa colecção
 Comment[pt_BR]=Agendar as mensagens de uma coleção
 Comment[ro]=Grupează mesajele într-o colecție
+Comment[sl]=Niza pošto v zbirko
 Comment[sv]=Tråda e-post från en samling
 Comment[tr]=E-postaları bir koleksiyon içerisine diz
 Comment[uk]=Розгалужує поштові повідомлення зі збірки
Index: akonadi/agents/nepomuk_contact_feeder/nepomukcontactfeeder.desktop
===================================================================
--- akonadi/agents/nepomuk_contact_feeder/nepomukcontactfeeder.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/agents/nepomuk_contact_feeder/nepomukcontactfeeder.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -12,6 +12,7 @@
 Name[ja]=Nepomuk 連絡先フィーダー
 Name[km]=មតិព័ត៌មាន​ទំនាក់ទំនង Nepomuk
 Name[ko]=Nepomuk 연락처 공급자
+Name[lt]=Nepomuk kontaktų šaltinis
 Name[lv]=Nepomuk kontaktu barotājs
 Name[nb]=Kontaktsender til Nepomuk
 Name[nds]=Nepomuk-Kontaktingaav
@@ -21,6 +22,7 @@
 Name[pl]=Obsługa wizytówek dla Nepomuka
 Name[pt]=Alimentação de Contactos para o Nepomuk
 Name[pt_BR]=Alimentador de contatos para o Nepomuk
+Name[sl]=Podajalnik stikov za Nepomuk
 Name[sv]=Kontaktinmatning till Nepomuk
 Name[tr]=Nepomuk Kişi Besleyici
 Name[uk]=Передавач контактів Nepomuk
@@ -39,6 +41,7 @@
 Comment[ja]=Nepomuk に連絡先を提供するエクステンション
 Comment[km]=ផ្នែក​បន្ថែម​ដែលត្រូវ​បញ្ជូន​ទំនាក់ទំនង​ទៅ Nepomuk
 Comment[ko]=Nepomuk에 연락처를 추가하는 확장 기능
+Comment[lt]=Praplėtimas skirtas kontaktų persiuntimui į Nepomuk
 Comment[lv]=Paplašinājums, kas iesūta kontaktu datus Nepomuk
 Comment[nb]=Utvidelse som sender kontakter inn til Nepomuk
 Comment[nds]=Verwiedern, mit de sik Kontakten na Nepomuk överdregen laat
@@ -47,6 +50,7 @@
 Comment[pl]=Rozszerzenie do wysyłania wizytówek do Nepomuka
 Comment[pt]=Extensão para enviar contactos para o Nepomuk
 Comment[pt_BR]=Extensão para enviar contatos para o Nepomuk
+Comment[sl]=Razširitev, ki posreduje stike v Nepomuk
 Comment[sv]=Utökning för att skicka kontakter till Nepomuk
 Comment[tr]=Kişileri Nepomuk içerisine taşımak için bir eklenti
 Comment[uk]=Додаток для передачі контактів до Nepomuk
Index: akonadi/agents/strigifeeder/strigifeeder.desktop
===================================================================
--- akonadi/agents/strigifeeder/strigifeeder.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/agents/strigifeeder/strigifeeder.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -12,6 +12,7 @@
 Name[ja]=Strigi フィーダー
 Name[km]=មតិព័ត៌មាន Strigi
 Name[ko]=Strigi 공급자
+Name[lt]=Strigi šaltinis
 Name[lv]=Strigi barotājs
 Name[nb]=Sender til Strigi
 Name[nds]=Strigi-Ingaav
@@ -22,6 +23,7 @@
 Name[pt]=Alimentação do Strigi
 Name[pt_BR]=Alimentador do Strigi
 Name[ro]=Alimentator Strigi
+Name[sl]=Podajalnik za strigi
 Name[sv]=Inmatning till Strigi
 Name[tr]=Strigi Besleyici
 Name[uk]=Передавач Strigi
@@ -41,6 +43,7 @@
 Comment[ja]=Strigi ベースの全文検索
 Comment[km]=ការ​ស្វែងរក​អត្ថបទ​ពេញលេញ​ដែល​មាន​មូលដ្ឋាន​លើ Strigi
 Comment[ko]=Strigi 기반 전문 검색
+Comment[lt]=Viso teksto paieška, paremta Strigi
 Comment[lv]=Strigi bāzēta pilna teksta meklēšana
 Comment[nb]=Strigi-basert fulltekstsøk
 Comment[nds]=Heeltextsöök mit Strigi
@@ -51,6 +54,7 @@
 Comment[pt]=Um motor de busca por texto completo baseado no Strigi
 Comment[pt_BR]=Pesquisa por texto completo baseada no Strigi
 Comment[ro]=Căutare integrală de text bazată pe Strigi
+Comment[sl]=Iskanje po vsem besedilu, ki temelji na Strigi
 Comment[sv]=Fulltextsökning baserad på Strigi
 Comment[tr]=Strigi-tabanlı tam metin araması
 Comment[uk]=Повнотекстовий пошук на основі Strigi
Index: akonadi/plugins/akonadi_serializer_addressee.desktop
===================================================================
--- akonadi/plugins/akonadi_serializer_addressee.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/plugins/akonadi_serializer_addressee.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -12,6 +12,7 @@
 Name[it]=Serializzatore degli indirizzi
 Name[ja]=受信者シリアライザ
 Name[km]=ម៉ាស៊ីន​បោះពុម្ព​អ្នក​ទទួលសំបុត្រ
+Name[lt]=Adresatų serializatorius
 Name[lv]=Adrešu serializētājs
 Name[nb]=Adressat-serialiserer
 Name[nds]=Adressaten-Reegmoduul
@@ -43,6 +44,7 @@
 Comment[it]=Un'estensione di Akonadi per la serializzazione degli indirizzi
 Comment[ja]=受信者オブジェクトのための Akonadi シリアライザプラグイン
 Comment[km]=កម្មវិធី​ជំនួយ​កម្មវិធី​បោះពុម្ព Akonadi សម្រាប់​វត្ថុ​អ្នក​ទទួល​សំបុត្រ
+Comment[lt]=Akonadi adresatų objektų serializatoriaus priedas
 Comment[lv]=Akonadi adrešu serializēšanas spraudnis
 Comment[nb]=Et Akonadi programtillegg for serialisering av adressat-objekter
 Comment[nds]=Akonadi-Inreegmoduul för Adressaten
Index: akonadi/plugins/akonadi_serializer_bookmark.desktop
===================================================================
--- akonadi/plugins/akonadi_serializer_bookmark.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/plugins/akonadi_serializer_bookmark.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -12,6 +12,7 @@
 Name[it]=Serializzatore dei segnalibri
 Name[ja]=ブックマークシリアライザ
 Name[km]=ម៉ាស៊ីន​បោះពុម្ព​ចំណាំ
+Name[lt]=Žymelių serializatorius
 Name[lv]=Grāmatzīmju serializētājs
 Name[nb]=Bokmerke-serialisering
 Name[nds]=Leesteken-Reegmoduul
@@ -42,6 +43,7 @@
 Comment[it]=Un'estensione di Akonadi per la serializzazione dei segnalibri
 Comment[ja]=ブックマークオブジェクトのための Akonadi シリアライザプラグイン
 Comment[km]=កម្មវិធី​ជំនួយ​កម្មវិធី​បោះពុម្ព Akonadi សម្រាប់​វត្ថុ​ចំណាំ
+Comment[lt]=Akonadi serializatoriaus priedas žymelių objektams
 Comment[lv]=Akonadi grāmatzīmju serializēšanas spraudnis
 Comment[nb]=Et Akonadi programtillegg for serialisering av  bokmerke-objekter
 Comment[nds]=Akonadi-Inreegmoduul för Leestekens
Index: akonadi/plugins/akonadi_serializer_contactgroup.desktop
===================================================================
--- akonadi/plugins/akonadi_serializer_contactgroup.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/plugins/akonadi_serializer_contactgroup.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -10,6 +10,7 @@
 Name[gl]=Serializador de Grupo de Contacto
 Name[it]=Serializzatore gruppi di contatti
 Name[km]=អ្នក​ដាក់​លេខ​សៀរៀល​ក្រុម​ទំនាក់ទំនង
+Name[lt]=Kontaktų grupių serializatorius
 Name[lv]=Kontaktu grupu serializētājs
 Name[nb]=Gruppeserialisering for kontakter
 Name[nds]=Kontaktkoppel-Reegmoduul
@@ -37,6 +38,7 @@
 Comment[gl]=Engadido de serialización de Akonadi para obxectos de grupo de contacto
 Comment[it]=Un'estensione di Akonadi per la serializzazione dei gruppi di contatti
 Comment[km]=កម្មវិធីជំនួយ​អ្នក​ដាក់លេខសៀរៀល Akonadi សម្រាប់​វត្ថុ​ក្រុម​ទំនាក់ទំនង
+Comment[lt]=Akonadi serializatoriaus priedas kontaktų grupių objektams
 Comment[lv]=Akonadi kontaktu grupu  serializēšanas spraudnis
 Comment[nb]=Et Akonadi programtillegg for serialisering av kontaktgruppe-objekter
 Comment[nds]=Akonadi-Inreegmoduul för Kontaktkoppeln
Index: akonadi/kabc/kcontactmanager/kcontactmanager.desktop
===================================================================
--- akonadi/kabc/kcontactmanager/kcontactmanager.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/kabc/kcontactmanager/kcontactmanager.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -23,6 +23,7 @@
 GenericName[ja]=連絡先マネージャ
 GenericName[km]=កម្មវិធី​គ្រប់គ្រង​ទំនាក់ទំនង
 GenericName[ko]=연락처 관리자
+GenericName[lt]=Kontaktų tvarkytuvė
 GenericName[lv]=Kontaktu pārvaldnieks
 GenericName[nb]=Kontaktbehandler
 GenericName[nds]=Kontaktenpleger
Index: akonadi/clients/akonadiconsole/akonadiconsole.desktop
===================================================================
--- akonadi/clients/akonadiconsole/akonadiconsole.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/clients/akonadiconsole/akonadiconsole.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -13,6 +13,7 @@
 Name[ja]=Akonadi コンソール
 Name[km]=កុងសូល​របស់ Akonadi
 Name[ko]=Akonadi 콘솔
+Name[lt]=Akonadi konsolė
 Name[lv]=Anokadi konsole
 Name[nb]=Akonadi-konsoll
 Name[nds]=Akonadi-Konsool
@@ -24,6 +25,7 @@
 Name[pt_BR]=Console do Akonadi
 Name[ro]=Consolă Akonadi
 Name[ru]=Консоль Akonadi
+Name[sl]=Konzola za Akonadi
 Name[sv]=Akonadi-terminal
 Name[tr]=Akonadi Uçbirimi
 Name[uk]=Термінал Akonadi
@@ -48,6 +50,7 @@
 Comment[ja]=Akonadi の管理とデバッグのためのコンソール
 Comment[km]=ការ​គ្រប់គ្រង Akonadi និង​កុងសូល​បំបាត់​កំហុស
 Comment[ko]=Akonadi 관리 및 디버깅 콘솔
+Comment[lt]=Akonadi tvarkymo ir išriktavimo konsolė
 Comment[lv]=Akonadi pārvaldības un atkļūdošanas konsole
 Comment[nb]=Konsoll for Akonadi administrasjon og feilsøking
 Comment[nds]=Akonadi sien Pleeg- un Fehlersöök-Konsool
@@ -59,6 +62,7 @@
 Comment[pt_BR]=Console de gerenciamento e depuração do Akonadi
 Comment[ro]=Consolă de administrare și depanare Akonadi
 Comment[ru]=Управление Akonadi и консоль отладки
+Comment[sl]=Akonadijeva konzola za upravljanje in razhroščevanje
 Comment[sv]=Akonadi hanterings- och felsökningsterminal
 Comment[tr]=Akonadi Yönetim ve Hata Ayıklama Uçbirimi
 Comment[uk]=Термінал керування і зневадження Akonadi
Index: akonadi/kcm/kcm_akonadi_server.desktop
===================================================================
--- akonadi/kcm/kcm_akonadi_server.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/kcm/kcm_akonadi_server.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -25,6 +25,7 @@
 Name[ja]=Akonadi サーバの設定
 Name[km]=ការ​កំណត់​រចនាសម្ព័ន្ធ​ម៉ាស៊ីនបម្រើ Akonadi
 Name[ko]=Akonadi 서버 설정
+Name[lt]=Akonadi serverio konfigūravimas
 Name[lv]=Akonadi servera konfigurācija
 Name[nb]=Akonadi tjeneroppsett
 Name[nds]=Akonadi-Serverinstellen
@@ -35,6 +36,7 @@
 Name[pt]=Configuração do Servidor de Akonadi
 Name[pt_BR]=Configuração do servidor do Akonadi
 Name[ro]=Configurare server Akonadi
+Name[sl]=Nastavitev strežnika Akonadi
 Name[sv]=Akonadi-serverinställning
 Name[tr]=Akonadi Sunucu Yapılandırması
 Name[uk]=Налаштування сервера Akonadi
Index: akonadi/kcm/kcm_akonadi_resources.desktop
===================================================================
--- akonadi/kcm/kcm_akonadi_resources.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/kcm/kcm_akonadi_resources.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -26,6 +26,7 @@
 Name[ja]=Akonadi リソースの設定
 Name[km]=ការ​កំណត់​រចនាសម្ព័ន្ធ​ធនធាន Akonadi
 Name[ko]=Akonadi 자원 설정
+Name[lt]=Akonadi resursų konfigūravimas
 Name[lv]=Akonadi resursu konfigurācija
 Name[nb]=Akonadi ressursoppsett
 Name[nds]=Akonadi-Ressourceninstellen
@@ -36,6 +37,7 @@
 Name[pt]=Configuração dos Recursos do Akonadi
 Name[pt_BR]=Configuração dos recursos do Akonadi
 Name[ro]=Configurare resurse Akonadi
+Name[sl]=Nastavitev virov za Akonadi
 Name[sv]=Akonadi-resursinställning
 Name[tr]=Akonadi Kaynak Yapılandırması
 Name[uk]=Налаштування ресурсів Akonadi
Index: akonadi/kcm/kcm_akonadi.desktop
===================================================================
--- akonadi/kcm/kcm_akonadi.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/kcm/kcm_akonadi.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -27,6 +27,7 @@
 Name[ja]=Akonadi の設定
 Name[km]=ការ​កំណត់​រចនាសម្ព័ន្ធ​ម៉ាស៊ីនបម្រើ Akonadi
 Name[ko]=Akonadi 설정
+Name[lt]=Akonadi konfigūravimas
 Name[lv]=Akonadi konfigurācija
 Name[nb]=Akonadi-oppsett
 Name[nds]=Akonadi-Instellen
@@ -37,6 +38,7 @@
 Name[pt]=Configuração do Akonadi
 Name[pt_BR]=Configuração do Akonadi
 Name[ro]=Configurare Akonadi
+Name[sl]=Nastavitev Akonadija
 Name[sv]=Akonadi-serverinställning
 Name[tr]=Akonadi Yapılandırması
 Name[uk]=Налаштування Akonadi
@@ -56,6 +58,7 @@
 Comment[ja]=Akonadi PIM (個人情報管理) フレームワークの設定
 Comment[km]=ការ​កំណត់​រចនាសម្ព័ន្ធ​គម្រោងការ​ការ​គ្រប់គ្រង​ព័ត៌មាន​ផ្ទាល់ខ្លួន Akonadi
 Comment[ko]=Akonadi 개인 정보 관리 프레임워크 설정
+Comment[lt]=Akonadi asmeninės informacijos tvarkymo aplinkos konfigūravimas
 Comment[lv]=Akonadi personīgās informācijas pārvaldības ietvara konfigurācija
 Comment[nb]=Sette opp rammeverket for Akonadi personlig informasjonsbehandler
 Comment[nds]=Den Pleger för persöönliche Informatschonen Akonadi instellen
@@ -65,6 +68,7 @@
 Comment[pl]=Konfiguracja Akonadi - systemu zarządzania informacją osobistą
 Comment[pt]=Configuração da plataforma de Gestão de Informação Pessoal do Akonadi
 Comment[pt_BR]=Configuração da plataforma do gerenciador de informações pessoais do Akonadi
+Comment[sl]=Nastavitev ogrodja Akonadi za upravljanje z osebnimi podatki
 Comment[sv]=Inställning av Akonadi: Ramverk för personlig informationshantering
 Comment[tr]=Akonadi Kişisel Bilgi Yönetimi çalışma ortamının yapılandırması
 Comment[uk]=Налаштування оболонки керування особистою інформацією Akonadi
Index: akonadi/resources/distlist/distlistresource.desktop
===================================================================
--- akonadi/resources/distlist/distlistresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/distlist/distlistresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -22,6 +22,7 @@
 Name[pt]=Ficheiro de Lista de Distribuição
 Name[pt_BR]=Arquivo de lista de distribuição
 Name[ro]=Fișier-listă distribuție
+Name[sl]=Datoteka s seznamom za razpošiljanje
 Name[sv]=Fil med fördelningslista
 Name[tr]=Dağıtım Listesi Dosyası
 Name[uk]=Файл списку розповсюдження
@@ -50,6 +51,7 @@
 Comment[pt]=Carrega os dados a partir de um ficheiro de lista de distribuição
 Comment[pt_BR]=Carrega os dados de um arquivo de lista de distribuição
 Comment[ro]=Încarcă date dintr-un fișier distributionlist
+Comment[sl]=Naloži podatke iz datoteke s seznamom za razpošiljanje
 Comment[sv]=Laddar data från en fil med en fördelningslista
 Comment[tr]=Bir dağıtım listesi dosyasından veri yükler
 Comment[uk]=Завантажує дані з файла списку розповсюдження
Index: akonadi/resources/nntp/nntpresource.desktop
===================================================================
--- akonadi/resources/nntp/nntpresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/nntp/nntpresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -20,6 +20,7 @@
 Name[pl]=Grupy Usenet (NNTP)
 Name[pt]=Grupos de Notícias da Usenet (NNTP)
 Name[pt_BR]=Grupos de notícias da Usenet (NNTP)
+Name[sl]=Novičarske skupine (NNTP)
 Name[sv]=Usenet-nyhetsgrupper (NNTP)
 Name[tr]=Usenet Haber Grubu (NNTP)
 Name[uk]=Групи новин Usenet (NNTP)
@@ -48,6 +49,7 @@
 Comment[pl]=Umożliwia czytanie wiadomości z serwerów niusów
 Comment[pt]=Possibilita a leitura de artigos de um servidor de notícias
 Comment[pt_BR]=Possibilita a leitura de artigos de um servidor de notícias
+Comment[sl]=Omogoča branje sestavkov na strežniku z novičarskimi skupinami
 Comment[sv]=Gör det möjligt att läsa artiklar från en nyhetsserver
 Comment[tr]=Bir haber sunucusundan haberleri okumak için bir araç
 Comment[uk]=Робить можливим читання статей з сервера новин
Index: akonadi/resources/vcard/vcardresource.desktop
===================================================================
--- akonadi/resources/vcard/vcardresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/vcard/vcardresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -54,6 +54,7 @@
 Comment[pt]=Carrega os dados de um ficheiro VCard
 Comment[pt_BR]=Carrega os dados de um arquivo VCard
 Comment[ro]=Încarcă date dintr-un fișier vCard
+Comment[sl]=Naloži podatke iz datoteke VCard
 Comment[sv]=Laddar data från en vCard-fil
 Comment[tr]=VCard dosyasından veri yükler
 Comment[uk]=Завантажує дані з файла VCard
Index: akonadi/resources/kabc/kabcresource.desktop
===================================================================
--- akonadi/resources/kabc/kabcresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/kabc/kabcresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -23,6 +23,7 @@
 Name[pt]=Livro de Endereços do KDE (tradicional)
 Name[pt_BR]=Livro de endereços do KDE (tradicional)
 Name[ro]=Carte de adrese KDE (tradițională)
+Name[sl]=KDE-jev adresar (tradicionalni)
 Name[sv]=KDE:s adressbok (traditionell)
 Name[tr]=KDE Adres Defteri (geleneksel)
 Name[uk]=Адресна книга KDE (традиційна)
@@ -52,6 +53,7 @@
 Comment[pt]=Carrega os dados de um recurso de livro de endereços tradicional do KDE
 Comment[pt_BR]=Carrega os dados do tradicional recurso do livro de endereços do KDE
 Comment[ro]=Încarcă date dintr-o resursă KDE de tip carte de adrese tradițională
+Comment[sl]=Naloži podatke iz tradicionalnega KDE-jevega adresarja
 Comment[sv]=Laddar data från en traditionell adressboksresurs i KDE
 Comment[tr]=Geleneksel KDE adres defteri kaynağından veri yükler
 Comment[uk]=Завантажує дані зі звичайного ресурсу адресної книги для KDE
Index: akonadi/resources/knut/knutresource.desktop
===================================================================
--- akonadi/resources/knut/knutresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/knut/knutresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -27,6 +27,7 @@
 Comment[pt]=Um agente para fins de depuração
 Comment[pt_BR]=Um agente para depuração
 Comment[ro]=Agent pentru scopuri de depanare
+Comment[sl]=Posrednik za potrebe razhroščevanja
 Comment[sv]=En modul för felsökningssyften
 Comment[tr]=Hata ayıklama amaçlı bir araç
 Comment[uk]=Агент для зневадження
Index: akonadi/resources/maildir/maildirresource.desktop
===================================================================
--- akonadi/resources/maildir/maildirresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/maildir/maildirresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -28,6 +28,7 @@
 Comment[pt]=Carrega os dados de uma pasta Maildir local
 Comment[pt_BR]=Carrega os dados de uma pasta maildir local
 Comment[ro]=Încarcă date dintr-un dosar maildir local
+Comment[sl]=Naloži podatke is krajevne mape s pošto (maildir)
 Comment[sv]=Laddar data från en lokal maildir-katalog
 Comment[tr]=Yerel maildir dizininden veri yükleme aracı
 Comment[uk]=Завантажує дані з локальної теки maildir
Index: akonadi/resources/localbookmarks/localbookmarksresource.desktop
===================================================================
--- akonadi/resources/localbookmarks/localbookmarksresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/localbookmarks/localbookmarksresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -21,6 +21,7 @@
 Name[pt]=Favoritos Locais
 Name[pt_BR]=Favoritos locais
 Name[ro]=SemneDeCarteLocale
+Name[sl]=Krajevni zaznamki
 Name[sv]=Lokala bokmärken
 Name[tr]=Yerel Yer İmleri
 Name[uk]=Локальні закладки
@@ -51,6 +52,7 @@
 Comment[pt]=Carrega os dados a partir de um ficheiro de favoritos local
 Comment[pt_BR]=Carrega os dados de um arquivo de favoritos local
 Comment[ro]=Încarcă date dintr-un fișier local de tip semn de carte
+Comment[sl]=Naloži podatke iz krajevne datoteke z zaznamki
 Comment[sv]=Laddar data från en lokal bokmärkesfil
 Comment[tr]=Yerel bir yer imleri dosyasından veri yükler
 Comment[uk]=Завантажує дані з локального файла закладок
Index: akonadi/resources/imap/imaplibresource.desktop
===================================================================
--- akonadi/resources/imap/imaplibresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/imap/imaplibresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -10,6 +10,7 @@
 Name[pt]=IMAP do Mailody
 Name[pt_BR]=IMAP do Mailody
 Name[ro]=Imap Mailody
+Name[sl]=Mailody IMAP
 Name[sv]=Mailody IMAP
 Name[x-test]=xxMailody Imapxx
 Name[zh_CN]=Mailody IMAP
@@ -34,6 +35,7 @@
 Comment[pl]=Łączy z serwerem IMAP. Bazuje na bibliotece IMAP z Mailody.
 Comment[pt]=Liga-se a um servidor de IMAP. Baseia-se na biblioteca de IMAP do Mailody.
 Comment[pt_BR]=Conecta a um servidor IMAP. Baseado na biblioteca de IMAP do Mailody.
+Comment[sl]=Se poveže s strežnikom IMAP. Temelji na knjižnici za IMAP iz Mailodya.
 Comment[sv]=Ansluter till en IMAP-server. Baserad på IMAP-biblioteket från Mailody.
 Comment[tr]=Bir IMAP-sunucuya bağlanır. Mailody IMAP-kitaplığını temel alır.
 Comment[uk]=З’єднується з сервером IMAP. Засновано на бібліотеці IMAP з Mailody.
Index: akonadi/resources/shared/singlefileresource.h
===================================================================
--- akonadi/resources/shared/singlefileresource.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/shared/singlefileresource.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -102,6 +102,7 @@
           KDirWatch::self()->addFile( mCurrentUrl.path() );
 
         emit status( Idle, i18nc( "@info:status", "Ready" ) );
+        synchronize();
       }
       else
       {
Index: akonadi/resources/shared/singlefileresourcebase.cpp
===================================================================
--- akonadi/resources/shared/singlefileresourcebase.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/shared/singlefileresourcebase.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -88,7 +88,6 @@
     writeFile();
 
   readFile();
-  synchronize();
 }
 
 void SingleFileResourceBase::handleProgress( KJob *, unsigned long pct )
@@ -127,13 +126,14 @@
   if ( job->error() && job->error() != KIO::ERR_DOES_NOT_EXIST ) {
     emit status( Broken, i18n( "Could not load file '%1'.", mCurrentUrl.prettyUrl() ) );
   } else {
-    readFromFile( KUrl( cacheFile() ).url() );
+    readFromFile( KUrl( cacheFile() ).toLocalFile() );
   }
 
   mDownloadJob = 0;
   KGlobal::deref();
 
   emit status( Idle, i18nc( "@info:status", "Ready" ) );
+  synchronize();
 }
 
 void SingleFileResourceBase::slotUploadJobResult( KJob *job )
Index: akonadi/resources/openchange/ocresource.desktop
===================================================================
--- akonadi/resources/openchange/ocresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/openchange/ocresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -23,6 +23,7 @@
 Comment[pl]=Umożliwia współpracę z serwerami OpenChange / Exchange
 Comment[pt]=Possibilita a integração com um servidor de OpenChange / Exchange
 Comment[pt_BR]=Possibilita trabalhar com um servidor OpenChange / Exchange
+Comment[sl]=Omogoča delo s strežnikom OpenChange/Exchange
 Comment[sv]=Gör det möjligt att arbeta med en Openchange- eller Exchange-server
 Comment[tr]=OpenChange / Exchange sunucusu ile çalışabilmek için bir araç
 Comment[uk]=Робить можливою роботу з серверами OpenChange / Exchange
Index: akonadi/resources/ical/icalresource.desktop
===================================================================
--- akonadi/resources/ical/icalresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/ical/icalresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -23,6 +23,7 @@
 Name[pt]=Ficheiro de Calendário ICal
 Name[pt_BR]=Arquivo de calendário ICal
 Name[ro]=Fișier-calendar ICal
+Name[sl]=Koledarska datoteka iCal
 Name[sv]=ICal-kalenderfil
 Name[tr]=ICal Takvim Dosyası
 Name[uk]=Файл календаря ICal
@@ -53,6 +54,7 @@
 Comment[pt]=Carrega os dados de um ficheiro iCal
 Comment[pt_BR]=Carrega os dados de um arquivo iCal
 Comment[ro]=Încarcă date dintr-un fișier iCal
+Comment[sl]=Naloži podatke iz datoteke iCal
 Comment[sv]=Laddar data från en iCal-fil
 Comment[tr]=iCal dosyasından veri yükler
 Comment[uk]=Завантажує дані з файла iCal
Index: akonadi/resources/kcal/kcalresource.desktop
===================================================================
--- akonadi/resources/kcal/kcalresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/kcal/kcalresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -23,6 +23,7 @@
 Name[pt]=Calendário do KDE (tradicional)
 Name[pt_BR]=Calendário do KDE (tradicional)
 Name[ro]=Calendar KDE (tradițional)
+Name[sl]=KDE-jev koledar (tradicionalni)
 Name[sv]=KDE:s kalender (traditionell)
 Name[tr]=KDE Takvimi (geleneksel)
 Name[uk]=Календар KDE (традиційний)
@@ -51,6 +52,7 @@
 Comment[pl]=Wczytuje dane z tradycyjnego zasobu kalendarza KDE
 Comment[pt]=Carrega os dados de um recurso de calendário tradicional do KDE
 Comment[pt_BR]=Carrega os dados do tradicional recurso de calendário do KDE
+Comment[sl]=Naloži podatke iz tradicionalnega KDE-jevega koledarja
 Comment[sv]=Laddar data från en traditionell kalenderresurs i KDE
 Comment[tr]=Geleneksel KDE takvim kaynağından veri yükler
 Comment[uk]=Завантажує дані зі звичайного ресурсу календаря для KDE
Index: akonadi/resources/nepomuktag/nepomuktagresource.desktop
===================================================================
--- akonadi/resources/nepomuktag/nepomuktagresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/nepomuktag/nepomuktagresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -23,6 +23,7 @@
 Name[pt]=Marcas do Nepomuk (Pastas Virtuais)
 Name[pt_BR]=Marcas do Nepomuk (Pastas virtuais)
 Name[ro]=Etichete Nepomuk (dosare virtuale)
+Name[sl]=Oznake Nepomuk (navidezne mape)
 Name[sv]=Nepomuk-etiketter (virtuella korgar)
 Name[tr]=Nepomuk Etiketleri (Sanal Dizinler)
 Name[uk]=Мітки Nepomuk (Віртуальні теки)
@@ -50,6 +51,7 @@
 Comment[pl]=Foldery wirtualne służące wybieraniu wiadomości, które posiadają znaczniki Nepomuka.
 Comment[pt]=Pastas virtuais para seleccionar as mensagens que tenham Marcas do Nepomuk.
 Comment[pt_BR]=Pastas virtuais para selecionar as mensagens que possuam marcas do Nepomuk.
+Comment[sl]=Navidezne mape za izbiranje sporočil z oznakami Nepomuk.
 Comment[sv]=Virtuella korgar för att välja brev som har Nepomuk-etiketter.
 Comment[tr]=Nepomuk Etiketi olan iletileri seçmek için sanal dizinler
 Comment[uk]=Віртуальні теки для вибору повідомлень, які мають мітки Nepomuk.
Index: akonadi/resources/vcarddir/vcarddirresource.desktop
===================================================================
--- akonadi/resources/vcarddir/vcarddirresource.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ akonadi/resources/vcarddir/vcarddirresource.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -53,6 +53,7 @@
 Comment[pt]=Carrega os dados de uma pasta com ficheiros VCard
 Comment[pt_BR]=Carrega os dados de uma pasta com VCards
 Comment[ro]=Încarcă date dintr-un director cu vCard-uri
+Comment[sl]=Naloži podatke iz mape z datotekami VCard
 Comment[sv]=Laddar data från en katalog med vCard-filer
 Comment[tr]=VCard dosyaları bulunan bir dizinden verileri yükler
 Comment[uk]=Завантажує дані з каталогу з VCard
Index: korganizer/koeditorgeneraltodo.cpp
===================================================================
--- korganizer/koeditorgeneraltodo.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/koeditorgeneraltodo.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -351,6 +351,9 @@
   QDate tmpSDate, tmpDDate;
   QTime tmpSTime, tmpDTime;
   KDateTime tmpStartDT, tmpDueDT;
+  tmpDueDT.setTimeSpec( dueSpec );
+  tmpStartDT.setTimeSpec( startSpec );
+
   if ( mTimeButton->isChecked() ) {
     todo->setAllDay( false );
 
@@ -359,7 +362,6 @@
     tmpDTime = mDueTimeEdit->getTime();
     tmpDueDT.setDate( tmpDDate );
     tmpDueDT.setTime( tmpDTime );
-    tmpDueDT.setTimeSpec( dueSpec );
 
     // set start date/time
     if ( mStartCheck->isChecked() ) {
@@ -367,7 +369,6 @@
       tmpSTime = mStartTimeEdit->getTime();
       tmpStartDT.setDate( tmpSDate );
       tmpStartDT.setTime( tmpSTime );
-      tmpStartDT.setTimeSpec( startSpec );
     } else {
       tmpStartDT = tmpDueDT;
     }
Index: korganizer/korganizer.cpp
===================================================================
--- korganizer/korganizer.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/korganizer.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -305,9 +305,10 @@
       title += " [" + i18nc( "the calendar is read-only", "read-only" ) + ']';
     }
   }
+  if ( mCalendarView->isFiltered() ) {
+    title += " - <" + mCalendarView->currentFilterName() + "> ";
+  }
 
-  title += " - <" + mCalendarView->currentFilterName() + "> ";
-
   setCaption( title, !mCalendarView->isReadOnly() &&
                       mCalendarView->isModified() );
 }
Index: korganizer/kodaymatrix.h
===================================================================
--- korganizer/kodaymatrix.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/kodaymatrix.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -164,7 +164,7 @@
     /* reimplemented from KCal::Calendar::Observer */
     void calendarIncidenceAdded( Incidence *incidence );
     void calendarIncidenceChanged( Incidence *incidence );
-    void calendarIncidenceRemoved( Incidence *incidence );
+    void calendarIncidenceDeleted( Incidence *incidence );
 
   public slots:
     /** Recalculates all the flags of the days in the matrix like holidays or
Index: korganizer/actionmanager.cpp
===================================================================
--- korganizer/actionmanager.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/actionmanager.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -675,13 +675,6 @@
                                         SLOT(showTip()) );
   mACollection->addAction( "help_tipofday", a );
 
-  /************************* TOOLBAR ACTIONS *******************************/
-  QLabel *filterLabel = new QLabel( i18n( "Filter: " ), mCalendarView );
-  filterLabel->hide();
-  QWidgetAction *act = new QWidgetAction( this );
-  act->setText( i18n( "Filter: " ) );
-  mACollection->addAction( "filter_label", act );
-  act->setDefaultWidget( filterLabel );
 }
 
 void ActionManager::slotChangeComboActionItem( int index )
Index: korganizer/calendarview.h
===================================================================
--- korganizer/calendarview.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/calendarview.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -157,6 +157,9 @@
         is no selection, return the selected todo from the todo list on the left */
     Incidence *selectedIncidence();
 
+    /** Returns true if there's a filter applied */
+    bool isFiltered() const;
+
     /** Returns the name of the current filter */
     QString currentFilterName() const;
 
Index: korganizer/kodaymatrix.cpp
===================================================================
--- korganizer/kodaymatrix.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/kodaymatrix.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -83,7 +83,6 @@
 
   mTodayMarginWidth = 2;
   mSelEnd = mSelStart = NOSELECTION;
-  setAttribute( Qt::WA_NoSystemBackground, true );
 
   recalculateToday();
 }
@@ -278,39 +277,40 @@
   }
 
   Event::List eventlist = mCalendar->events( mDays[0], mDays[NUMDAYS-1],
-                                             mCalendar->timeSpec());
+                                             mCalendar->timeSpec() );
   mEvents.clear();
   Event::List::ConstIterator it;
 
-  for ( it = eventlist.constBegin(); it != eventlist.constEnd(); ++it ) {
+  for ( it=eventlist.constBegin(); it != eventlist.constEnd(); ++it ) {
     Event *event = *it;
     ushort recurType = event->recurrenceType();
-	
+
     if ( !( recurType == Recurrence::rDaily  && !KOPrefs::instance()->mDailyRecur ) &&
          !( recurType == Recurrence::rWeekly && !KOPrefs::instance()->mWeeklyRecur ) ) {
-          
+
       DateTimeList timeDateList;
-      
-      if (event->recurs()) {
+
+      if ( event->recurs() ) {
         //Its a recurring event, find out in which days it occurs
-      	timeDateList = event->recurrence()->timesInInterval( *new KDateTime( mDays[0],         mCalendar->timeSpec() ),
-                                                             *new KDateTime( mDays[NUMDAYS-1], mCalendar->timeSpec() ) );
+        timeDateList = event->recurrence()->timesInInterval(
+          *new KDateTime( mDays[0], mCalendar->timeSpec() ),
+          *new KDateTime( mDays[NUMDAYS-1], mCalendar->timeSpec() ) );
       } else {
         timeDateList.append( event->dtStart() );
-      }							 
-        
-      const int eventDuration = event->dtStart().daysTo(event->dtEnd())+1;
+      }
 
+      const int eventDuration = event->dtStart().daysTo( event->dtEnd() ) + 1;
+
       DateTimeList::iterator t;
-      for ( t = timeDateList.begin(); t != timeDateList.end(); ++t ) {
+      for ( t=timeDateList.begin(); t != timeDateList.end(); ++t ) {
         //This could be a multiday event, so iterate from dtStart() to dtEnd()
         QDate d = t->date();
         int j   = 0;
 
         do {
-                                                                            
+
           mEvents.append( d );
-      
+
           ++j;
           d = d.addDays( 1 );
 
@@ -356,7 +356,7 @@
   mPendingChanges = true;
 }
 
-void KODayMatrix::calendarIncidenceRemoved( Incidence *incidence )
+void KODayMatrix::calendarIncidenceDeleted( Incidence *incidence )
 {
   Q_UNUSED( incidence );
   mPendingChanges = true;
@@ -611,6 +611,9 @@
 
   p.begin( this );
 
+  // draw background
+  p.fillRect( 0, 0, sz.width(), sz.height(), QBrush( pal.color( QPalette::Base ) ) );
+
   // draw topleft frame
   p.setPen( pal.color( QPalette::Mid ) );
   p.drawRect( 0, 0, sz.width() - 1, sz.height() - 1 );
@@ -661,9 +664,9 @@
   QColor textColor = pal.color( QPalette::Text );
   QColor textColorShaded = getShadedColor( textColor );
   QColor actcol = textColorShaded;
-  p.setPen(actcol);
+  p.setPen( actcol );
   QPen tmppen;
-  for ( int i = 0; i < NUMDAYS; ++i ) {
+  for ( int i=0; i<NUMDAYS; ++i ) {
     row = i / 7;
     col = isRTL ? 6 - ( i - row * 7 ) : i - row * 7;
 
@@ -711,7 +714,7 @@
     }
 
     // if any events are on that day then draw it using a bold font
-    if ( mEvents.contains(mDays[i]) ) {
+    if ( mEvents.contains( mDays[i] ) ) {
       QFont myFont = font();
       myFont.setBold( true );
       p.setFont( myFont );
@@ -740,7 +743,7 @@
       p.setPen( actcol );
     }
     // reset bold font to plain font
-    if ( mEvents.contains(mDays[i]) > 0 ) {
+    if ( mEvents.contains( mDays[i] ) > 0 ) {
       QFont myFont = font();
       myFont.setBold( false );
       p.setFont( myFont );
Index: korganizer/plugins/picoftheday/picoftheday.desktop
===================================================================
--- korganizer/plugins/picoftheday/picoftheday.desktop	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/plugins/picoftheday/picoftheday.desktop	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -55,6 +55,7 @@
 Comment[pl]=Wtyczka dostarcza Obrazek Dnia Wikipedii
 Comment[pt]=Este 'plugin' oferece a Imagem do Dia do Wikipédia
 Comment[pt_BR]=Este plug-in oferece a Imagem do Dia da Wikipedia
+Comment[sl]=Ta vstavek ponuja sliko dneva z Wikipedije
 Comment[sv]=Insticksprogrammet tillhandahåller Wikipedias 'Dagens bild'
 Comment[tr]=Bu eklenti Wikipedia'dan Günün Resmini getirir
 Comment[uk]=Цей додаток працює з «Зображеннями дня» з Вікіпедії
Index: korganizer/views/todoview/kotodoview.cpp
===================================================================
--- korganizer/views/todoview/kotodoview.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/views/todoview/kotodoview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -35,6 +35,13 @@
 #include "koprefs.h"
 #include "koglobals.h"
 
+#include "kocorehelper.h"
+//#include "korganizer/baseview.h"
+//#include "actionmanager.h"
+#ifndef KORG_NOPRINTER
+#include "calprinter.h"
+#endif
+
 #include <kcal/todo.h>
 #include <kcal/incidence.h>
 
@@ -469,8 +476,32 @@
 
 void KOTodoView::printTodo()
 {
-  //TODO
-  kDebug() << "this is a stub";
+#ifndef KORG_NOPRINTER
+  QModelIndexList selection = mView->selectionModel()->selectedRows();
+  if ( selection.size() != 1 ) {
+    return;
+  }
+
+  Todo *todo = static_cast<Todo *>( selection[0].data( KOTodoModel::TodoRole ).value<void *>() );
+
+  KOCoreHelper helper;
+  CalPrinter printer( this, BaseView::calendar(), &helper );
+  connect( this, SIGNAL(configChanged()), &printer, SLOT(updateConfig()) );
+
+  Incidence::List selectedIncidences;
+  selectedIncidences.append( todo );
+
+  KDateTime todoDate;
+  if ( todo->hasStartDate() ) {
+    todoDate = todo->dtStart();
+  } else {
+    todoDate = todo->dtDue();
+  }
+
+  printer.print( KOrg::CalPrinterBase::Incidence,
+                 todoDate.date(), todoDate.date(), selectedIncidences, false );
+
+#endif
 }
 
 void KOTodoView::deleteTodo()
Index: korganizer/views/agendaview/koagenda.cpp
===================================================================
--- korganizer/views/agendaview/koagenda.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/views/agendaview/koagenda.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -636,14 +636,10 @@
         }
         showNewEventPopupSignal();
       } else {
-        // if mouse pointer is in selection, don't change selection
-        QPoint gpos = contentsToGrid( viewportToContents( viewportPos ) );
-        if ( !ptInSelection( gpos ) ) {
-          selectItem( 0 );
-          mActionItem = 0;
-          setCursor( Qt::ArrowCursor );
-          startSelectAction( viewportPos );
-        }
+        selectItem( 0 );
+        mActionItem = 0;
+        setCursor( Qt::ArrowCursor );
+        startSelectAction( viewportPos );
       }
     }
     break;
@@ -1402,7 +1398,7 @@
 //    QPixmap bgImage( KOPrefs::instance()->agendaGridBackgroundImage() );
 //    dbp.drawPixmap( 0, 0, cw, ch, bgImage ); FIXME
 //  }
-  dbp.fillRect( cx, cy, cw, ch,
+  dbp.fillRect( 0, 0, cw, ch,
                 KOPrefs::instance()->agendaGridBackgroundColor() );
   dbp.translate( -cx, -cy );
 
Index: korganizer/version.h
===================================================================
--- korganizer/version.h	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/version.h	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -53,6 +53,6 @@
     3.2 alpha1
 */
 
-static const char korgVersion[] = "4.2 rc1";
+static const char korgVersion[] = "4.2.1";
 
 #endif
Index: korganizer/korganizerui.rc
===================================================================
--- korganizer/korganizerui.rc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/korganizerui.rc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -149,7 +149,6 @@
   </ToolBar>
 
   <ToolBar noMerge="1" name="filter_toolbar" hidden="true"><text>Filters Toolbar</text>
-    <Action name="filter_label"/>
     <Action name="filter_select"/>
     <Action name="edit_filters"/>
   </ToolBar>
Index: korganizer/calendarview.cpp
===================================================================
--- korganizer/calendarview.cpp	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/calendarview.cpp	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -1402,6 +1402,11 @@
   PublishDialog publishdlg;
   if ( publishdlg.exec() == QDialog::Accepted ) {
     QString recipients = publishdlg.addresses();
+    if ( incidence->organizer().isEmpty() ) {
+      incidence->setOrganizer( Person( KOPrefs::instance()->fullName(),
+                                       KOPrefs::instance()->email() ) );
+    }
+
     ICalFormat format;
     QString messageText = format.createScheduleMessage( incidence, iTIPRequest );
     KOMailClient mailer;
@@ -1723,6 +1728,10 @@
   emit filterChanged();
 }
 
+bool CalendarView::isFiltered() const {
+  return mCurrentFilter != 0;
+}
+
 QString CalendarView::currentFilterName() const
 {
   if ( mCurrentFilter ) {
Index: korganizer/korganizer_part.rc
===================================================================
--- korganizer/korganizer_part.rc	(.../tags/KDE/4.2.0/kdepim)	(wersja 920564)
+++ korganizer/korganizer_part.rc	(.../branches/KDE/4.2/kdepim)	(wersja 920564)
@@ -157,7 +157,6 @@
   </ToolBar>
 
   <ToolBar noMerge="1" name="filter_toolbar" hidden="true"><text>Filters Toolbar</text>
-    <Action name="filter_label"/>
     <Action name="filter_select"/>
     <Action name="edit_filters"/>
   </ToolBar>

Zmiany atrybutów dla: .
___________________________________________________________________
Dodane: svn:externals
   + 


